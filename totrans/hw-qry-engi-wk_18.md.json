["```rs\nfun executeQuery(path: String, month: Int, sql: String): List<RecordBatch> {\n  val monthStr = String.format(\"%02d\", month);\n  val filename = \"$path/yellow_tripdata_2019-$monthStr.csv\"\n  val ctx = ExecutionContext()\n  ctx.registerCsv(\"tripdata\", filename)\n  val df = ctx.sql(sql)\n  return ctx.execute(df).toList()\n} \n```", "```rs\nval start = System.currentTimeMillis()\nval deferred = (1..12).map {month ->\n  GlobalScope.async {\n\n    val sql = \"SELECT passenger_count, \" +\n        \"MAX(CAST(fare_amount AS double)) AS max_fare \" +\n        \"FROM tripdata \" +\n        \"GROUP BY passenger_count\"\n\n    val start = System.currentTimeMillis()\n    val result = executeQuery(path, month, sql)\n    val duration = System.currentTimeMillis() - start\n    println(\"Query against month $month took $duration ms\")\n    result\n  }\n}\nval results: List<RecordBatch> = runBlocking {\n  deferred.flatMap { it.await() }\n}\nval duration = System.currentTimeMillis() - start\nprintln(\"Collected ${results.size} batches in $duration ms\") \n```", "```rs\nQuery against month 8 took 17074 ms\nQuery against month 9 took 18976 ms\nQuery against month 7 took 20010 ms\nQuery against month 2 took 21417 ms\nQuery against month 11 took 21521 ms\nQuery against month 12 took 22082 ms\nQuery against month 6 took 23669 ms\nQuery against month 1 took 23735 ms\nQuery against month 10 took 23739 ms\nQuery against month 3 took 24048 ms\nQuery against month 5 took 24103 ms\nQuery against month 4 took 25439 ms\nCollected 12 batches in 25505 ms \n```", "```rs\nval sql = \"SELECT passenger_count, \" +\n        \"MAX(max_fare) \" +\n        \"FROM tripdata \" +\n        \"GROUP BY passenger_count\"\n\nval ctx = ExecutionContext()\nctx.registerDataSource(\"tripdata\", InMemoryDataSource(results.first().schema, results))\nval df = ctx.sql(sql)\nctx.execute(df).forEach { println(it) } \n```", "```rs\n1,671123.14\n2,1196.35\n3,350.0\n4,500.0\n5,760.0\n6,262.5\n7,80.52\n8,89.0\n9,97.5\n0,90000.0 \n```", "```rs\n/mnt/nyctaxi/csv/year=2019/month=1/tripdata.csv\n/mnt/nyctaxi/csv/year=2019/month=2/tripdata.csv\n...\n/mnt/nyctaxi/csv/year=2019/month=12/tripdata.csv \n```"]