# 解析：从源代码到 ASTs

## 问题

之前我们介绍了 SImPl 的基本步骤，但我们留下了一个大问题：我们如何将程序放入 AST 表示中？当然，最简单的方法就是我们之前所做的那样：直接编写 AST 构造函数，例如，

```
(num 1)
```

```
(plus (num 1) (num 2))
```

```
(plus (num 1)
      (plus (num 2) (num 3)))
```

正如我们所指出的，这也具有忽略程序源代码确切编写方式的优点。

然而，这可能会变得非常繁琐。我们不想每次想要写一个数字时都要写`(num …)`！特别是，越繁琐，我们写很多或复杂的测试的可能性就越小，这将会特别不幸。因此，我们希望有一个更便利的表面语法，以及一个程序来将其翻译成 ASTs。

正如我们之前所看到的，我们可以使用大量的表面语法，而且我们甚至不受限于文本语法：它可以是图形的；口头的；手势的（想象你身处一个虚拟现实环境中）；等等。正如我们所指出的，这种广泛的模态范围很重要——尤其是如果程序员有身体限制的话——但它超出了我们当前研究的范围。即使是在文本语法中，我们也必须处理诸如歧义（例如，算术中的运算顺序）等问题。

通常，将输入语法转换为 ASTs 的过程被称为解析。我们完全可以写一本关于解析的整个手册……但我们不会这么做。相反，我们将选择一种在便利性和简单性之间取得合理平衡的语法，即 Racket 的括号语法，它在 plait 中有特殊支持。也就是说，我们将按照以下方式编写上述示例：

```
1
(+ 1 2)
(+ 1 (+ 2 3))
```

并看看 Racket 如何帮助我们使这些语法变得易于使用。实际上，在这本书中，我们将遵循一个约定（Racket 并不关心，因为它将`()`、`[]`和`{}`视为可互换的）：我们将使用`{}`而不是`()`来编写程序。因此，上述三个程序变为

```
1
{+ 1 2}
{+ 1 {+ 2 3}}
```
