# 简介

> [`howqueryengineswork.com/00-introduction.html`](https://howqueryengineswork.com/00-introduction.html)

查询引擎是推动现代数据基础设施的无形工作马。每次你在数据库上运行 SQL 查询、执行 Spark 作业或查询数据湖时，查询引擎都会将你的高级请求转换为高效的执行计划。了解查询引擎的工作原理，可以让你深入了解计算中最重要抽象之一。

本书采用动手实践的方法来揭示查询引擎的神秘面纱。我们不会调查现有系统，而是从头开始构建一个完全功能性的查询引擎，对每个组件进行足够的深入探讨，以便你可以实现自己的。

## 本书面向对象

本书面向希望了解查询引擎内部结构的软件工程师。你可能：

+   想了解查询为何以这种方式执行的数据库工程师

+   希望学习基础概念的数据库开发者

+   对编译器类系统感兴趣的软件工程师

+   正在构建需要解析或分析 SQL 的工具的人

假设具备基本的编程知识。示例使用 Kotlin，因为它简洁，但概念适用于任何语言。

## 你将学到什么

到本书结束时，你将了解如何：

+   使用 Apache Arrow 设计列式类型系统

+   为 CSV 和 Parquet 文件构建数据源连接器

+   将查询表示为逻辑和物理计划

+   创建 DataFrame API 以编程方式构建查询

+   将逻辑计划转换为可执行的物理计划

+   实现查询优化，如投影和谓词下推

+   解析 SQL 并将其转换为查询计划

+   在多个 CPU 核心上并行执行查询

+   设计跨集群的分布式查询执行

## 本书的组织结构

本书遵循查询引擎的自然架构，在上一层基础上构建每一层。

第一章至第四章涵盖基础内容。我们首先介绍查询引擎是什么，然后使用 Apache Arrow 建立内存模型的基础，一个用于表示数据的类型系统，以及用于读取文件的源数据抽象。

第五章至第七章涵盖查询表示。我们定义逻辑计划和表达式来抽象地表示查询，构建 DataFrame API 以编程方式构建计划，并添加 SQL 支持，以便可以使用熟悉的查询语言编写查询。

第八章至第十章涵盖执行。我们将逻辑计划转换为包含可执行代码的物理计划，然后介绍连接和子查询，这是查询处理中最复杂的两个操作。

第十一章至第十三章涵盖规划和优化。我们实现查询规划器来自动化逻辑到物理计划的转换，构建优化规则将计划转换为更有效的形式，并执行查询以比较性能。

第十四章和第十五章涵盖了扩展性。我们将引擎扩展到能够在 CPU 核心之间并行执行查询，然后扩展到分布式集群之间。

第十六章和第十七章涵盖了质量。我们涵盖了包括模糊测试在内的测试策略，以及用于衡量性能的基准测试方法。

*本书也以 ePub、MOBI 和 PDF 格式在[`leanpub.com/how-query-engines-work`](https://leanpub.com/how-query-engines-work)上提供购买。*

**版权所有 © 2020-2025 安迪·格鲁夫。保留所有权利。**
