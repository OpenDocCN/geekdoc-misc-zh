# 在国家层面上对盐和死亡率进行的统计分析

# 在国家层面上对盐和死亡率进行的统计分析

## 凯莉·奥托博尼

我叫凯莉·奥托博尼。我目前是加州大学伯克利分校统计系的博士生，也是伯克利数据科学研究所的数据科学研究员。我的研究重点是非参数统计、因果推断以及在健康和社会科学中的应用。我在本案例研究中描述的项目是对国家层面上盐消费与死亡率之间关联的调查。

### 工作流程

![Diagram](img/kottoboni.png) 这个项目始于我导师和加州大学尔湾分校公共卫生教授以及他的一名学生之间的合作。在我们的合作者开始整理数据集后，我参与了进来。数据包括人口统计和社会经济变量，以及 38 个国家的性别特定估计的钠、酒精和烟草消费。数据从几个来源汇总而来，变量在一个文本文件中描述。

第一步是决定我们需要哪些数据来回答这个问题：盐消费是否会影响一个国家 30 岁时的预期寿命？我们决定最好的方法是分别考虑男性和女性，并且通过观察生命预期、酒精、烟草和钠的消费以及经济变量随时间的变化来将一个国家视为自身的“对照”。我们有了所需的变量，但有一个年份缺少性别特定的酒精数据。这些数据无法获取，因此我们根据每个国家的性别比例和该年的整体消费来填充它们。我们还必须移除缺少生命预期数据（感兴趣的结果）的国家。除了实施这些步骤的 R 代码外，我还在进行中将它们描述在 LaTeX 报告中。

分析方法是我与导师一直在开发的一种新颖的假设检验方法。该方法的前提是使用所有协变量（除了感兴趣的治疗方法——钠）来预测感兴趣的结果，即寿命预期的变化。如果在控制已知健康预测因素后钠仍与寿命预期相关，那么钠消耗将与模型的残差相关联。这只是一个数学事实：模型无法解释的一些变异将与钠相关联。但是，这种关联有多大程度上是统计显著的呢？我们使用非参数置换检验来回答这个问题。在讨论我们的方法如何解决手头的问题后，我为算法的两个主要步骤编写了 R 代码：模型选择和非参数关联检验。我已经以 R 包格式编写了我们提出的统计方法的代码，并将其放在了一个公共的 GitHub 存储库中，因此我将这个项目的新代码添加到了该包中。我通过在我们的数据集上运行代码并检查输出看起来是否合理来迭代地开发代码。这并不是编写代码的最佳方式：理想情况下，我应该发明简单的测试用例并根据这些测试用例检查我的函数。

在编写每个 R 代码组件后，我将所有预处理、分析和绘图脚本组合到一个 R Markdown 文件中。knitr 允许您将 R Markdown（R 代码块与 Markdown 文本交错）编译成 PDF 或 HTML 文档。这样，我可以快速向合作者发送结果，并以用户友好的格式呈现。我将所有脚本、数据和编译后的 HTML 文档都发布在一个专门为这个项目设立的公共 GitHub 存储库中。

在这一点上，我们对分析的范围感到不满，并希望提出更多问题。特别是，我们想运行相同的关联测试，但使用烟草和酒精代替钠。这些分析将作为方法是否按预期运行的“理智检查”。鉴于我们知道酒精和吸烟对健康有负面影响，我们预期在模型的残差和酒精和烟草使用之间会找到负相关。原始数据集包括人均酒精消费，但没有烟草使用的测量。这需要我们在加州大学欧文分校的合作者从一篇现有的期刊文章中收集这些数据。在收到他们提供的烟草使用数据并进行基于模型的匹配分析后，我们意识到我们使用的吸烟测量并不是一个国家整体烟草消费的好指标。我们再次收集了不同的烟草数据，并最后一次运行了分析。由于 R 脚本已经编写，重新使用每个版本的数据进行分析就意味着改变几行代码。我保留了使用的每个数据版本，并根据发送给我的日期进行了命名。

我们相信我们已经做了所有需要回答我们提出的科学问题的统计分析。项目的分析部分大约花了六个月的时间完成。我们的合作者正在准备一篇手稿。我们正在使用 LaTeX 并通过电子邮件进行沟通。

工作流程图区分了三种类型的活动：思考和规划步骤用菱形标记，行动和实施用圆圈标记，文档和输出用矩形标记。虽然箭头指向右侧，框将工作流程的三个阶段分开，但这有点不真实。根据我的经验，在应用统计项目中涉及大量的迭代。此外，每个阶段中节点的数量并不反映花费的时间量。我的大部分时间都花在规划和文档编制上。一旦预处理和分析被脚本化，就可以很快地进行微小的更改。

### 痛点

我一直在努力解决的一个看似琐碎的问题是跟踪文件。使用 git 确实简化了文件组织的版本控制方面，但当我忘记两周前写的一段代码放在哪里时，这并没有帮助。在这个项目开始时左右，我开始保持一个“实验室笔记本”来组织我在做的各种项目的思维。我保留了一个专门给自己的文本文件夹，在那里我记下日期、想法和关注点、我做的工作的注释以及我保存该工作的文件或文件夹的名称。当我需要提醒自己有关一个项目的事情时，这对我有很大帮助，它也是一个存档会议记录和保存我以后可能想要与合作者分享的想法的好方法。

这个项目特别的痛点是试图鼓励我的合作者使用 GitHub 代码库。最终，我们最终通过电子邮件来回发送数据和结果。将更新的数据和结果推送到代码库会更有效率。

项目的数据收集部分不够透明。我们的代码库中没有包含任何用于从各种数据库和期刊文章中收集数据或合并这些数据来源的脚本。在某个时刻，在截止日期的压力下，我手动将烟草消费数据输入到 Excel 电子表格中。数据的所有预处理和分析都是可重复的，但数据收集的过程不是。

### 主要优势

可重复的工作流程最大的优势是效率。对于这个项目的分析有许多迭代。通过在同一文档中编写预处理、分析和结果，很容易进行小的更改，并确保它们出现在整个报告中。

将这个分析的主要函数合并到一个范围更广的 R 包中将在未来有益。我在这里编写的假设检验函数有很好的文档，风格统一，输入和输出一致。在 GitHub 上将它们全部放在一个包中，使任何阅读我们论文的人都可以轻松安装包并复制结果。

### 关键工具

对于这个工作流程，RStudio 和 knitr 至关重要。这是我第一次使用 knitr，我对用它创建的报告的质量感到满意，以便与同事分享结果。数据分析的所有步骤都在文档中，还有我对步骤的评论和解释。我希望这样可以使统计方法对我的合作者和未来读者透明化。此外，将所有表格和图形放在一个地方将使将结果放入手稿变得容易。

### 问题

#### 对你来说，“可重现性”是什么意思？

我认为，如果有足够的线索（以代码和说明的形式），任何人都可以从头到尾重现分析，那么数据分析项目就是可重现的。从另一个角度来看，如果某人可以对数据进行不同的分析，并得出基本相似的结论，那么该项目就是可重现的。

#### 你为什么认为在你的领域中可重现性很重要？

研究人员往往将“可重现性危机”归咎于统计学，特别是 p 值。我们作为统计学家的工作是通过尽可能正确和透明地进行统计分析，让人们清楚地知道他们的 p 值来反驳这一说法。

#### 你是从哪里或如何了解可重现性的？

我从本系的其他学生和互联网资源中自学了一些这些做法。

#### 在你的领域，你会推荐哪些最佳实践？

仔细和彻底地解释数据预处理和分析的每一个步骤。大量记录和注释代码。使代码和数据公开可用。

#### 你会推荐学习更多关于可重现性的具体资源吗？

Hadley Wickham 的*R Packages*书是一本宝贵的资源。他揭秘了 R 包的神秘，展示了如何使用 RStudio 使工作流程更加流畅和高效。
