# IVÂ äº¤ç»‡æ•°æ®ðŸ”—

> åŽŸæ–‡ï¼š[`htdp.org/2024-11-6/Book/part_four.html`](https://htdp.org/2024-11-6/Book/part_four.html)

| Â Â Â Â 19Â S è¡¨è¾¾å¼çš„è¯—æ„ |
| --- |
| Â Â Â Â Â Â 19.1Â æ ‘ |
| Â Â Â Â Â Â 19.2Â æ£®æž— |
| Â Â Â Â Â Â 19.3Â S è¡¨è¾¾å¼ |
| Â Â Â Â Â Â 19.4Â ä½¿ç”¨äº¤ç»‡æ•°æ®è®¾è®¡ |
| Â Â Â Â Â Â 19.5Â é¡¹ç›®ï¼šäºŒå‰æœç´¢æ ‘ |
| Â Â Â Â Â Â 19.6Â ç®€åŒ–å‡½æ•° |
| Â Â Â Â 20Â è¿­ä»£ç»†åŒ– |
| Â Â Â Â Â Â 20.1Â æ•°æ®åˆ†æž |
| Â Â Â Â Â Â 20.2Â ç»†åŒ–æ•°æ®å®šä¹‰ |
| Â Â Â Â Â Â 20.3Â ç»†åŒ–å‡½æ•° |
| Â Â Â Â 21Â ç»†åŒ–è§£é‡Šå™¨ |
| Â Â Â Â Â Â 21.1Â è§£é‡Šè¡¨è¾¾å¼ |
| Â Â Â Â Â Â 21.2Â è§£é‡Šå˜é‡ |
| Â Â Â Â Â Â 21.3Â è§£é‡Šå‡½æ•° |
| Â Â Â Â Â Â 21.4Â è§£é‡Šä¸€åˆ‡ |
| Â Â Â Â 22Â é¡¹ç›®ï¼šXML çš„å•†ä¸š |
| Â Â Â Â Â Â 22.1Â XML ä½œä¸º S è¡¨è¾¾å¼ |
| Â Â Â Â Â Â 22.2Â æ¸²æŸ“ XML æžšä¸¾ |
| Â Â Â Â Â Â 22.3Â é¢†åŸŸç‰¹å®šè¯­è¨€ |
| Â Â Â Â Â Â 22.4Â è¯»å– XML |
| Â Â Â Â 23Â åŒæ—¶å¤„ç† |
| Â Â Â Â Â Â 23.1Â åŒæ—¶å¤„ç†ä¸¤ä¸ªåˆ—è¡¨ï¼šæƒ…å†µ 1 |
| Â Â Â Â Â Â 23.2Â åŒæ—¶å¤„ç†ä¸¤ä¸ªåˆ—è¡¨ï¼šæƒ…å†µ 2 |
| Â Â Â Â Â Â 23.3Â åŒæ—¶å¤„ç†ä¸¤ä¸ªåˆ—è¡¨ï¼šæƒ…å†µ 3 |
| Â Â Â Â Â Â 23.4Â å‡½æ•°ç®€åŒ– |
| Â Â Â Â Â Â 23.5Â è®¾è®¡æ¶ˆè´¹ä¸¤ä¸ªå¤æ‚è¾“å…¥çš„å‡½æ•° |
| Â Â Â Â Â Â 23.6Â æ‰‹æŒ‡ç»ƒä¹ ï¼šä¸¤ä¸ªè¾“å…¥ |
| Â Â Â Â Â Â 23.7Â é¡¹ç›®ï¼šæ•°æ®åº“ |
| Â Â Â Â 24Â æ€»ç»“ |

ä½ å¯èƒ½ä¼šè®¤ä¸ºåˆ—è¡¨å’Œè‡ªç„¶æ•°çš„å®šä¹‰ç›¸å½“ä¸å¯»å¸¸ã€‚è¿™äº›æ•°æ®å®šä¹‰æ¶‰åŠè‡ªèº«ï¼Œå¹¶ä¸”å¾ˆå¯èƒ½è¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡é‡åˆ°è¿™æ ·çš„å®šä¹‰ã€‚å®žé™…ä¸Šï¼Œè®¸å¤šæ•°æ®ç±»åˆ«éœ€è¦æ¯”è¿™ä¸¤ä¸ªæ›´å¤æ‚çš„æ•°æ®å®šä¹‰ã€‚å¸¸è§çš„æŽ¨å¹¿æ¶‰åŠä¸€ä¸ªæ•°æ®å®šä¹‰ä¸­çš„è®¸å¤šè‡ªæˆ‘å¼•ç”¨æˆ–ä¸€ç³»åˆ—ç›¸äº’å¼•ç”¨çš„æ•°æ®å®šä¹‰ã€‚è¿™äº›æ•°æ®å½¢å¼å·²ç»å˜å¾—æ— å¤„ä¸åœ¨ï¼Œå› æ­¤å¯¹äºŽç¨‹åºå‘˜æ¥è¯´ï¼Œå­¦ä¼šå¤„ç†ä»»ä½•æ•°æ®å®šä¹‰é›†åˆè‡³å…³é‡è¦ã€‚è¿™æ­£æ˜¯è®¾è®¡é£Ÿè°±çš„å…¨éƒ¨å†…å®¹ã€‚

æœ¬éƒ¨åˆ†ä»Žå¯¹è®¾è®¡æ–¹æ¡ˆçš„æ³›åŒ–å¼€å§‹ï¼Œä½¿å…¶é€‚ç”¨äºŽæ‰€æœ‰å½¢å¼çš„ç»“æž„åŒ–æ•°æ®å®šä¹‰ã€‚æŽ¥ä¸‹æ¥ï¼Œå®ƒåŸºäºŽé¡¹ç›®ï¼šåˆ—è¡¨ä¸­çš„è¿­ä»£ç»†åŒ–æ¦‚å¿µè¿›è¡Œä»‹ç»ï¼Œå› ä¸ºå¤æ‚çš„æ•°æ®å®šä¹‰ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œè€Œæ˜¯åœ¨å‡ ä¸ªé˜¶æ®µé€æ­¥å‘å±•ã€‚å®žé™…ä¸Šï¼Œè¿­ä»£ç»†åŒ–çš„ä½¿ç”¨æ˜¯æ‰€æœ‰ç¨‹åºå‘˜éƒ½æ˜¯å°å°ç§‘å­¦å®¶ä»¥åŠæˆ‘ä»¬çš„å­¦ç§‘åœ¨ç¾Žå¼åç§°ä¸­ä½¿ç”¨â€œç§‘å­¦â€ä¸€è¯çš„åŽŸå› ä¹‹ä¸€ã€‚æœ€åŽä¸¤ç« é˜è¿°äº†è¿™äº›æ€æƒ³ï¼šä¸€ç« è§£é‡Šäº†å¦‚ä½•ä¸º BSL è®¾è®¡è§£é‡Šå™¨ï¼Œå¦ä¸€ç« æ˜¯å…³äºŽå¤„ç† XMLï¼Œè¿™æ˜¯ä¸€ç§ç½‘ç»œæ•°æ®äº¤æ¢è¯­è¨€ã€‚æœ€åŽä¸€ç« å†æ¬¡æ‰©å±•äº†è®¾è®¡æ–¹æ¡ˆï¼Œé‡æ–°è®¾è®¡ä»¥å¤„ç†åŒæ—¶å¤„ç†ä¸¤ä¸ªå¤æ‚å‚æ•°çš„å‡½æ•°ã€‚

### 19 S è¡¨è¾¾å¼çš„è¯—æ„ðŸ”— "é“¾æŽ¥è‡³æ­¤")

ç¼–ç¨‹ç±»ä¼¼äºŽè¯—æ­Œã€‚åƒè¯—äººä¸€æ ·ï¼Œç¨‹åºå‘˜åœ¨çœ‹ä¼¼æ— æ„ä¹‰çš„æ€æƒ³ä¸Šç»ƒä¹ ä»–ä»¬çš„æŠ€èƒ½ã€‚ä»–ä»¬ä¸æ–­åœ°ä¿®è®¢å’Œç¼–è¾‘ï¼Œæ­£å¦‚å‰ä¸€ç« æ‰€è§£é‡Šçš„ã€‚æœ¬ç« ä»‹ç»äº†è¶Šæ¥è¶Šå¤æ‚çš„æ•°æ®å½¢å¼â€”â€”çœ‹ä¼¼æ²¡æœ‰çœŸæ­£çš„çŽ°å®žä¸–ç•Œç”¨é€”ã€‚å³ä½¿æˆ‘ä»¬æä¾›äº†åŠ¨æœºèƒŒæ™¯ï¼Œé€‰æ‹©çš„æ•°æ®ç±»åž‹ä¹Ÿæ˜¯æžç«¯çº¯ç²¹çš„ï¼Œä½ ä¸å¤ªå¯èƒ½å†æ¬¡é‡åˆ°å®ƒä»¬ã€‚

ç„¶è€Œï¼Œæœ¬ç« å±•ç¤ºäº†è®¾è®¡æ–¹æ¡ˆçš„å®Œæ•´åŠ›é‡ï¼Œå¹¶ä»‹ç»äº†çŽ°å®žä¸–ç•Œç¨‹åºå¤„ç†çš„æ•°æ®ç±»åž‹ã€‚ä¸ºäº†å°†è¿™éƒ¨åˆ†å†…å®¹ä¸Žä½ åœ¨ä½œä¸ºç¨‹åºå‘˜çš„ç”Ÿæ´»ä¸­ä¼šé‡åˆ°çš„å†…å®¹è”ç³»èµ·æ¥ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªéƒ¨åˆ†æ·»åŠ äº†é€‚å½“çš„åç§°ï¼šæ ‘ã€æ£®æž—ã€XMLã€‚æœ€åŽä¸€ä¸ªåç§°æœ‰ç‚¹è¯¯å¯¼ï¼Œå› ä¸ºå®ƒå®žé™…ä¸Šå…³äºŽ S è¡¨è¾¾å¼ï¼›S è¡¨è¾¾å¼ä¸Ž XML ä¹‹é—´çš„è”ç³»åœ¨é¡¹ç›®ï¼šXML çš„å•†ä¸šäº¤æ˜“ä¸­å¾—åˆ°äº†é˜æ˜Žï¼Œä¸Žæœ¬ç« ç›¸æ¯”ï¼Œå®ƒæ›´æŽ¥è¿‘çŽ°å®žä¸–ç•Œä¸­å¤æ‚æ•°æ®å½¢å¼çš„åº”ç”¨ã€‚

#### 19.1 æ ‘ðŸ”— "é“¾æŽ¥è‡³æ­¤")

æˆ‘ä»¬æ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå®¶æ—æ ‘ã€‚ç»˜åˆ¶å®¶æ—æ ‘çš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨æ¯æ¬¡æœ‰å­©å­å‡ºç”Ÿæ—¶æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†çˆ¶äº²å’Œæ¯äº²çš„å…ƒç´ è¿žæŽ¥èµ·æ¥ã€‚å¯¹äºŽé‚£äº›çˆ¶æ¯ä¸ä¸ºäººçŸ¥çš„äººï¼Œæ²¡æœ‰å¯ä»¥è¿žæŽ¥çš„å…ƒç´ ã€‚ç»“æžœæ˜¯ç¥–å…ˆå®¶æ—æ ‘ï¼Œå› ä¸ºï¼Œå¯¹äºŽä»»ä½•ä¸€ä¸ªäººæ¥è¯´ï¼Œè¿™æ£µæ ‘éƒ½æŒ‡å‘è¯¥äººæ‰€æœ‰å·²çŸ¥çš„ç¥–å…ˆã€‚

> > > > ![å›¾ç‰‡](img/ee2a68d522cfb0c9128cc6dda4bee436.png)
> > > > 
> å›¾ 111ï¼šå®¶æ—æ ‘

å›¾ 111 å±•ç¤ºäº†ä¸€ä¸ªä¸‰å±‚å®¶åº­æ ‘ã€‚å¤æ–¯å¡”å¤«æ˜¯ä¼Šå¨ƒå’Œå¼—é›·å¾·çš„å„¿å­ï¼Œè€Œä¼Šå¨ƒæ˜¯å¡å°”å’Œè´è’‚å¨œçš„å¥³å„¿ã€‚é™¤äº†äººä»¬çš„åå­—å’Œå®¶åº­å…³ç³»å¤–ï¼Œè¿™æ£µæ ‘è¿˜è®°å½•äº†å‡ºç”Ÿå¹´ä»½å’Œçœ¼ç›é¢œè‰²ã€‚åŸºäºŽè¿™ä¸ªè‰å›¾ï¼Œä½ å¯ä»¥è½»æ¾åœ°æƒ³è±¡ä¸€æ£µå¯ä»¥è¿½æº¯åˆ°è®¸å¤šä»£äººçš„å®¶æ—æ ‘ï¼Œå¹¶è®°å½•å…¶ä»–ç±»åž‹çš„ä¿¡æ¯ã€‚

ä¸€æ—¦å®¶è°±å˜å¾—åºžå¤§ï¼Œå°†å…¶è¡¨ç¤ºä¸ºæ•°æ®å¹¶è®¾è®¡å¤„ç†æ­¤ç±»æ•°æ®çš„ç¨‹åºå°±å˜å¾—æœ‰æ„ä¹‰ã€‚é‰´äºŽå®¶è°±ä¸­çš„ä¸€ä¸ªç‚¹ç»“åˆäº†äº”æ¡ä¿¡æ¯â€”â€”çˆ¶äº²ã€æ¯äº²ã€åå­—ã€å‡ºç”Ÿæ—¥æœŸå’Œçœ¼ç›é¢œè‰²â€”â€”æˆ‘ä»¬åº”è¯¥å®šä¹‰ä¸€ä¸ªç»“æž„ç±»åž‹ï¼š

> ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â childÂ [fatherÂ motherÂ nameÂ dateÂ eyes])

ç»“æž„ç±»åž‹å®šä¹‰è°ƒç”¨æ•°æ®å®šä¹‰ï¼š

> | ;Â A Child is a structure: |
> | --- |
> | ;Â Â Â (make-child  Child  Child  String  N  String) |

è™½ç„¶è¿™ä¸ªæ•°æ®å®šä¹‰çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†å®ƒä¹Ÿæ˜¯æ— ç”¨çš„ã€‚å®ƒæŒ‡å‘è‡ªèº«ï¼Œä½†ç”±äºŽå®ƒæ²¡æœ‰ä»»ä½•å­å¥ï¼Œå› æ­¤æ— æ³•åˆ›å»ºä¸€ä¸ªåˆé€‚çš„å®žä¾‹ Childã€‚å¤§è‡´æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å†™å‡ºä»¥ä¸‹å†…å®¹ï¼š

> (make-childÂ (make-childÂ (make-childÂ [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))

æ²¡æœ‰å°½å¤´ã€‚ä¸ºäº†é¿å…è¿™ç§æ— æ„ä¹‰çš„æ•°æ®å®šä¹‰ï¼Œæˆ‘ä»¬è¦æ±‚è‡ªå¼•ç”¨çš„æ•°æ®å®šä¹‰æœ‰å‡ ä¸ªå­å¥ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªå­å¥ä¸å¼•ç”¨æ•°æ®å®šä¹‰æœ¬èº«ã€‚è®©æˆ‘ä»¬æš‚æ—¶æŽ¨è¿Ÿæ•°æ®å®šä¹‰ï¼Œå…ˆè¿›è¡Œå®žéªŒã€‚å‡è®¾æˆ‘ä»¬å³å°†å‘çŽ°æœ‰çš„å®¶è°±ä¸­æ·»åŠ ä¸€ä¸ªå­©å­ï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»æœ‰äº†çˆ¶æ¯çš„è¡¨ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€æž„å»ºä¸€ä¸ªæ–°çš„å­©å­ç»“æž„ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†åœ¨å·²ç»è¡¨ç¤ºäº† Carl å’Œ Betina çš„ç¨‹åºä¸­è¡¨ç¤º Adamï¼Œåªéœ€æ·»åŠ ä»¥ä¸‹å­©å­ç»“æž„ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â Adam |
> | --- |
> | Â Â (make-childÂ CarlÂ BettinaÂ "Adam"Â 1950Â "hazel")) |

å‡è®¾ Carl å’Œ Betina ä»£è¡¨ Adam çˆ¶æ¯çš„è¡¨ç¤ºã€‚å†æ¬¡ï¼Œä¸€ä¸ªäººçš„çˆ¶æ¯å¯èƒ½æ˜¯æœªçŸ¥çš„ï¼Œå°±åƒåœ¨å›¾ 111 çš„å®¶åº­æ ‘ä¸­ Bettina çš„æƒ…å†µä¸€æ ·ã€‚å³ä½¿åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»åœ¨å­©å­è¡¨ç¤ºä¸­å¡«å†™ç›¸åº”çš„çˆ¶æ¯å­—æ®µã€‚æ— è®ºæˆ‘ä»¬é€‰æ‹©ä»€ä¹ˆæ•°æ®ï¼Œå®ƒéƒ½å¿…é¡»è¡¨ç¤ºä¿¡æ¯çš„ç¼ºå¤±ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çŽ°æœ‰çš„å€¼æ± ä¸­çš„#falseã€"none"æˆ–'()ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å®žé™…ä¸Šåº”è¯¥è¯´ä¿¡æ¯åœ¨å®¶åº­æ ‘ä¸­ç¼ºå¤±ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥ä¸€ä¸ªå…·æœ‰é€‚å½“åç§°çš„ç»“æž„ç±»åž‹æ¥å®žçŽ°è¿™ä¸€ç›®æ ‡ï¼š

> ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â no-parentÂ [])

çŽ°åœ¨ï¼Œä¸ºäº†æž„å»ºä¸€ä¸ª Bettina çš„å­ç»“æž„ï¼Œæˆ‘ä»¬è¯´

> | (make-childÂ (make-no-parent) |
> | --- |
> | Â Â Â Â Â Â Â Â Â Â Â Â (make-no-parent) |
> | Â Â Â Â Â Â Â Â Â Â Â Â "Bettina"Â 1926Â "green") |

å½“ç„¶ï¼Œå¦‚æžœåªæœ‰ä¸€æ¡ä¿¡æ¯ç¼ºå¤±ï¼Œæˆ‘ä»¬åªéœ€ç”¨è¿™ä¸ªç‰¹æ®Šå€¼å¡«å……è¯¥å­—æ®µã€‚æˆ‘ä»¬çš„å®žéªŒè¡¨æ˜Žæœ‰ä¸¤ä¸ªè§è§£ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä¸æ˜¯åœ¨å¯»æ‰¾æè¿°å¦‚ä½•ç”Ÿæˆå­ç»“æž„å®žä¾‹çš„æ•°æ®å®šä¹‰ï¼Œè€Œæ˜¯åœ¨å¯»æ‰¾æè¿°å¦‚ä½•è¡¨ç¤ºå®¶è°±çš„æ•°æ®å®šä¹‰ã€‚å…¶æ¬¡ï¼Œæ•°æ®å®šä¹‰ç”±ä¸¤ä¸ªå­å¥ç»„æˆï¼Œä¸€ä¸ªç”¨äºŽæè¿°æœªçŸ¥å®¶è°±çš„å˜ä½“ï¼Œå¦ä¸€ä¸ªç”¨äºŽæè¿°å·²çŸ¥å®¶è°±ï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â no-parentÂ []) |
> | --- |
> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â childÂ [fatherÂ motherÂ nameÂ dateÂ eyes]) |
> | ;Â An FT (short for family tree) is one of: |
> | ;Â â€“  (make-no-parent) |
> | ;Â â€“  (make-child  FT  FT  String  N  String) |

Since the â€œno parentâ€ tree is going to show up a lot in our programs, we define NP as a short-hand and revise the data definition a bit:

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â NPÂ (make-no-parent)) |
> | --- |
> | ;Â An FT is one of: |
> | ;Â â€“  NP |
> | ;Â â€“  (make-child  FT  FT  String  N  String) |

æ ¹æ®è®¾è®¡è‡ªå¼•ç”¨æ•°æ®å®šä¹‰çš„è®¾è®¡é…æ–¹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°æ®å®šä¹‰æ¥åˆ›å»ºå®¶è°±çš„ç¤ºä¾‹ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†å›¾ 111 ä¸­çš„å®¶è°±è½¬æ¢ä¸ºæˆ‘ä»¬çš„æ•°æ®è¡¨ç¤ºã€‚Carl çš„ä¿¡æ¯å¾ˆå®¹æ˜“è½¬æ¢ä¸ºæ•°æ®ï¼š

> (make-childÂ NPÂ NPÂ "Carl"Â 1926Â "green")

Bettina å’Œ Fred ç”¨ç±»ä¼¼çš„å­ç»“æž„å®žä¾‹è¡¨ç¤ºã€‚å¯¹äºŽ Adam çš„æƒ…å†µï¼Œéœ€è¦åµŒå¥—å­ç»“æž„ï¼Œä¸€ä¸ªç”¨äºŽ Carlï¼Œä¸€ä¸ªç”¨äºŽ Bettinaï¼š

> | (make-childÂ (make-childÂ NPÂ NPÂ "Carl"Â 1926Â "green") |
> | --- |
> | Â Â Â Â Â Â Â Â Â Â Â Â (make-childÂ NPÂ NPÂ "Bettina"Â 1926Â "green") |
> | Â Â Â Â Â Â Â Â Â Â Â Â "Adam" |
> | Â Â Â Â Â Â Â Â Â Â Â Â 1950 |
> | Â Â Â Â Â Â Â Â Â Â Â Â "hazel") |

ç”±äºŽ Carl å’Œ Bettina çš„è®°å½•ä¹Ÿéœ€è¦ç”¨æ¥æž„å»º Dave å’Œ Eva çš„è®°å½•ï¼Œå› æ­¤å¼•å…¥å‘½åç‰¹å®šå­å®žä¾‹çš„å®šä¹‰å¹¶ä½¿ç”¨å˜é‡ååœ¨å…¶ä»–åœ°æ–¹ä¼šæ›´å¥½ã€‚å›¾ 112 å±•ç¤ºäº†ä»Ž å›¾ 111 åˆ°å®¶è°±å®Œæ•´æ•°æ®è¡¨ç¤ºçš„è¿™ç§æ–¹æ³•ã€‚ä»”ç»†è§‚å¯Ÿï¼›è¿™æ£µæ ‘å°†ä½œä¸ºæˆ‘ä»¬ä»¥ä¸‹è®¾è®¡ç»ƒä¹ çš„è¿è¡Œç¤ºä¾‹ã€‚

> > > | ;Â æœ€è€ä¸€ä»£ï¼š |
> > > | --- |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â CarlÂ (make-childÂ NPÂ NPÂ "Carl"Â 1926Â "green")) |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â BettinaÂ (make-childÂ NPÂ NPÂ "Bettina"Â 1926Â "green")) |
> > > |   |
> > > | ;Â ä¸­é—´ä¸€ä»£ï¼š |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â AdamÂ (make-childÂ CarlÂ BettinaÂ "Adam"Â 1950Â "hazel")) |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â DaveÂ (make-childÂ CarlÂ BettinaÂ "Dave"Â 1955Â "black")) |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â EvaÂ (make-childÂ CarlÂ BettinaÂ "Eva"Â 1965Â "blue")) |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â FredÂ (make-childÂ NPÂ NPÂ "Fred"Â 1966Â "pink")) |
> > > |   |
> > > | ;Â å¹´è½»ä¸€ä»£ï¼š |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â GustavÂ (make-childÂ FredÂ EvaÂ "Gustav"Â 1988Â "brown")) |
> > > 
> å›¾ 112ï¼šæ ·æœ¬å®¶è°±çš„æ•°æ®è¡¨ç¤º

è€Œä¸æ˜¯ä¸ºå®¶è°±è®¾è®¡ä¸€ä¸ªå…·ä½“çš„å‡½æ•°ï¼Œè®©æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹è¿™æ ·ä¸€ä¸ªå‡½æ•°çš„é€šç”¨ç»„ç»‡ç»“æž„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè®©æˆ‘ä»¬å°½å¯èƒ½å¤šåœ°æŒ‰ç…§è®¾è®¡é…æ–¹è¿›è¡Œæ“ä½œï¼Œè€Œä¸éœ€è¦è€ƒè™‘å…·ä½“ä»»åŠ¡ã€‚æˆ‘ä»¬ä»Žå¤´éƒ¨ææ–™å¼€å§‹ï¼Œå³é…æ–¹çš„ç¬¬äºŒæ­¥ï¼š

> | ;Â FT -> ??? |
> | --- |
> | ;Â ... |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (fun-FTÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |

å°½ç®¡æˆ‘ä»¬æ²¡æœ‰æ˜Žç¡®è¯´æ˜Žå‡½æ•°çš„ç›®çš„ï¼Œä½†æˆ‘ä»¬çŸ¥é“å®ƒæ¶ˆè€—ä¸€ä¸ªå®¶è°±æ ‘ï¼Œå¹¶ä¸”è¿™ç§æ•°æ®å½¢å¼æ˜¯ä¸»è¦è¾“å…¥ã€‚ç­¾åä¸­çš„â€œ???â€è¡¨ç¤ºæˆ‘ä»¬ä¸çŸ¥é“å‡½æ•°äº§ç”Ÿä»€ä¹ˆç±»åž‹çš„æ•°æ®ï¼›â€œ...â€æé†’æˆ‘ä»¬ä¸çŸ¥é“å®ƒçš„ç›®çš„ã€‚ç›®çš„çš„ç¼ºå¤±æ„å‘³ç€æˆ‘ä»¬æ— æ³•æž„å»ºåŠŸèƒ½ç¤ºä¾‹ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ FT æ•°æ®å®šä¹‰çš„ç»„ç»‡æ¥è®¾è®¡ä¸€ä¸ªæ¨¡æ¿ã€‚ç”±äºŽå®ƒç”±ä¸¤ä¸ªå­å¥ç»„æˆï¼Œå› æ­¤æ¨¡æ¿å¿…é¡»ç”±ä¸¤ä¸ªå­å¥çš„[æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)è¡¨è¾¾å¼ç»„æˆï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (fun-FTÂ an-ftree) |
> | --- |
> | Â Â ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â [(no-parent?Â an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> | Â Â Â Â [[å¦åˆ™](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)])) |

å¦‚æžœ fun-FT çš„å‚æ•°æ»¡è¶³ no-parent?ï¼Œåˆ™ç»“æž„ä¸­ä¸åŒ…å«å…¶ä»–æ•°æ®ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå­å¥æ˜¯å®Œæ•´çš„ã€‚å¯¹äºŽç¬¬äºŒä¸ªå­å¥ï¼Œè¾“å…¥åŒ…å«äº”ä¸ªæ•°æ®é¡¹ï¼Œæˆ‘ä»¬åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨äº”ä¸ªé€‰æ‹©å™¨æ¥è¡¨ç¤ºï¼š

> | ;Â FT -> ??? |
> | --- |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (fun-FTÂ an-ftree) |
> | Â Â ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â [(no-parent?Â an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> | Â Â Â Â [[å¦åˆ™](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-fatherÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-motherÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-nameÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-dateÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-eyesÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))])) |

æ¨¡æ¿ä¸­æœ€åŽå¢žåŠ çš„å†…å®¹æ¶‰åŠè‡ªå¼•ç”¨ã€‚å¦‚æžœä¸€ä¸ªæ•°æ®å®šä¹‰å¼•ç”¨äº†è‡ªèº«ï¼Œå‡½æ•°å¾ˆå¯èƒ½ä¼šé€’å½’ï¼Œæ¨¡æ¿é€šè¿‡æš—ç¤ºæ€§çš„è‡ªç„¶é€’å½’æ¥è¡¨ç¤ºè¿™ä¸€ç‚¹ã€‚å¯¹äºŽ FT çš„å®šä¹‰æœ‰ä¸¤ä¸ªè‡ªå¼•ç”¨ï¼Œå› æ­¤æ¨¡æ¿éœ€è¦ä¸¤ä¸ªè¿™æ ·çš„é€’å½’ï¼š

> | ;Â FT -> ??? |
> | --- |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (fun-FTÂ an-ftree) |
> | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â [(no-parent?Â an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (fun-FTÂ (child-fatherÂ an-ftree))Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (fun-FTÂ (child-motherÂ an-ftree))Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | |Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-nameÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | |Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-dateÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | |Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-eyesÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))])) |

å…·ä½“æ¥è¯´ï¼Œfun-FT è¢«åº”ç”¨äºŽç¬¬äºŒ[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥ä¸­çˆ¶äº²å’Œæ¯äº²çš„è¡¨ç¤ºæ•°æ®ï¼Œå› ä¸ºæ•°æ®å®šä¹‰çš„ç¬¬äºŒå­å¥åŒ…å«ç›¸åº”çš„è‡ªå¼•ç”¨ã€‚çŽ°åœ¨è®©æˆ‘ä»¬è½¬å‘ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œå³ blue-eyed-child?å‡½æ•°ã€‚å®ƒçš„ç›®çš„æ˜¯ç¡®å®šç»™å®šå®¶è°±æ ‘ä¸­æ˜¯å¦æœ‰ä»»ä½•å­©å­ç»“æž„æœ‰è“çœ¼ç›ã€‚æ‚¨å¯ä»¥å¤åˆ¶ã€ç²˜è´´å¹¶é‡å‘½å fun-FT ä»¥èŽ·å–å…¶æ¨¡æ¿ï¼›æˆ‘ä»¬å°†â€œ???â€æ›¿æ¢ä¸ºå¸ƒå°”å¹¶æ·»åŠ ä¸€ä¸ªç›®çš„è¯´æ˜Žï¼š

> | ;Â FT -> å¸ƒå°” |
> | --- |
> | ;Â an-ftree æ˜¯å¦åŒ…å«å­©å­ |
> | ;Â ç»“æž„ä¸­çœ¼ç›å­—æ®µåŒ…å«"blue" |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (blue-eyed-child?Â an-ftree) |
> | |Â Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | |Â Â Â Â [(no-parent?Â an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> | |Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (blue-eyed-child? |
> | |Â Â Â (child-fatherÂ an-ftree))Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | |Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (blue-eyed-child? |
> | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (child-motherÂ an-ftree))Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-nameÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-dateÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> | Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (child-eyesÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))])) |

å½“ä½ ä»¥è¿™ç§æ–¹å¼å·¥ä½œæ—¶ï¼Œä½ å¿…é¡»ç”¨ç‰¹å®šçš„åç§°æ›¿æ¢æ¨¡æ¿çš„é€šç”¨åç§°ã€‚æ ¹æ®æˆ‘ä»¬çš„é…æ–¹æ£€æŸ¥ï¼Œæˆ‘ä»¬æ„è¯†åˆ°åœ¨è¿›å…¥å®šä¹‰æ­¥éª¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å›žæº¯å¹¶å¼€å‘ä¸€äº›ç¤ºä¾‹ã€‚å¦‚æžœæˆ‘ä»¬ä»Žå®¶è°±ä¸­çš„ç¬¬ä¸€ä¸ªäººå¡å°”å¼€å§‹ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¡å°”çš„å®¶è°±ä¸­ä¸åŒ…å«æœ‰â€œè“è‰²â€çœ¼ç›é¢œè‰²çš„å­©å­ã€‚å…·ä½“æ¥è¯´ï¼Œä»£è¡¨å¡å°”çš„å­©å­çš„çœ¼ç›é¢œè‰²æ˜¯â€œç»¿è‰²â€ï¼›é‰´äºŽå¡å°”çš„ç¥–å…ˆæ ‘æ˜¯ç©ºçš„ï¼Œå®ƒä»¬ä¸å¯èƒ½åŒ…å«æœ‰â€œè“è‰²â€çœ¼ç›é¢œè‰²çš„å­©å­ï¼š

> ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-child?Â Carl)Â #false)

ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¤æ–¯å¡”å¤«æœ‰ä¸€ä¸ªå­©å­å«ä¼Šå¨ƒï¼Œå¥¹ç¡®å®žæœ‰è“çœ¼ç›ï¼š

> ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-child?Â Gustav)Â #true)

çŽ°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½å®šä¹‰å®žé™…å‡½æ•°äº†ã€‚è¯¥å‡½æ•°åŒºåˆ†ä¸¤ç§æƒ…å†µï¼šæ— çˆ¶æ¯å’Œæœ‰å­©å­ã€‚å¯¹äºŽç¬¬ä¸€ç§æƒ…å†µï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰ä¸¾å‡ºä»»ä½•ä¾‹å­ï¼Œç­”æ¡ˆä¹Ÿåº”è¯¥å¾ˆæ˜Žæ˜¾ã€‚ç”±äºŽç»™å®šçš„å®¶è°±æ ¹æœ¬ä¸åŒ…å«ä»»ä½•å­©å­ï¼Œå®ƒä¸å¯èƒ½åŒ…å«ä¸€ä¸ªçœ¼ç›é¢œè‰²ä¸ºâ€œè“è‰²â€çš„å­©å­ã€‚å› æ­¤ï¼Œç¬¬ä¸€ä¸ª [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å­å¥çš„ç»“æžœæ˜¯ #falseã€‚

å¯¹äºŽç¬¬äºŒä¸ª [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å­å¥ï¼Œè®¾è®¡éœ€è¦åšæ›´å¤šçš„å·¥ä½œã€‚å†æ¬¡éµå¾ªè®¾è®¡é…æ–¹ï¼Œæˆ‘ä»¬é¦–å…ˆæé†’è‡ªå·±æ¨¡æ¿ä¸­çš„è¡¨è¾¾å¼å®Œæˆäº†ä»€ä¹ˆï¼š

1.  æ ¹æ®å‡½æ•°çš„ç›®çš„å£°æ˜Žï¼Œ

    > (blue-eyed-child?Â (child-fatherÂ an-ftree))

    åˆ¤æ–­çˆ¶äº² FT ä¸­çš„æŸä¸ªå­©å­æ˜¯å¦æœ‰ "blue" çœ¼ç›ï¼›

1.  åŒæ ·åœ°ï¼Œ(blue-eyed-child?  (child-mother  an-ftree)) åˆ¤æ–­æ¯äº² FT ä¸­æ˜¯å¦æœ‰äººæœ‰è“çœ¼ç›ï¼›å¹¶ä¸”

1.  é€‰æ‹©è¡¨è¾¾å¼ (child-name  an-ftree), (child-date  an-ftree), å’Œ (child-eyes  an-ftree) åˆ†åˆ«ä»Žç»™å®šçš„å­©å­ç»“æž„ä¸­æå–åç§°ã€å‡ºç”Ÿæ—¥æœŸå’Œçœ¼ç›é¢œè‰²ã€‚

çŽ°åœ¨æˆ‘ä»¬åªéœ€è¦å¼„æ¸…æ¥šå¦‚ä½•ç»„åˆè¿™äº›è¡¨è¾¾å¼ã€‚

æ˜¾ç„¶ï¼Œå¦‚æžœå­©å­ç»“æž„ä¸­çš„çœ¼ç›å­—æ®µåŒ…å« "blue"ï¼Œåˆ™å‡½æ•°çš„ç­”æ¡ˆæ˜¯ #trueã€‚æŽ¥ä¸‹æ¥ï¼Œå…³äºŽåç§°å’Œå‡ºç”Ÿæ—¥æœŸçš„è¡¨è¾¾å¼æ˜¯æ— ç”¨çš„ï¼Œè¿™è®©æˆ‘ä»¬åªå‰©ä¸‹é€’å½’è°ƒç”¨ã€‚æ­£å¦‚æ‰€è¿°ï¼Œ(blue-eyed-child?  (child-father  an-ftree)) éåŽ†çˆ¶äº²ä¸€ä¾§çš„æ ‘ï¼Œè€Œå®¶åº­æ ‘çš„æ¯äº²ä¸€ä¾§åˆ™é€šè¿‡ (blue-eyed-child?  (child-mother  an-ftree)) å¤„ç†ã€‚å¦‚æžœè¿™äº›è¡¨è¾¾å¼ä¸­çš„ä»»ä½•ä¸€ä¸ªè¿”å›ž #trueï¼Œåˆ™ an-ftree åŒ…å«ä¸€ä¸ªæœ‰ "blue" çœ¼ç›çš„å­©å­ã€‚

æˆ‘ä»¬çš„åˆ†æžè¡¨æ˜Žï¼Œå¦‚æžœä»¥ä¸‹ä¸‰ä¸ªè¡¨è¾¾å¼ä¸­çš„ä»»ä½•ä¸€ä¸ªä¸º #trueï¼Œåˆ™ç»“æžœåº”è¯¥æ˜¯ #trueï¼š

+   ([string=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3d~3f%29%29)  (child-eyes  an-ftree)  "blue")

+   (blue-eyed-child?  (child-father  an-ftree))

+   (blue-eyed-child?  (child-mother  an-ftree))

è¿™åè¿‡æ¥æ„å‘³ç€æˆ‘ä»¬éœ€è¦å°†è¿™äº›è¡¨è¾¾å¼ä¸Ž [or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29) ç»“åˆèµ·æ¥ï¼š

> | ([or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)Â ([string=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3d~3f%29%29)Â (child-eyesÂ an-ftree)Â "blue") |
> | --- |
> | Â Â Â Â (blue-eyed-child?Â (child-fatherÂ an-ftree)) |
> | Â Â Â Â (blue-eyed-child?Â (child-motherÂ an-ftree))) |

å›¾Â 113 å°†æ‰€æœ‰å†…å®¹åœ¨ä¸€ä¸ªå®šä¹‰ä¸­æ±‡æ€»ã€‚

> > > | ;Â FT -> Boolean |
> > > | --- |
> > > | ;Â an-ftree æ˜¯å¦åŒ…å«ä¸€ä¸ªå­©å­ |
> > > | ;Â çœ¼ç›å­—æ®µä¸­åŒ…å« "blue" çš„ç»“æž„ |
> > > | Â  |
> > > | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-child?Â Carl)Â #false) |
> > > | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-child?Â Gustav)Â #true) |
> > > | Â  |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (blue-eyed-child?Â an-ftree) |
> > > | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â [(no-parent?Â an-ftree)Â #false] |
> > > | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)Â ([string=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3d~3f%29%29)Â (child-eyesÂ an-ftree)Â "blue") |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â Â Â (blue-eyed-child?Â (child-fatherÂ an-ftree)) |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â Â Â (blue-eyed-child?Â (child-motherÂ an-ftree)))])) |
> > > 
> å›¾ 113ï¼šåœ¨ç¥–å…ˆæ ‘ä¸­å¯»æ‰¾è“çœ¼ç›çš„å­©å­

ç”±äºŽè¿™ä¸ªå‡½æ•°æ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨ä¸¤æ¬¡é€’å½’çš„å‡½æ•°ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†æ­¥è¿›å™¨çš„åŠ¨ä½œæ¥ä¸º (blue-eyed-child? Carl) æä¾›ä¸€ä¸ªå¦‚ä½•å·¥ä½œçš„å°è±¡ï¼š

> | (blue-eyed-child?Â Carl) |
> | --- |
> | == |
> | (blue-eyed-child? |
> | Â Â (make-childÂ NPÂ NPÂ "Carl"Â 1926Â "green")) |

è®©æˆ‘ä»¬å‡è®¾ NP æ˜¯ä¸€ä¸ªå€¼ï¼Œå¹¶ä½¿ç”¨ carl ä½œä¸º child å®žä¾‹çš„ç¼©å†™ï¼š

> | == |
> | --- |
> | ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â [(no-parent? |
> | Â Â Â Â Â (make-childÂ NPÂ NPÂ "Carl"Â 1926Â "green")) |
> | Â Â Â #false] |
> | Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)Â ([string=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3d~3f%29%29)Â (child-eyesÂ carl)Â "blue") |
> | Â Â Â Â Â Â Â Â Â Â Â Â (blue-eyed-child?Â (child-fatherÂ carl)) |
> | Â Â Â Â Â Â Â Â Â Â Â Â (blue-eyed-child?Â (child-motherÂ carl)))]) |

åœ¨åˆ é™¤ç¬¬ä¸€æ¡ [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) è¡Œä¹‹åŽï¼Œæ˜¯æ—¶å€™ç”¨å…¶å€¼æ›¿æ¢ carl å¹¶æ‰§è¡Œ å›¾ 114 ä¸­çš„ä¸‰ä¸ªè¾…åŠ©è®¡ç®—äº†ã€‚ä½¿ç”¨è¿™äº›è®¡ç®—ç»“æžœæ¥æ›¿æ¢ç­‰å·ä¸¤è¾¹çš„ç­‰å·ï¼Œå…¶ä½™çš„è®¡ç®—è§£é‡Šèµ·æ¥å°±å¾ˆå®¹æ˜“äº†ï¼š

> | == |
> | --- |
> | ([or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)Â ([string=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3d~3f%29%29)Â "green"Â "blue") |
> | Â Â Â Â (blue-eyed-child?Â (child-fatherÂ carl)) |
> | Â Â Â Â (blue-eyed-child?Â (child-motherÂ carl))) |
> | ==Â ([æˆ–](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)Â #falseÂ #falseÂ #false) |
> | ==Â #false |

è™½ç„¶æˆ‘ä»¬ç›¸ä¿¡ä½ åœ¨æ•°å­¦è¯¾ç¨‹ä¸­å·²ç»è§è¿‡è¿™æ ·çš„è¾…åŠ©è®¡ç®—ï¼Œä½†ä½ è¿˜éœ€è¦ç†è§£ï¼Œæ­¥è¿›å™¨ä¸ä¼šæ‰§è¡Œè¿™æ ·çš„è®¡ç®—ï¼›ç›¸åï¼Œå®ƒåªè®¡ç®—å‡ºç»å¯¹å¿…è¦çš„è®¡ç®—ã€‚

> > > > | ;Â (1) |
> > > > | --- |
> > > > | (å­çœ¼ç›Â (åˆ›å»ºå­èŠ‚ç‚¹Â NPÂ NPÂ "å¡å°”"Â 1926Â "ç»¿è‰²")) |
> > > > | == |
> > > > | "ç»¿è‰²" |
> > > > | Â  |
> > > > | ;Â (2) |
> > > > | (è“è‰²çœ¼ç›çš„å­©å­ï¼Ÿ |
> > > > | Â Â (å­çˆ¶äº² |
> > > > | Â Â Â Â (åˆ›å»ºå­èŠ‚ç‚¹Â NPÂ NPÂ "å¡å°”"Â 1926Â "ç»¿è‰²")) |
> > > > | == |
> > > > | (è“è‰²çœ¼ç›çš„å­©å­ï¼ŸÂ NP) |
> > > > | == |
> > > > | #false |
> > > > | Â  |
> > > > | ;Â (3) |
> > > > | (è“è‰²çœ¼ç›çš„å­©å­ï¼Ÿ |
> > > > | Â Â (å­æ¯äº² |
> > > > | Â Â Â Â (åˆ›å»ºå­èŠ‚ç‚¹Â NPÂ NPÂ "å¡å°”"Â 1926Â "ç»¿è‰²")) |
> > > > | == |
> > > > | (è“è‰²çœ¼ç›çš„å­©å­ï¼ŸÂ NP) |
> > > > | == |
> > > > | #false |
> > > > 
> å›¾ 114ï¼šä½¿ç”¨æ ‘è¿›è¡Œè®¡ç®—

ç»ƒä¹  310ã€‚å¼€å‘ count-persons å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªå®¶è°±å¹¶è®¡ç®—æ ‘ä¸­çš„å­ç»“æž„æ•°é‡ã€‚

ç»ƒä¹  311ã€‚å¼€å‘å‡½æ•° average-ageã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªå®¶è°±å’Œå½“å‰å¹´ä»½ã€‚å®ƒäº§ç”Ÿå®¶è°±ä¸­æ‰€æœ‰å­ç»“æž„çš„å¹³å‡å¹´é¾„ã€‚

ç»ƒä¹  312ã€‚å¼€å‘å‡½æ•° eye-colorsï¼Œå®ƒæ¶ˆè€—ä¸€ä¸ªå®¶è°±å¹¶ç”Ÿæˆæ ‘ä¸­æ‰€æœ‰çœ¼ç›é¢œè‰²çš„åˆ—è¡¨ã€‚çœ¼ç›é¢œè‰²å¯èƒ½åœ¨ç»“æžœåˆ—è¡¨ä¸­å‡ºçŽ°å¤šæ¬¡ã€‚æç¤ºï¼šä½¿ç”¨[append](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29)æ¥è¿žæŽ¥é€’å½’è°ƒç”¨äº§ç”Ÿçš„åˆ—è¡¨ã€‚

ç»ƒä¹  313ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦å‡½æ•° blue-eyed-ancestor?ï¼Œå®ƒç±»ä¼¼äºŽ blue-eyed-child?ï¼Œä½†åªæœ‰å½“é€‚å½“çš„ç¥–å…ˆï¼ˆè€Œéžç»™å®šçš„å­©å­æœ¬èº«ï¼‰æœ‰è“è‰²çœ¼ç›æ—¶ï¼Œæ‰è¿”å›ž#trueã€‚

å°½ç®¡ç›®æ ‡æ˜Žæ˜¾ä¸åŒï¼Œä½†ç­¾åæ˜¯ç›¸åŒçš„ï¼š

> | ;Â FT -> å¸ƒå°” |
> | --- |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (è“è‰²çœ¼ç›çš„ç¥–å…ˆï¼ŸÂ an-ftree)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |

åœæ­¢ï¼ä¸ºè¯¥å‡½æ•°åˆ¶å®šä¸€ä¸ªç›®çš„å£°æ˜Žã€‚ä¸ºäº†æ¬£èµè¿™ç§å·®å¼‚ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Evaï¼š

> ([æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (è“è‰²çœ¼ç›çš„å­©å­ï¼ŸÂ Eva)Â #true)

Eva æ˜¯è“è‰²çš„çœ¼ç›ï¼Œä½†æ²¡æœ‰è“è‰²çœ¼ç›çš„ç¥–å…ˆã€‚å› æ­¤ï¼Œ

> ([æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (è“è‰²çœ¼ç›çš„ç¥–å…ˆï¼ŸÂ Eva)Â #false)

ç›¸åï¼ŒGustav æ˜¯ Eva çš„å„¿å­ï¼Œç¡®å®žæœ‰ä¸€ä¸ªè“è‰²çœ¼ç›çš„ç¥–å…ˆï¼š

> ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-ancestor?Â Gustav)Â #true)

çŽ°åœ¨å‡è®¾ä¸€ä¸ªæœ‹å‹æå‡ºäº†è¿™ä¸ªè§£å†³æ–¹æ¡ˆï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (blue-eyed-ancestor?Â an-ftree) |
> | --- |
> | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â [(no-parent?Â an-ftree)Â #false] |
> | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> | Â Â Â Â Â ([or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29) |
> | Â Â Â Â Â Â Â (blue-eyed-ancestor? |
> | ;Â â€“  ([child-fatherÂ an-ftree)) |
> | Â Â Â Â Â Â Â (blue-eyed-ancestor? |
> | ;Â â€“  ([child-motherÂ an-ftree)))])) |

è§£é‡Šä¸ºä»€ä¹ˆè¿™ä¸ªå‡½æ•°æœªèƒ½é€šè¿‡å…¶æµ‹è¯•ä¹‹ä¸€ã€‚æ— è®ºä½ é€‰æ‹©å“ªä¸ª Aï¼Œ(blue-eyed-ancestor? A)çš„ç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿä½ èƒ½ä¿®å¤ä½ æœ‹å‹çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ

å˜é‡å’Œç»“æž„å‘½åæ³¨æ„äº‹é¡¹ åˆå§‹å¯¹å®¶åº­å…³ç³»çš„è®¨è®ºå»ºè®®å°†ç»“æž„ç±»åž‹å®šä¹‰å‘½åä¸º childã€‚è¿™äº”æ¡ä¿¡æ¯ä»£è¡¨ç‰¹å®šçˆ¶æ¯çš„å­©å­ã€‚ç„¶è€Œï¼Œå…¶ä½™çš„å‘å±•æ˜¯å…³äºŽç¥–å…ˆæ ‘ã€‚å¦‚æžœä½ åªæ˜¯æµè§ˆæœ¬ç« ï¼Œä¸“æ³¨äºŽå‡½æ•°å®šä¹‰ï¼Œæ¯”å¦‚å›¾ 113 ä¸­çš„é‚£ä¸ªï¼Œchild-fatherã€child-mother å’Œ child-eyes è¿™äº›åç§°å¯èƒ½ä¼šè®©ä½ æœ‰äº›è¯¯å¯¼ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒä»¬ä¼¼ä¹Žä¸Žå‡½æ•°çš„é€’å½’æ€§è´¨ç›¸å†²çªã€‚ç»éªŒä¸°å¯Œçš„å¼€å‘è€…å¯èƒ½ä¼šä½¿ç”¨ DrRacket çš„é‡å‘½ååŠŸèƒ½æ£€æŸ¥è¯­æ³•ã€‚å³é”®å•å‡»ç»“æž„çš„åç§°ã€‚é€‰æ‹©é‡å‘½åï¼Œå°† child æ›¿æ¢ä¸º personã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå˜é‡å‘½åå¯¹äºŽå¸®åŠ©ä»£ç çš„è¯»è€…ç†è§£å…¶èƒŒåŽçš„æ€è€ƒè‡³å…³é‡è¦ã€‚

#### 19.2 æ£®æž—ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ä»Žå®¶è°±æ ‘åˆ°å®¶è°±æ£®æž—åªæœ‰ä¸€å°æ­¥ï¼š

> | ;Â An FF (short for family forest) is one of: |
> | --- |
> | ;Â â€“  '() |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  FT  FF) |
> | ;Â interpretation a family forest represents several |
> | ;Â families (say, a town) and their ancestor trees |

è¿™é‡Œæ˜¯ä¸€äº›æ¥è‡ªå›¾ 111 çš„æ ‘æ‘˜å½•ï¼ŒæŽ’åˆ—æˆæ£®æž—ï¼š

> |   | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ff1Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â CarlÂ Bettina)) |
> | --- | --- |
> |   | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ff2Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â FredÂ Eva)) |
> |   | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ff3Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â FredÂ EvaÂ Carl)) |

å‰ä¸¤ä¸ªæ£®æž—åŒ…å«ä¸¤ä¸ªæ— å…³çš„å®¶åº­ï¼Œç¬¬ä¸‰ä¸ªæ£®æž—è¯´æ˜Žäº†ä¸ŽçœŸå®žæ£®æž—ä¸åŒï¼Œå®¶æ—æ£®æž—ä¸­çš„æ ‘æœ¨å¯ä»¥é‡å ã€‚çŽ°åœ¨è€ƒè™‘è¿™ä¸ªå…³äºŽå®¶æ—æ ‘çš„ä»£è¡¨æ€§é—®é¢˜ï¼š

> æ ·ä¾‹é—®é¢˜ï¼šè®¾è®¡å‡½æ•° blue-eyed-child-in-forest?ï¼Œè¯¥å‡½æ•°ç”¨äºŽç¡®å®šä¸€ä¸ªå®¶æ—æ£®æž—ä¸­æ˜¯å¦åŒ…å«çœ¼ç›é¢œè‰²ä¸ºâ€œè“è‰²â€çš„å­©å­ã€‚
> 
> > > |   ; FF -> Boolean |
> > > | --- |
> > > |   ; æ£®æž—ä¸­æ˜¯å¦åŒ…å«ä»»ä½•çœ¼ç›ä¸ºâ€œè“è‰²â€çš„å­©å­ |
> > > |   | |
> > > |   | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-child-in-forest?Â ff1)Â #false) |
> > > |   | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-child-in-forest?Â ff2)Â #true) |
> > > |   | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (blue-eyed-child-in-forest?Â ff3)Â #true) |
> > > | Â  |
> > > |   | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (blue-eyed-child-in-forest?Â a-forest) |
> > > |   | ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   | ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â a-forest)Â #false] |
> > > |   | [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> > > | Â Â Â Â Â ([or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)Â (blue-eyed-child?Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â a-forest)) |
> > > | Â Â Â Â Â Â Â Â Â (blue-eyed-child-in-forest?Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â a-forest)))])) |
> > > 
> å›¾ 115ï¼šåœ¨å®¶æ—æ£®æž—ä¸­æ‰¾åˆ°ä¸€ä¸ªè“çœ¼ç›çš„å­©å­

ç›´æŽ¥çš„è§£å†³æ–¹æ¡ˆåœ¨å›¾ 115 ä¸­æ˜¾ç¤ºã€‚è‡ªå·±ç ”ç©¶ç­¾åã€ç›®çš„é™ˆè¿°å’Œç¤ºä¾‹ã€‚æˆ‘ä»¬å…³æ³¨ç¨‹åºç»„ç»‡ã€‚å…³äºŽæ¨¡æ¿ï¼Œè®¾è®¡å¯èƒ½ä½¿ç”¨åˆ—è¡¨æ¨¡æ¿ï¼Œå› ä¸ºè¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªåˆ—è¡¨ã€‚å¦‚æžœåˆ—è¡¨ä¸­çš„æ¯ä¸ªé¡¹éƒ½æ˜¯ä¸€ä¸ªå…·æœ‰çœ¼ç›å­—æ®µçš„ç»“æž„çš„å…¶ä½™éƒ¨åˆ†ï¼Œåˆ™å‡½æ•°å°†ä½¿ç”¨çœ¼ç›å­—æ®µçš„é€‰æ‹©å‡½æ•°å’Œå­—ç¬¦ä¸²æ¯”è¾ƒéåŽ†è¿™äº›ç»“æž„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé¡¹æ˜¯ä¸€ä¸ªå®¶æ—æ ‘ï¼Œä½†å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•å¤„ç†å®¶æ—æ ‘ã€‚

è®©æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹æˆ‘ä»¬æ˜¯å¦‚ä½•è§£é‡Šå›¾ 115 çš„ã€‚èµ·ç‚¹æ˜¯ä¸€å¯¹æ•°æ®å®šä¹‰ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå¼•ç”¨äº†ç¬¬ä¸€ä¸ªï¼Œå¹¶ä¸”ä¸¤è€…éƒ½å¼•ç”¨äº†è‡ªèº«ã€‚ç»“æžœæ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå¼•ç”¨äº†ç¬¬ä¸€ä¸ªï¼Œå¹¶ä¸”ä¸¤è€…éƒ½å¼•ç”¨äº†è‡ªèº«ã€‚æ¢å¥è¯è¯´ï¼Œå‡½æ•°å®šä¹‰ç›¸äº’å¼•ç”¨çš„æ–¹å¼ä¸Žæ•°æ®å®šä¹‰ç›¸äº’å¼•ç”¨çš„æ–¹å¼ç›¸åŒã€‚æ—©æœŸç« èŠ‚ç•¥è¿‡äº†è¿™ç§å…³ç³»ï¼Œä½†çŽ°åœ¨æƒ…å†µè¶³å¤Ÿå¤æ‚ï¼Œå€¼å¾—æ³¨æ„ã€‚

ç»ƒä¹  314ã€‚ä½¿ç”¨ List-of æŠ½è±¡é‡æ–°è¡¨è¿° FF çš„æ•°æ®å®šä¹‰ã€‚çŽ°åœ¨ä¹Ÿä¸º blue-eyed-child-in-forest?å‡½æ•°åšåŒæ ·çš„æ“ä½œã€‚æœ€åŽï¼Œä½¿ç”¨å‰ä¸€ç« ä¸­çš„ä¸€ç§åˆ—è¡¨æŠ½è±¡å®šä¹‰ blue-eyed-child-in-forest?ã€‚

ç»ƒä¹  315ã€‚è®¾è®¡ average-age å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªå®¶æ—æ£®æž—å’Œä¸€å¹´(N)ã€‚ä»Žè¿™ä¸ªæ•°æ®ä¸­ï¼Œå®ƒäº§ç”Ÿæ£®æž—ä¸­æ‰€æœ‰å­©å­å®žä¾‹çš„å¹³å‡å¹´é¾„ã€‚æ³¨æ„ï¼šå¦‚æžœæ£®æž—ä¸­çš„æ ‘é‡å ï¼Œç»“æžœä¸æ˜¯çœŸæ­£çš„å¹³å‡å€¼ï¼Œå› ä¸ºæœ‰äº›äººè´¡çŒ®å¾—æ›´å¤šã€‚å¯¹äºŽè¿™ä¸ªç»ƒä¹ ï¼Œå‡è®¾æ ‘ä¸é‡å ã€‚

#### 19.3S è¡¨è¾¾å¼ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

è™½ç„¶é—´å¥æ›² 2ï¼šå¼•ç”¨ï¼Œä¸å¼•ç”¨éžæ­£å¼åœ°ä»‹ç»äº† S è¡¨è¾¾å¼ï¼Œä½†å¯ä»¥ç”¨ä¸‰ç§æ•°æ®å®šä¹‰çš„ç»„åˆæ¥æè¿°å®ƒä»¬ï¼š

> |
> 
> &#124; ;Â ä¸€ä¸ª S è¡¨è¾¾å¼æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š&#124;
> 
> &#124; ;Â â€“  åŽŸå­ &#124;
> 
> &#124; ;Â â€“  SL &#124;
> 
> &#124; Â  &#124;
> 
> &#124; ;Â ä¸€ä¸ª SL æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š&#124;
> 
> &#124; ;Â â€“  '() &#124;
> 
> &#124; ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  S-expr  SL) &#124;
> 
> |  |
> | --- |
> 
> &#124; ;Â ä¸€ä¸ªåŽŸå­æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š &#124;
> 
> &#124; ;Â â€“  æ•°å­— &#124;
> 
> &#124; ;Â â€“  å­—ç¬¦ä¸² &#124;
> 
> &#124; ;Â â€“  ç¬¦å· &#124;
> 
> |

å›žæƒ³ä¸€ä¸‹ï¼Œç¬¦å· çœ‹èµ·æ¥åƒå­—ç¬¦ä¸²ï¼Œä»¥ä¸€ä¸ªå•å¼•å·å¼€å¤´ï¼Œä»¥æ²¡æœ‰å¼•å·ç»“å°¾ã€‚

S è¡¨è¾¾å¼çš„æƒ³æ³•å½’åŠŸäºŽçº¦ç¿°Â·éº¦å¡é”¡å’Œä»–çš„ Lisp ç¨‹åºå‘˜ï¼Œä»–ä»¬åœ¨ 1958 å¹´åˆ›é€ äº† S è¡¨è¾¾å¼ï¼Œä»¥ä¾¿ä»–ä»¬å¯ä»¥ç”¨å…¶ä»– Lisp ç¨‹åºå¤„ç† Lisp ç¨‹åºã€‚è¿™ç§çœ‹ä¼¼å¾ªçŽ¯çš„æŽ¨ç†å¯èƒ½å¬èµ·æ¥å¾ˆç¥žç§˜ï¼Œä½†æ­£å¦‚åœ¨ é—´å¥æ›² 2ï¼šå¼•ç”¨ï¼Œéžå¼•ç”¨ ä¸­æåˆ°çš„ï¼ŒS è¡¨è¾¾å¼æ˜¯ä¸€ç§å¤šæ‰å¤šè‰ºçš„æ•°æ®å½¢å¼ï¼Œå®ƒç»å¸¸è¢«é‡æ–°å‘çŽ°ï¼Œæœ€è¿‘åœ¨ä¸‡ç»´ç½‘åº”ç”¨ä¸­å¾—åˆ°äº†åº”ç”¨ã€‚å› æ­¤ï¼Œä½¿ç”¨ S è¡¨è¾¾å¼ä¸ºè®¨è®ºå¦‚ä½•ä¸ºé«˜åº¦äº¤ç»‡çš„æ•°æ®å®šä¹‰è®¾è®¡å‡½æ•°åšå¥½äº†å‡†å¤‡ã€‚

ç»ƒä¹  316. å®šä¹‰ atom? å‡½æ•°ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ¬ä¹¦ä¸­è¿˜æ²¡æœ‰æ•°æ®éœ€è¦åƒ S è¡¨è¾¾å¼é‚£æ ·å¤æ‚çš„æ•°æ®å®šä¹‰ã€‚ç„¶è€Œï¼Œåªè¦æœ‰ä¸€ç‚¹æç¤ºï¼Œå¦‚æžœä½ éµå¾ªè®¾è®¡é…æ–¹ï¼Œä½ å°±å¯ä»¥è®¾è®¡å¤„ç† S è¡¨è¾¾å¼çš„å‡½æ•°ã€‚ä¸ºäº†è¯´æ˜Žè¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥åˆ†æžï¼š

> æ ·ä¾‹é—®é¢˜ è®¾è®¡ä¸€ä¸ªåä¸º count çš„å‡½æ•°ï¼Œå®ƒç¡®å®šæŸä¸ªç¬¦å·åœ¨æŸä¸ª S è¡¨è¾¾å¼ï¼ˆS-expressionï¼‰ä¸­å‡ºçŽ°çš„æ¬¡æ•°ã€‚

è™½ç„¶ç¬¬ä¸€æ­¥éœ€è¦æ•°æ®å®šä¹‰å¹¶ä¸”çœ‹èµ·æ¥å·²ç»å®Œæˆï¼Œä½†è¯·è®°ä½ï¼Œå®ƒè¿˜è¦æ±‚åˆ›å»ºæ•°æ®ç¤ºä¾‹ï¼Œå°¤å…¶æ˜¯åœ¨å®šä¹‰å¤æ‚æ—¶ã€‚æ•°æ®å®šä¹‰åº”è¯¥æ˜¯ä¸€ä»½å¦‚ä½•åˆ›å»ºæ•°æ®çš„è¯´æ˜Žï¼Œå…¶â€œæµ‹è¯•â€æ˜¯å®ƒæ˜¯å¦å¯ç”¨ã€‚S-expr çš„æ•°æ®å®šä¹‰æå‡ºçš„ä¸€ä¸ªè§‚ç‚¹æ˜¯æ¯ä¸ª åŽŸå­ éƒ½æ˜¯ S-expr çš„ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸”ä½ çŸ¥é“ åŽŸå­ æ˜¯å¾ˆå®¹æ˜“åˆ¶é€ çš„ï¼š

> | 'hello |
> | --- |
> | 20.12 |
> | "world" |

åŒæ ·åœ°ï¼Œæ¯ä¸ª SL ä¹Ÿæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª S-exprï¼š

> | '() |
> | --- |
> | ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 'helloÂ ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 20.12Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â "world"Â '()))) |
> | ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 'helloÂ ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 20.12Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â "world"Â '()))) |
> | Â Â Â Â Â Â '()) |

å‰ä¸¤ä¸ªå¾ˆæ˜Žæ˜¾ï¼›ç¬¬ä¸‰ä¸ªå€¼å¾—ä»”ç»†çœ‹çœ‹ã€‚å®ƒé‡å¤äº†ç¬¬äºŒä¸ª S-exprï¼Œä½†åµŒå¥—åœ¨([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)  '())ä¸­ã€‚è¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªåŒ…å«å•ä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼Œå³ç¬¬äºŒä¸ªç¤ºä¾‹ã€‚ä½ å¯ä»¥ä½¿ç”¨[list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)æ¥ç®€åŒ–ç¤ºä¾‹ï¼š

> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 'helloÂ ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 20.12Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â "world"Â '())))) |
> | --- |
> | ;Â or |
> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 'helloÂ 20.12Â "world")) |

äº‹å®žä¸Šï¼Œä½¿ç”¨ Intermezzo 2: Quote, Unquote çš„å¼•ç”¨æœºåˆ¶ï¼Œå†™ä¸‹ S-expressions ç”šè‡³æ›´å®¹æ˜“ã€‚ä»¥ä¸‹æ˜¯æœ€åŽä¸‰ä¸ªï¼š

> | > '() |
> | --- |
> | '() |
> | > '(helloÂ 20.12Â "world") |
> | (list 'hello #i20.12 "world") |
> | > '((helloÂ 20.12Â "world")) |
> | (list (list 'hello #i20.12 "world")) |

ä¸ºäº†å¸®åŠ©æ‚¨ï¼Œæˆ‘ä»¬åœ¨ DrRacket çš„äº¤äº’åŒºåŸŸè¯„ä¼°è¿™äº›ç¤ºä¾‹ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥çœ‹åˆ°ç»“æžœï¼Œè¿™ä¸ªç»“æžœæ¯”[quote](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._quote%29%29)è¡¨ç¤ºæ³•æ›´æŽ¥è¿‘ã€‚ä½¿ç”¨[quote](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._quote%29%29)ï¼Œæž„å»ºå¤æ‚ç¤ºä¾‹éžå¸¸å®¹æ˜“ï¼š

> |
> 
> &#124; > '(defineÂ (fÂ x) &#124;
> 
> &#124; Â Â Â Â Â (+Â xÂ 55)) &#124;
> 
> |
> 
> | (list 'define (list 'f 'x) (list '+ 'x 55)) |
> | --- |

è¿™ä¸ªä¾‹å­å¯èƒ½è®©æ‚¨è§‰å¾—å¥‡æ€ªï¼Œå› ä¸ºå®ƒçœ‹èµ·æ¥åƒ BSL ä¸­çš„å®šä¹‰ï¼Œä½†æ­£å¦‚ä¸Ž DrRacket çš„äº¤äº’æ‰€æ˜¾ç¤ºçš„ï¼Œå®ƒåªæ˜¯ä¸€å—æ•°æ®ã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªä¾‹å­ï¼š

> |
> 
> &#124; > '((6Â f) &#124;
> 
> &#124; Â Â Â Â (5Â e) &#124;
> 
> &#124; Â Â Â Â (4Â d)) &#124;
> 
> |
> 
> | (list (list 6 'f) (list 5 'e) (list 4 'd)) |
> | --- |

è¿™å—æ•°æ®çœ‹èµ·æ¥åƒä¸€å¼ è¡¨ï¼Œå°†å­—æ¯ä¸Žæ•°å­—å…³è”èµ·æ¥ã€‚æœ€åŽä¸€ä¸ªä¾‹å­æ˜¯ä¸€å¹…è‰ºæœ¯å“ï¼š

> | > '(wingÂ (wingÂ bodyÂ wing)Â wing) |
> | --- |
> | (list 'wing (list 'wing 'body 'wing) 'wing) |

çŽ°åœ¨æ˜¯æ—¶å€™å†™ä¸‹ count çš„ç›¸å½“æ˜Žæ˜¾çš„æ ‡é¢˜äº†ï¼š

> | ;Â S-expr  Symbol -> N |
> | --- |
> | ;Â counts all occurrences of sy in sexp |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (countÂ sexpÂ sy) |
> | Â Â 0) |

ç”±äºŽæ ‡é¢˜å¾ˆæ˜Žæ˜¾ï¼Œæˆ‘ä»¬ç»§ç»­åˆ°åŠŸèƒ½ç¤ºä¾‹ã€‚å¦‚æžœç»™å®šçš„ S-expr æ˜¯'worldï¼Œè¦è®¡æ•°çš„ç¬¦å·ä¹Ÿæ˜¯'worldï¼Œç­”æ¡ˆæ˜¾ç„¶æ˜¯ 1ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æ›´å¤šç¤ºä¾‹ï¼Œç«‹å³ä½œä¸ºæµ‹è¯•æ¥åˆ¶å®šï¼š

> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (countÂ 'worldÂ 'hello)Â 0) |
> | --- |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (countÂ '(worldÂ hello)Â 'hello)Â 1) |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (countÂ '(((world)Â hello)Â hello)Â 'hello)Â 2) |

æ‚¨å¯ä»¥çœ‹åˆ°å¼•ç”¨è¡¨ç¤ºæ³•å¯¹äºŽæµ‹è¯•ç”¨ä¾‹æ˜¯å¤šä¹ˆæ–¹ä¾¿ã€‚ç„¶è€Œï¼Œå½“æ¶‰åŠåˆ°æ¨¡æ¿æ—¶ï¼Œä»Ž[quote](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._quote%29%29)çš„è§’åº¦æ€è€ƒæ˜¯ç¾éš¾æ€§çš„ã€‚åœ¨æˆ‘ä»¬ç»§ç»­åˆ°æ¨¡æ¿æ­¥éª¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ‚¨å‡†å¤‡ä¸‹ä¸€ä¸ªè®¾è®¡é£Ÿè°±çš„æ³›åŒ–ï¼š

> æç¤ºï¼šå¯¹äºŽäº¤ç»‡çš„æ•°æ®å®šä¹‰ï¼Œä¸ºæ¯ä¸ªæ•°æ®å®šä¹‰åˆ›å»ºä¸€ä¸ªæ¨¡æ¿ã€‚å¹¶è¡Œåˆ›å»ºå®ƒä»¬ã€‚ç¡®ä¿å®ƒä»¬ä»¥ä¸Žæ•°æ®å®šä¹‰ç›¸åŒçš„æ–¹å¼ç›¸äº’å¼•ç”¨ã€‚ç»“æŸ

è¿™ä¸ªæç¤ºå¬èµ·æ¥æ¯”å®žé™…è¦å¤æ‚ã€‚å¯¹äºŽæˆ‘ä»¬çš„é—®é¢˜ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¸‰ä¸ªæ¨¡æ¿ï¼š

1.  ä¸€ä¸ªç”¨äºŽè®¡æ•° S-expr ä¸­ç¬¦å·å‡ºçŽ°çš„å‡½æ•°ï¼›

1.  ä¸€ä¸ªç”¨äºŽè®¡æ•° SL ä¸­ç¬¦å·å‡ºçŽ°çš„å‡½æ•°ï¼›å¹¶ä¸”

1.  ä¸€ä¸ªç”¨äºŽè®¡æ•° Atom ä¸­ç¬¦å·å‡ºçŽ°çš„å‡½æ•°ã€‚

è¿™é‡Œæä¾›äº†ä¸‰ä¸ªéƒ¨åˆ†æ¨¡æ¿ï¼Œæ¡ä»¶ä¸Žä¸‰ä¸ªæ•°æ®å®šä¹‰å»ºè®®ä¸€è‡´ï¼š

> |
> 
> > [[define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (count sexp sy)] &#124;
> > 
> > &#124; Â [[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) &#124;
> > 
> > &#124; [(atom?Â sexp) ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) &#124;
> > 
> > [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) &#124;
> > 
> > &#124; Â  &#124;
> > 
> > [[define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (count-sl sl sy)] &#124;
> > 
> > [[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) &#124;
> > 
> > &#124; [[empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) sl] ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) &#124;
> > 
> > &#124; [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) &#124;
> > 
> |  |
> | --- |
> 
> [[define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (count-atom at sy)] &#124;
> 
> [[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) &#124;
> 
> [[number?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._number~3f%29%29) at] ...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) &#124;
> 
> `|   Â Â Â ([([string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)Â at) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |)
> 
> `|  Â Â Â ([([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â at) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)]) |)
> 
> |

æ¨¡æ¿`count`åŒ…å«ä¸€ä¸ªåŒæ¡ä»¶åˆ†æ”¯ï¼Œå› ä¸º S-expr çš„æ•°æ®å®šä¹‰æœ‰ä¸¤ä¸ªå­å¥ã€‚å®ƒä½¿ç”¨`atom?`å‡½æ•°æ¥åŒºåˆ† Atom çš„æƒ…å†µå’Œ SL çš„æƒ…å†µã€‚åä¸º`count-sl`çš„æ¨¡æ¿æ¶ˆè€—ä¸€ä¸ª SL å…ƒç´ å’Œä¸€ä¸ªç¬¦å·ï¼Œå› ä¸º SL åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥`count-sl`ä¹ŸåŒ…å«ä¸€ä¸ªåŒæ¡ä»¶`cond`ã€‚æœ€åŽï¼Œ`count-atom`åº”è¯¥é€‚ç”¨äºŽ Atom å’Œ Symbolã€‚è¿™æ„å‘³ç€å®ƒçš„æ¨¡æ¿æ£€æŸ¥äº† Atom æ•°æ®å®šä¹‰ä¸­æåˆ°çš„ä¸‰ç§ä¸åŒçš„æ•°æ®å½¢å¼ã€‚ä¸‹ä¸€æ­¥æ˜¯å°†ç›¸å…³å­å¥ä¸­çš„å¤åˆæ•°æ®æ‹†åˆ†å‡ºæ¥ï¼š

> |
> 
> > `| ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (countÂ sexpÂ sy) |)
> > 
> > `|   ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |)
> > 
> > `|  Â Â Â [(atom?Â sexp) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |)
> > 
> > `|  Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)])) |)
> > 
> > `|   | 
> > 
> > `| ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (count-slÂ slÂ sy) |)
> > 
> > `|   | ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |)
> > 
> > [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) sl) | 
> > 
> > [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) | 
> > 
> > [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) sl) [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) | 
> > 
> > [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) sl))])) | 
> > 
> |  |  |
> | --- | --- |
> 
> [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (count-atom at sy) | 
> 
> [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) | 
> 
> [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(number?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._number~3f%29%29) at) | 
> 
> [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29) at) |
> 
> [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [(symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29) at) [(...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)])) | 
> 
> | 

ä¸ºä»€ä¹ˆæˆ‘ä»¬åªå‘ count-sl æ·»åŠ ä¸¤ä¸ªé€‰æ‹©è¡¨è¾¾å¼ï¼Ÿæ¨¡æ¿åˆ›å»ºè¿‡ç¨‹çš„æœ€åŽä¸€æ­¥éœ€è¦æ£€æŸ¥æ•°æ®å®šä¹‰ä¸­çš„è‡ªå¼•ç”¨ã€‚åœ¨æˆ‘ä»¬çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™æ„å‘³ç€è‡ªå¼•ç”¨ä»¥åŠä¸€ä¸ªæ•°æ®å®šä¹‰åˆ°å¦ä¸€ä¸ªæ•°æ®å®šä¹‰çš„å¼•ç”¨ï¼Œä»¥åŠï¼ˆå¯èƒ½ï¼‰åå‘å¼•ç”¨ã€‚è®©æˆ‘ä»¬æ£€æŸ¥ä¸‰ä¸ªæ¨¡æ¿ä¸­çš„ [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) è¡Œï¼š

1.  count ä¸­çš„ atom? è¡Œå¯¹åº”äºŽ S-expr å®šä¹‰çš„ç¬¬ä¸€è¡Œã€‚ä¸ºäº†è¡¨ç¤ºä»Žè¿™é‡Œåˆ° Atom çš„äº¤å‰å¼•ç”¨ï¼Œæˆ‘ä»¬æ·»åŠ äº† (count-atom  sexp  sy)ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å°† sexp è§£é‡Šä¸º Atom å¹¶è®©é€‚å½“çš„å‡½æ•°å¤„ç†å®ƒã€‚

1.  &#124;  Following the same line of thought, the second [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) line in count calls for the addition of (count-sl  sexp  sy).

1.  count-sl ä¸­çš„ [ç©ºï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) è¡Œå¯¹åº”äºŽæ•°æ®å®šä¹‰ä¸­ä¸å¼•ç”¨å…¶ä»–æ•°æ®å®šä¹‰çš„ä¸€è¡Œã€‚

1.  ç›¸æ¯”ä¹‹ä¸‹ï¼Œ[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) è¡ŒåŒ…å«ä¸¤ä¸ªé€‰æ‹©è¡¨è¾¾å¼ï¼Œæ¯ä¸ªéƒ½æå–ä¸åŒç±»åž‹çš„æ•°æ®ã€‚å…·ä½“æ¥è¯´ï¼Œ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)  sl) æ˜¯ S-expr çš„ä¸€ä¸ªå…ƒç´ ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å°†å…¶åŒ…è£¹åœ¨ (count  [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) ä¸­ã€‚æ¯•ç«Ÿï¼Œcount è´Ÿè´£è®¡ç®—ä»»æ„ S-expr å†…éƒ¨çš„å…ƒç´ ã€‚æŽ¥ä¸‹æ¥ï¼Œ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  sl) å¯¹åº”äºŽä¸€ä¸ªè‡ªå¼•ç”¨ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦é€šè¿‡é€’å½’å‡½æ•°è°ƒç”¨æ¥å¤„ç†è¿™äº›ã€‚

1.  æœ€åŽï¼ŒAtom ä¸­çš„æ‰€æœ‰ä¸‰ä¸ªæƒ…å†µéƒ½æŒ‡çš„æ˜¯æ•°æ®çš„åŸºæœ¬å½¢å¼ã€‚å› æ­¤ï¼Œcount-atom å‡½æ•°ä¸éœ€è¦æ›´æ”¹ã€‚

> > > |
> > > 
> > > &#124;    ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (countÂ sexpÂ sy) &#124;
> > > 
> > > &#124;     ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) &#124;
> > > 
> > > &#124;   Â Â [(atom?Â sexp) &#124;
> > > 
> > > &#124;    Â Â Â Â (count-atomÂ sexpÂ sy)] &#124;
> > > 
> > > | &#124; Â Â Â Â [([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â at)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)])) &#124;
> > > 
> > > |
> > > 
> | å›¾Â 116ï¼šS-è¡¨è¾¾å¼çš„æ¨¡æ¿
> 
> > > | ;Â S-expr  Symbol -> N |
> > > | --- |
> > > | ;Â counts all occurrences of sy in sexp |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (countÂ sexpÂ sy) |
> > > | Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â [(atom?Â sexp)Â (count-atomÂ sexpÂ sy)] |
> > > | Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â (count-slÂ sexpÂ sy)])) |
> > > | Â  |
> > > | ;Â SL  Symbol -> N |
> > > | ;Â counts all occurrences of sy in sl |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (count-slÂ slÂ sy) |
> > > | ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â [([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â sl)Â 0] |
> > > | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> > > | Â Â Â Â Â ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â (countÂ ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â sl)Â sy)Â (count-slÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â sl)Â sy))])) |
> > > | Â  |
> > > | ;Â Atom  Symbol -> N |
> > > | ;Â counts all occurrences of sy in at |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (count-atomÂ atÂ sy) |
> > > | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â [([number?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._number~3f%29%29)Â at)Â 0] |
> > > | Â Â Â Â [([string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)Â at)Â 0] |
> > > | Â Â Â Â [([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â at)Â ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)Â ([symbol=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29)Â atÂ sy)Â 1Â 0)])) |
> > > 
> å›¾ 117ï¼šS-expr çš„ç¨‹åº

å›¾ 116 å±•ç¤ºäº†ä¸‰ä¸ªå®Œæ•´çš„æ¨¡æ¿ã€‚å¦‚å›¾ å›¾ 117 æ‰€ç¤ºï¼Œå¡«å……è¿™äº›æ¨¡æ¿ä¸­çš„ç©ºç™½æ˜¯ç›´æŽ¥çš„ã€‚ä½ åº”è¯¥èƒ½å¤Ÿè§£é‡Šä¸‰ä¸ªå®šä¹‰ä¸­çš„ä»»ä½•ä¸€è¡Œã€‚ä¾‹å¦‚ï¼š

> [(atom?Â sexp)Â (count-atomÂ sexpÂ sy)]

åˆ¤æ–­ sexp æ˜¯å¦æ˜¯ åŽŸå­ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™é€šè¿‡ count-atom å°† S-expr è§£é‡Šä¸º åŽŸå­ã€‚

> | [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> | --- |
> | Â ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â (countÂ ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â sl)Â sy)Â (count-slÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â sl)Â sy))] |

æ„å‘³ç€ç»™å®šçš„åˆ—è¡¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ª S-expr å’Œä¸€ä¸ª SLã€‚é€šè¿‡ä½¿ç”¨ count å’Œ count-slï¼Œç›¸åº”çš„å‡½æ•°ç”¨äºŽè®¡ç®— sy åœ¨æ¯ä¸€éƒ¨åˆ†ä¸­å‡ºçŽ°çš„æ¬¡æ•°ï¼Œç„¶åŽå°†è¿™ä¸¤ä¸ªæ•°å­—ç›¸åŠ â€”â€”<wbr>å¾—åˆ° sexp ä¸­ sys çš„æ€»æ•°ã€‚

> [([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â at)Â ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)Â ([symbol=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29)Â atÂ sy)Â 1Â 0)]

å‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æžœä¸€ä¸ª åŽŸå­ æ˜¯ä¸€ä¸ª ç¬¦å·ï¼Œsy å¦‚æžœç­‰äºŽ sexp åˆ™å‡ºçŽ°ä¸€æ¬¡ï¼Œå¦åˆ™æ ¹æœ¬ä¸å‡ºçŽ°ã€‚ç”±äºŽè¿™ä¸¤ä»½æ•°æ®æ˜¯åŽŸå­çš„ï¼Œæ²¡æœ‰å…¶ä»–å¯èƒ½æ€§ã€‚

ç»ƒä¹  317. ç”±ä¸‰ä¸ªè¿žæŽ¥å‡½æ•°ç»„æˆçš„ç¨‹åºåº”è¯¥ä½¿ç”¨ [å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) è¡¨è¾¾å¼æ¥è¡¨è¾¾è¿™ç§å…³ç³»ã€‚

ä½¿ç”¨ [å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) å°† å›¾ 117 ä¸­çš„ç¨‹åºå¤åˆ¶å¹¶é‡æ–°ç»„ç»‡æˆä¸€ä¸ªå•ä¸€å‡½æ•°ã€‚ä½¿ç”¨ count çš„æµ‹è¯•å¥—ä»¶éªŒè¯ä¿®æ”¹åŽçš„ä»£ç ã€‚

å±€éƒ¨å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° sy ä»Žä¸æ”¹å˜ã€‚å®ƒå§‹ç»ˆä¸ŽåŽŸå§‹ç¬¦å·ç›¸åŒã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä»Žå±€éƒ¨å‡½æ•°å®šä¹‰ä¸­æ¶ˆé™¤å®ƒï¼Œä»¥å‘ŠçŸ¥è¯»è€… sy åœ¨éåŽ†è¿‡ç¨‹ä¸­æ˜¯å¸¸æ•°ã€‚

ç»ƒä¹  318. è®¾è®¡æ·±åº¦ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ª S è¡¨è¾¾å¼å¹¶ç¡®å®šå…¶æ·±åº¦ã€‚ä¸€ä¸ª åŽŸå­ çš„æ·±åº¦ä¸º 1ã€‚S è¡¨è¾¾å¼åˆ—è¡¨çš„æ·±åº¦æ˜¯å…¶é¡¹çš„æœ€å¤§æ·±åº¦åŠ  1ã€‚

ç»ƒä¹  319. è®¾è®¡æ›¿æ¢å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ª S è¡¨è¾¾å¼ s å’Œä¸¤ä¸ªç¬¦å·ï¼Œæ—§çš„å’Œæ–°çš„ã€‚ç»“æžœæ˜¯ sï¼Œå…¶ä¸­æ‰€æœ‰æ—§çš„å‡ºçŽ°éƒ½è¢«æ–°æ›¿æ¢ã€‚

ç»ƒä¹  320. ä½¿ç”¨å¯¹ S-expr å®šä¹‰çš„ä¸¤ä¸ªæ›´æ”¹æ¥ç»ƒä¹ ä»Žæ•°æ®å®šä¹‰åˆ°å‡½æ•°è®¾è®¡çš„è¿‡ç¨‹ã€‚

å¯¹äºŽç¬¬ä¸€æ­¥ï¼Œé‡æ–°åˆ¶å®š S-expr çš„æ•°æ®å®šä¹‰ï¼Œä»¥ä¾¿ç¬¬ä¸€ä¸ªæ•°æ®å®šä¹‰çš„ç¬¬ä¸€ä¸ªå­å¥æ‰©å±•ä¸º åŽŸå­ çš„ä¸‰ä¸ªå­å¥ï¼Œç¬¬äºŒä¸ªæ•°æ®å®šä¹‰ä½¿ç”¨ List-of æŠ½è±¡ã€‚ä¸ºæ­¤æ•°æ®å®šä¹‰é‡æ–°è®¾è®¡ count å‡½æ•°ã€‚

å¯¹äºŽç¬¬äºŒæ­¥ï¼Œå°† SL çš„æ•°æ®å®šä¹‰é›†æˆåˆ° S-expr çš„å®šä¹‰ä¸­ã€‚å†æ¬¡ç®€åŒ– countã€‚æç¤ºï¼šä½¿ç”¨ [lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)ã€‚

ç»ƒä¹  321. æŠ½è±¡ S-expr å’Œ SL çš„æ•°æ®å®šä¹‰ï¼Œä»¥ä¾¿å®ƒä»¬æŠ½è±¡å‡ºå¯èƒ½å‡ºçŽ°çš„ åŽŸå­ ç±»åž‹ã€‚

#### 19.4 ä½¿ç”¨äº¤ç»‡æ•°æ®è®¾è®¡ðŸ”— "é“¾æŽ¥åˆ°è¿™é‡Œ")

ä»Žè‡ªå¼•ç”¨æ•°æ®å®šä¹‰åˆ°å…·æœ‰ç›¸äº’å¼•ç”¨çš„æ•°æ®å®šä¹‰é›†åˆçš„è·³è·ƒè¿œå°äºŽä»Žæœ‰é™æ•°æ®çš„æ•°æ®å®šä¹‰åˆ°è‡ªå¼•ç”¨æ•°æ®å®šä¹‰çš„è·³è·ƒã€‚ç¡®å®žï¼Œè‡ªå¼•ç”¨æ•°æ®å®šä¹‰çš„è®¾è®¡é…æ–¹â€”â€”è§ ä½¿ç”¨è‡ªå¼•ç”¨æ•°æ®å®šä¹‰è®¾è®¡â€”â€”åªéœ€è¿›è¡Œå°‘é‡è°ƒæ•´å³å¯åº”ç”¨äºŽè¿™ç§çœ‹ä¼¼å¤æ‚çš„æƒ…å†µï¼š

1.  â€œç›¸äº’å…³è”çš„æ•°æ®å®šä¹‰çš„åµŒå¥—â€çš„éœ€æ±‚ä¸Žè‡ªå¼•ç”¨æ•°æ®å®šä¹‰çš„éœ€æ±‚ç›¸ä¼¼ã€‚é—®é¢˜é™ˆè¿°æ¶‰åŠè®¸å¤šä¸åŒç±»åž‹çš„ä¿¡æ¯ï¼Œå…¶ä¸­ä¸€ç§ä¿¡æ¯å¼•ç”¨äº†å…¶ä»–ç±»åž‹ã€‚

    åœ¨æ­¤ç±»æƒ…å†µä¸‹ç»§ç»­ä¹‹å‰ï¼Œç»˜åˆ¶ç®­å¤´ä»¥è¿žæŽ¥å¯¹å®šä¹‰çš„å¼•ç”¨ã€‚è€ƒè™‘å›¾ 118 çš„å·¦ä¾§ã€‚å®ƒæ˜¾ç¤ºäº† S-expr çš„å®šä¹‰ï¼Œå…¶ä¸­åŒ…å«å¯¹ SL å’Œ Atom çš„å¼•ç”¨ï¼Œè¿™äº›å¼•ç”¨é€šè¿‡ç®­å¤´ä¸Žå„è‡ªçš„å®šä¹‰ç›¸è¿žã€‚åŒæ ·ï¼ŒSL çš„å®šä¹‰åŒ…å«ä¸€ä¸ªè‡ªå¼•ç”¨å’Œä¸€ä¸ªå¯¹ S-expr çš„å¼•ç”¨ï¼›å†æ¬¡ï¼Œä¸¤è€…éƒ½é€šè¿‡é€‚å½“çš„ç®­å¤´ç›¸è¿žã€‚

    ç±»ä¼¼äºŽè‡ªå¼•ç”¨çš„æ•°æ®å®šä¹‰ï¼Œè¿™äº›å®šä¹‰çš„åµŒå¥—ä¹Ÿéœ€è¦è¿›è¡ŒéªŒè¯ã€‚è‡³å°‘ï¼Œä½ å¿…é¡»èƒ½å¤Ÿä¸ºæ¯ä¸ªå•ç‹¬çš„å®šä¹‰æž„é€ ä¸€äº›ç¤ºä¾‹ã€‚ä»Žé‚£äº›ä¸å¼•ç”¨åµŒå¥—ä¸­å…¶ä»–æ•°æ®å®šä¹‰çš„å­å¥å¼€å§‹ã€‚è®°ä½ï¼Œå¦‚æžœæ— æ³•ä»Žå®ƒä»¬ç”Ÿæˆç¤ºä¾‹ï¼Œå®šä¹‰å¯èƒ½æ˜¯æ— æ•ˆçš„ã€‚

1.  å…³é”®çš„æ”¹å˜æ˜¯ä½ å¿…é¡»è®¾è®¡ä¸Žæ•°æ®å®šä¹‰æ•°é‡ä¸€æ ·å¤šçš„å‡½æ•°ã€‚æ¯ä¸ªå‡½æ•°ä¸“é—¨é’ˆå¯¹ä¸€ä¸ªæ•°æ®å®šä¹‰ï¼›æ‰€æœ‰å‰©ä½™çš„å‚æ•°ä¿æŒä¸å˜ã€‚åŸºäºŽè¿™ä¸€ç‚¹ï¼Œä½ ä¸ºæ¯ä¸ªå‡½æ•°å¼€å§‹ä¸€ä¸ªç­¾åã€ä¸€ä¸ªç›®çš„å£°æ˜Žå’Œä¸€ä¸ªè™šæ‹Ÿå®šä¹‰ã€‚

1.  ç¡®ä¿å¤„ç†ä½¿ç”¨æ•°æ®å®šä¹‰åµŒå¥—ä¸­æ‰€æœ‰ç›¸äº’å¼•ç”¨çš„åŠŸèƒ½ç¤ºä¾‹ã€‚

1.  å¯¹äºŽæ¯ä¸ªå‡½æ•°ï¼Œæ ¹æ®å…¶ä¸»è¦æ•°æ®å®šä¹‰è®¾è®¡æ¨¡æ¿ã€‚ä½¿ç”¨å›¾ 52 æ¥æŒ‡å¯¼æ¨¡æ¿åˆ›å»ºï¼Œç›´åˆ°æœ€åŽä¸€æ­¥ã€‚ä¿®è®¢çš„æœ€åŽä¸€æ­¥è¦æ±‚æ£€æŸ¥æ‰€æœ‰è‡ªå¼•ç”¨å’Œäº¤å‰å¼•ç”¨ã€‚ä½¿ç”¨å¸¦æœ‰ç®­å¤´çš„æ³¨é‡Šæ•°æ®å®šä¹‰æ¥æŒ‡å¯¼è¿™ä¸€æ­¥ã€‚åœ¨æ•°æ®å®šä¹‰ä¸­çš„æ¯ä¸ªç®­å¤´ä¸Šï¼Œæ¨¡æ¿ä¸­ä¹Ÿåº”åŒ…å«ä¸€ä¸ªç®­å¤´ã€‚å‚è§å›¾ 118 çš„å³ä¾§ï¼Œä»¥æŸ¥çœ‹æ¨¡æ¿çš„ç®­å¤´æ³¨é‡Šç‰ˆæœ¬ã€‚

    > > > > | ![image](img/cd031d07b7f1b4ecf6374520e88fbf20.png) |  | ![image](img/dac9d151af1b0eb7c0ee3406eab0db2a.png) |
    > > > > | --- | --- | --- |
    > > > > 
    > å›¾ 118ï¼šæ•°æ®å®šä¹‰å’Œæ¨¡æ¿åµŒå¥—çš„ç®­å¤´

    çŽ°åœ¨ç”¨å®žé™…çš„åŠŸèƒ½è°ƒç”¨æ›¿æ¢ç®­å¤´ã€‚éšç€ç»éªŒçš„ç§¯ç´¯ï¼Œä½ å°†è‡ªç„¶åœ°è·³è¿‡ç”»ç®­å¤´çš„æ­¥éª¤ï¼Œç›´æŽ¥ä½¿ç”¨åŠŸèƒ½è°ƒç”¨ã€‚

    æ³¨æ„è§‚å¯Ÿè¿™ä¸¤ä¸ªåµŒå¥—â€”â€”æ•°æ®å®šä¹‰çš„åµŒå¥—å’Œå‡½æ•°æ¨¡æ¿çš„åµŒå¥—â€”â€”éƒ½åŒ…å«å››ä¸ªç®­å¤´ï¼Œå¹¶æ³¨æ„ç®­å¤´å¯¹æ˜¯å¦‚ä½•ç›¸äº’å¯¹åº”çš„ã€‚ç ”ç©¶äººå‘˜ç§°è¿™ç§å¯¹åº”ä¸ºå¯¹ç§°æ€§ã€‚è¿™æ˜¯è®¾è®¡é…æ–¹æä¾›ä»Žé—®é¢˜åˆ°è§£å†³æ–¹æ¡ˆçš„è‡ªç„¶æ–¹å¼çš„è¯æ®ã€‚

1.  å¯¹äºŽè®¾è®¡ä¸»ä½“ï¼Œæˆ‘ä»¬ä»Žé‚£äº›ä¸åŒ…å«è‡ªç„¶é€’å½’æˆ–å…¶ä»–å‡½æ•°è°ƒç”¨çš„[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)è¡Œå¼€å§‹ã€‚å®ƒä»¬è¢«ç§°ä¸ºåŸºæœ¬æƒ…å†µã€‚ç›¸åº”çš„ç­”æ¡ˆé€šå¸¸å¾ˆå®¹æ˜“åˆ¶å®šï¼Œæˆ–è€…å·²ç»ç”±ç¤ºä¾‹ç»™å‡ºã€‚ä¹‹åŽï¼Œä½ å¤„ç†è‡ªå¼•ç”¨çš„æƒ…å†µå’Œè·¨å‡½æ•°è°ƒç”¨çš„æƒ…å†µã€‚è®©å›¾ 53 ä¸­çš„é—®é¢˜å’Œç­”æ¡ˆå¼•å¯¼ä½ ã€‚

1.  å®Œæˆæ‰€æœ‰å®šä¹‰åŽï¼Œè¿è¡Œæµ‹è¯•ã€‚å¦‚æžœä¸€ä¸ªè¾…åŠ©å‡½æ•°å‡ºé”™ï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°ä¸¤ä¸ªé”™è¯¯æŠ¥å‘Šï¼Œä¸€ä¸ªé’ˆå¯¹ä¸»å‡½æ•°ï¼Œå¦ä¸€ä¸ªé’ˆå¯¹æœ‰ç¼ºé™·çš„è¾…åŠ©å®šä¹‰ã€‚ä¸€ä¸ªä¿®å¤åº”è¯¥å¯ä»¥æ¶ˆé™¤ä¸¤ä¸ªé”™è¯¯ã€‚ç¡®ä¿è¿è¡Œæµ‹è¯•è¦†ç›–äº†å‡½æ•°çš„æ‰€æœ‰éƒ¨åˆ†ã€‚

æœ€åŽï¼Œå¦‚æžœä½ åœ¨æ­¥éª¤ 5 ä¸­é‡åˆ°äº†å›°éš¾ï¼Œè®°å¾—ä½¿ç”¨åŸºäºŽè¡¨çš„çŒœæµ‹ç»„åˆå‡½æ•°çš„æ–¹æ³•ã€‚åœ¨å¤„ç†äº¤ç»‡æ•°æ®çš„æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸ä»…éœ€è¦ä¸€ä¸ªé’ˆå¯¹æ¯ä¸ªæ¡ˆä¾‹çš„è¡¨ï¼Œè¿˜éœ€è¦é’ˆå¯¹æ¯ä¸ªæ¡ˆä¾‹å’Œæ¯ä¸ªå‡½æ•°çš„è¡¨æ¥è®¡ç®—å‡ºç»„åˆã€‚

#### 19.5 é¡¹ç›®ï¼šBSTsðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ç¨‹åºå‘˜é€šå¸¸ä½¿ç”¨æ•°æ®æ ‘çš„è¡¨ç¤ºæ¥æé«˜ä»–ä»¬å‡½æ•°çš„æ€§èƒ½ã€‚ç‰¹åˆ«è‘—åçš„ä¸€ç§æ ‘æ˜¯äºŒå‰æœç´¢æ ‘ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ç§å¿«é€Ÿå­˜å‚¨å’Œæ£€ç´¢ä¿¡æ¯çš„å¥½æ–¹æ³•ã€‚

ä¸ºäº†å…·ä½“è¯´æ˜Žï¼Œè®©æˆ‘ä»¬è®¨è®ºç®¡ç†äººå‘˜ä¿¡æ¯çš„äºŒå‰æ ‘ã€‚ä¸Žå®¶è°±ä¸­çš„å­ç»“æž„ä¸åŒï¼ŒäºŒå‰æ ‘åŒ…å«èŠ‚ç‚¹ï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â no-infoÂ []) |
> | --- |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â NONEÂ (make-no-info)) |
> | Â  |
> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â nodeÂ [ssnÂ nameÂ [left](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29)Â [right](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29)]) |
> | ;Â A BT (short for BinaryTree) is one of: |
> | ;Â â€“  NONE |
> | ;Â â€“  (make-node  Number  Symbol  BT  BT) |

ç›¸åº”çš„æ•°æ®å®šä¹‰ç±»ä¼¼äºŽå®¶è°±æ ‘ï¼Œå…¶ä¸­ NONE è¡¨ç¤ºä¿¡æ¯ç¼ºå¤±ï¼Œæ¯ä¸ªèŠ‚ç‚¹è®°å½•ä¸€ä¸ªç¤¾ä¼šä¿é™©å·ã€ä¸€ä¸ªå§“åå’Œå¦å¤–ä¸¤ä¸ªäºŒå‰æ ‘ã€‚åŽè€…ç±»ä¼¼äºŽå®¶è°±æ ‘çš„çˆ¶æ¯ï¼Œå°½ç®¡èŠ‚ç‚¹ä¸Žå…¶[å·¦](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29)å’Œ[å³](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29)æ ‘ä¹‹é—´çš„å…³ç³»ä¸æ˜¯åŸºäºŽå®¶åº­å…³ç³»ã€‚ä»¥ä¸‹æ˜¯ä¸¤ä¸ªäºŒå‰æ ‘ï¼š

> |
> 
> &#124; (make-node &#124;
> 
> &#124; Â Â 15 &#124;
> 
> &#124; Â Â 'd &#124;
> 
> &#124; Â Â NONE &#124;
> 
> &#124; Â Â (make-node &#124;
> 
> &#124; Â Â Â Â 24Â 'iÂ NONEÂ NONE)) &#124;
> 
> |  |
> | --- |
> 
> &#124; (make-node &#124;
> 
> &#124; Â Â 15 &#124;
> 
> &#124; Â Â 'd &#124;
> 
> &#124; (make-node &#124;
> 
> &#124; Â Â Â Â 87Â 'hÂ NONEÂ NONE) &#124;
> 
> &#124; Â Â NONE) &#124;
> 
> |

å›¾ 119 æ˜¾ç¤ºäº†æˆ‘ä»¬åº”è¯¥å¦‚ä½•å°†æ­¤ç±»æ ‘è§†ä¸ºç»˜å›¾ã€‚è¿™äº›æ ‘æ˜¯å€’ç½®çš„ï¼Œæ ¹åœ¨é¡¶éƒ¨ï¼Œæ ‘çš„é¡¶éƒ¨åœ¨åº•éƒ¨ã€‚æ¯ä¸ªåœ†åœˆå¯¹åº”ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç”¨ç›¸åº”èŠ‚ç‚¹ç»“æž„çš„ ssn å­—æ®µæ ‡è®°ã€‚è¿™äº›ç»˜å›¾çœç•¥äº† NONEã€‚

> > > > | æ ‘ A |  | æ ‘ B |
> > > > | --- | --- | --- |
> > > > |  |  |  |
> > > > | ![image](img/4a6656d66e6ecde910040436499df1cd.png) |  | ![image](img/5bf6b2a3ec9a774b865e4865edc764ae.png) |
> > > > 
> å›¾ 119ï¼šä¸€æ£µäºŒå‰æœç´¢æ ‘å’Œä¸€æ£µäºŒå‰æ ‘

ç»ƒä¹  322ã€‚ä»¥å›¾ 119 çš„æ–¹å¼ç»˜åˆ¶ä¸Šè¿°ä¸¤ä¸ªæ ‘ã€‚ç„¶åŽè®¾è®¡ contains-bt?ï¼Œå®ƒç¡®å®šç»™å®šçš„æ•°å­—æ˜¯å¦å‡ºçŽ°åœ¨æŸä¸ªç»™å®šçš„äºŒå‰æ ‘ BT ä¸­ã€‚

ç»ƒä¹  323ã€‚è®¾è®¡ search-bt å‡½æ•°ã€‚è¯¥å‡½æ•°æŽ¥å—ä¸€ä¸ªæ•°å­— n å’Œä¸€ä¸ªäºŒå‰æ ‘ BTã€‚å¦‚æžœæ ‘ä¸­åŒ…å«ä¸€ä¸ª ssn å­—æ®µä¸º n çš„èŠ‚ç‚¹ç»“æž„ï¼Œåˆ™è¯¥å‡½æ•°äº§ç”Ÿè¯¥èŠ‚ç‚¹[name](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._name%29%29)å­—æ®µçš„å€¼ã€‚å¦åˆ™ï¼Œè¯¥å‡½æ•°äº§ç”Ÿ#falseã€‚

æç¤ºï¼šè€ƒè™‘é¦–å…ˆä½¿ç”¨ contains-bt?æ£€æŸ¥æ•´ä¸ªæ ‘ï¼Œæˆ–è€…ä½¿ç”¨[boolean?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._boolean~3f%29%29)æ£€æŸ¥æ¯ä¸ªé˜¶æ®µçš„è‡ªç„¶é€’å½’çš„ç»“æžœã€‚

å¦‚æžœæˆ‘ä»¬ä»Žå·¦åˆ°å³è¯»å–å›¾ 119 ä¸­ä¸¤ä¸ªæ ‘ä¸­çš„æ•°å­—ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸¤ä¸ªä¸åŒçš„åºåˆ—ï¼š

> | æ ‘ A |  | 10 |  | 15 |  | 24 |  | 29 |  | 63 |  | 77 |  | 89 |  | 95 |  | 99 |
> | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
> | æ ‘ B |  | 87 |  | 15 |  | 24 |  | 29 |  | 63 |  | 33 |  | 89 |  | 95 |  | 99 |

æ ‘ A çš„åºåˆ—æ˜¯æŒ‰å‡åºæŽ’åºçš„ï¼Œè€Œæ ‘ B çš„ä¸æ˜¯ã€‚ç¬¬ä¸€ç±»äºŒå‰æ ‘æ˜¯äºŒå‰æœç´¢æ ‘ã€‚æ¯ä¸ªäºŒå‰æœç´¢æ ‘éƒ½æ˜¯äºŒå‰æ ‘ï¼Œä½†å¹¶éžæ¯ä¸ªäºŒå‰æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬åˆ¶å®šäº†ä¸€ä¸ªæ¡ä»¶â€”â€”æˆ–æ•°æ®ä¸å˜é‡â€”â€”æ¥åŒºåˆ†äºŒå‰æœç´¢æ ‘å’ŒäºŒå‰æ ‘ï¼š

BST ä¸å˜é‡

> BSTï¼ˆäºŒå‰æœç´¢æ ‘çš„ç¼©å†™ï¼‰æ˜¯æ ¹æ®ä»¥ä¸‹æ¡ä»¶å®šä¹‰çš„ BTï¼š
> 
> +   NONE æ€»æ˜¯ BSTã€‚
> +   
> +   (make-node  ssn0  name0  L  R) æ˜¯ä¸€ä¸ª BST å½“ä¸”ä»…å½“
> +   
>     +   L æ˜¯ä¸€ä¸ª BSTï¼Œ
>     +   
>     +   R æ˜¯ä¸€ä¸ª BSTï¼Œ
>     +   
>     +   L ä¸­çš„æ‰€æœ‰ ssn å­—æ®µéƒ½å°äºŽ ssn0ï¼Œ
>     +   
>     +   R ä¸­çš„æ‰€æœ‰ ssn å­—æ®µéƒ½å¤§äºŽ ssn0ã€‚

æ¢å¥è¯è¯´ï¼Œä¸ºäº†æ£€æŸ¥ä¸€ä¸ª BT æ˜¯å¦ä¹Ÿå±žäºŽ BSTï¼Œæˆ‘ä»¬å¿…é¡»æ£€æŸ¥æ‰€æœ‰å­æ ‘ä¸­çš„æ‰€æœ‰æ•°å­—ï¼Œå¹¶ç¡®ä¿å®ƒä»¬æ¯”æŸä¸ªç»™å®šçš„æ•°å­—å°æˆ–å¤§ã€‚è¿™ç»™æ•°æ®æž„å»ºå¢žåŠ äº†é¢å¤–çš„è´Ÿæ‹…ï¼Œä½†æ­£å¦‚ä»¥ä¸‹ç»ƒä¹ æ‰€ç¤ºï¼Œè¿™æ˜¯å€¼å¾—çš„ã€‚

ç»ƒä¹  324ã€‚è®¾è®¡ inorder å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªäºŒå‰æ ‘ï¼Œå¹¶äº§ç”Ÿä»Žå·¦åˆ°å³æŸ¥çœ‹æ ‘å›¾æ—¶å‡ºçŽ°çš„æ‰€æœ‰ ssn æ•°å­—çš„åºåˆ—ã€‚

æç¤ºï¼šä½¿ç”¨[append](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29)ï¼Œå®ƒåƒè¿™æ ·è¿žæŽ¥åˆ—è¡¨ï¼š

> | ([append](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._append%29%29)Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 1Â 2Â 3)Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 4)Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 5Â 6Â 7)) |
> | --- |
> | == |
> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 1Â 2Â 3Â 4Â 5Â 6Â 7) |

äºŒå‰æœç´¢æ ‘çš„ä¸­åºä¼šäº§ç”Ÿä»€ä¹ˆï¼Ÿ

åœ¨ BST ä¸­å¯»æ‰¾å…·æœ‰ç»™å®š ssn çš„èŠ‚ç‚¹å¯èƒ½åˆ©ç”¨äº† BST çš„ä¸å˜é‡ã€‚ä¸ºäº†æ‰¾å‡º BT æ˜¯å¦åŒ…å«å…·æœ‰ç‰¹å®š ssn çš„èŠ‚ç‚¹ï¼Œä¸€ä¸ªå‡½æ•°å¯èƒ½å¿…é¡»æŸ¥çœ‹æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¸ºäº†æ‰¾å‡ºäºŒå‰æœç´¢æ ‘æ˜¯å¦åŒ…å«ç›¸åŒçš„ ssnï¼Œä¸€ä¸ªå‡½æ•°å¯èƒ½å¯ä»¥æ¶ˆé™¤æ¯ä¸ªèŠ‚ç‚¹æ£€æŸ¥çš„ä¸¤ä¸ªå­æ ‘ä¸­çš„ä¸€ä¸ªã€‚

è®©æˆ‘ä»¬ç”¨è¿™ä¸ªæ ·æœ¬ BST æ¥è¯´æ˜Žè¿™ä¸ªæƒ³æ³•ï¼š

> (make-nodeÂ 66Â 'aÂ LÂ R)

å¦‚æžœæˆ‘ä»¬åœ¨å¯»æ‰¾ 66ï¼Œæˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾çš„èŠ‚ç‚¹ã€‚çŽ°åœ¨ï¼Œå¦‚æžœæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªæ›´å°çš„æ•°å­—ï¼Œæ¯”å¦‚è¯´ 63ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœç´¢é›†ä¸­åœ¨ L ä¸Šï¼Œå› ä¸ºæ‰€æœ‰å…·æœ‰å°äºŽ 66 çš„ ssn å­—æ®µçš„èŠ‚ç‚¹éƒ½åœ¨ L ä¸­ã€‚åŒæ ·ï¼Œå¦‚æžœæˆ‘ä»¬æƒ³è¦å¯»æ‰¾ 99ï¼Œæˆ‘ä»¬ä¼šå¿½ç•¥ L å¹¶é›†ä¸­åœ¨ R ä¸Šï¼Œå› ä¸ºæ‰€æœ‰å…·æœ‰å¤§äºŽ 66 çš„ ssns çš„èŠ‚ç‚¹éƒ½åœ¨ R ä¸­ã€‚

ç»ƒä¹  325ã€‚è®¾è®¡ search-bstã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªæ•°å­— n å’Œä¸€ä¸ª BSTã€‚å¦‚æžœæ ‘åŒ…å«ä¸€ä¸ªå…·æœ‰ n å­—æ®µçš„èŠ‚ç‚¹ï¼Œåˆ™è¯¥å‡½æ•°äº§ç”Ÿè¯¥èŠ‚ç‚¹ä¸­ [name](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._name%29%29) å­—æ®µçš„å€¼ã€‚å¦åˆ™ï¼Œè¯¥å‡½æ•°äº§ç”Ÿ NONEã€‚å‡½æ•°ç»„ç»‡å¿…é¡»åˆ©ç”¨ BST ä¸å˜å¼ï¼Œä»¥ä¾¿è¯¥å‡½æ•°æ‰§è¡Œå°½å¯èƒ½å°‘çš„æ¯”è¾ƒã€‚

æŸ¥çœ‹ç¬¬ 189 é¢˜äº†è§£åœ¨æœ‰åºåˆ—è¡¨ä¸­è¿›è¡Œæœç´¢ã€‚æ¯”è¾ƒä¸€ä¸‹ï¼

æž„å»ºäºŒå‰æ ‘å¾ˆç®€å•ï¼›æž„å»ºäºŒå‰æœç´¢æ ‘åˆ™æ¯”è¾ƒå¤æ‚ã€‚ç»™å®šä»»ä½•ä¸¤ä¸ª BTï¼Œä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªåç§°ï¼Œæˆ‘ä»¬åªéœ€æŒ‰ç…§æ­£ç¡®çš„é¡ºåºå°†è¿™äº›å€¼åº”ç”¨åˆ° make-node ä¸Šï¼Œç„¶åŽ voilÃ ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„ BTã€‚åŒæ ·çš„è¿‡ç¨‹å¯¹äºŽ BST æ˜¯å¤±è´¥çš„ï¼Œå› ä¸ºç»“æžœé€šå¸¸ä¸ä¼šæ˜¯ä¸€ä¸ª BSTã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä¸€ä¸ª BST åŒ…å«å…·æœ‰æ­£ç¡®é¡ºåºçš„ ssn å­—æ®µ 3 å’Œ 5 çš„èŠ‚ç‚¹ï¼Œè€Œå¦ä¸€ä¸ªåŒ…å« ssn å­—æ®µ 2 å’Œ 6ï¼Œä»…ä»…é€šè¿‡å¦ä¸€ä¸ªç¤¾ä¼šä¿é™©å·ç å’Œåç§°å°†ä¸¤ä¸ªæ ‘åˆå¹¶å¹¶ä¸ä¼šäº§ç”Ÿä¸€ä¸ª BSTã€‚

å‰©ä¸‹çš„ä¸¤ä¸ªç»ƒä¹ è§£é‡Šäº†å¦‚ä½•ä»Žä¸€ä¸ªæ•°å­—å’Œåç§°åˆ—è¡¨ä¸­æž„å»ºä¸€ä¸ª BSTã€‚å…·ä½“æ¥è¯´ï¼Œç¬¬ä¸€ä¸ªç»ƒä¹ è¦æ±‚ä¸€ä¸ªå‡½æ•°å°†ç»™å®šçš„ ssn0 å’Œ name0 æ’å…¥åˆ°ä¸€ä¸ª BST ä¸­ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒäº§ç”Ÿä¸€ä¸ª BSTï¼Œå°±åƒå®ƒç»™å‡ºçš„é‚£æ ·ï¼Œæ’å…¥äº†ä¸€ä¸ªåŒ…å« ssn0ã€name0 å’Œ NONE å­æ ‘çš„èŠ‚ç‚¹ã€‚ç¬¬äºŒä¸ªç»ƒä¹ éšåŽè¦æ±‚ä¸€ä¸ªå‡½æ•°å¯ä»¥å¤„ç†ä¸€ä¸ªå®Œæ•´çš„æ•°å­—å’Œåç§°åˆ—è¡¨ã€‚

ç»ƒä¹  326ã€‚è®¾è®¡ create-bst å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ª BST Bã€ä¸€ä¸ªæ•°å­— N å’Œä¸€ä¸ªç¬¦å· Sã€‚å®ƒäº§ç”Ÿä¸€ä¸ªä¸Ž B å®Œå…¨ç›¸åŒçš„ BSTï¼Œå¹¶ä¸”ç”¨ä¸€ä¸ªèŠ‚ç‚¹ç»“æž„æ›¿æ¢ä¸€ä¸ª NONE å­æ ‘

> (make-nodeÂ NÂ SÂ NONEÂ NONE)

ä¸€æ—¦è®¾è®¡å®Œæˆï¼Œä½¿ç”¨è¯¥å‡½æ•°å¯¹å›¾ 119 ä¸­çš„æ ‘ A è¿›è¡Œæ“ä½œã€‚ç»ƒä¹  327ã€‚è®¾è®¡ create-bst-from-list å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªæ•°å­—å’Œåç§°åˆ—è¡¨ï¼Œå¹¶é€šè¿‡é‡å¤åº”ç”¨ create-bst æž„é€ ä¸€ä¸ª BSTã€‚ä»¥ä¸‹æ˜¯å®ƒçš„ç­¾åï¼š

> ;Â [List-of [List Number Symbol]] -> BST

ä½¿ç”¨å®Œæ•´çš„å‡½æ•°ä»Žè¿™ä¸ªæ ·æœ¬è¾“å…¥ä¸­åˆ›å»ºä¸€ä¸ª BSTï¼š

> | '((99Â o) |
> | --- |
> | Â Â (77Â l) |
> | Â Â (24Â i) |
> | Â Â (10Â h) |
> | Â Â (95Â g) |
> | Â Â (15Â d) |
> | Â Â (89Â c) |
> | Â Â (29Â b) |
> | Â Â (63Â a)) |

å¦‚æžœéµå¾ªç»“æž„è®¾è®¡é£Ÿè°±ï¼Œç»“æžœæ˜¯å›¾ 119 ä¸­çš„æ ‘ Aã€‚å¦‚æžœä½ ä½¿ç”¨çŽ°æœ‰çš„æŠ½è±¡ï¼Œä½ ä»ç„¶å¯èƒ½å¾—åˆ°è¿™æ£µæ ‘ï¼Œä½†ä½ ä¹Ÿå¯èƒ½å¾—åˆ°ä¸€ä¸ªâ€œå€’ç½®â€çš„æ ‘ã€‚ä¸ºä»€ä¹ˆï¼Ÿ

#### 19.6 ç®€åŒ–å‡½æ•°ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ç»ƒä¹  317 å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ [å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) æ¥ç»„ç»‡å¤„ç†äº¤ç»‡æ•°æ®å½¢å¼çš„å‡½æ•°ã€‚è¿™ç§ç»„ç»‡æ–¹å¼ä¹Ÿæœ‰åŠ©äºŽåœ¨æ•°æ®å®šä¹‰æœ€ç»ˆç¡®å®šåŽç®€åŒ–å‡½æ•°ã€‚ä¸ºäº†è¯´æ˜Žè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è§£é‡Šäº†å¦‚ä½•ç®€åŒ– ç»ƒä¹  319 çš„è§£å†³æ–¹æ¡ˆã€‚

> > > | ; S-è¡¨è¾¾å¼  ç¬¦å·  åŽŸå­ -> S-è¡¨è¾¾å¼ |
> > > | --- |
> > > | ; æ›¿æ¢ sexp ä¸­æ‰€æœ‰ old çš„å‡ºçŽ°ä¸º new |
> > > |   |
> > > | ([æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29) (æ›¿æ¢ '(((world) bye) bye) 'bye '42) |
> > > |   ([æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29) '(((world) 42) 42)) |
> > > |   |
> > > |   ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (æ›¿æ¢ sexp old new))) |
> > > |   ([å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (; S-è¡¨è¾¾å¼ -> S-è¡¨è¾¾å¼ |
> > > |   ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (for-sexp sexp)) |
> > > |   ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   ([å¦‚æžœ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) ([åŽŸå­?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._atom~3f%29%29) sexp) ([for-åŽŸå­](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._for-atom%29%29) sexp))) |
> > > |   ([å¦åˆ™](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) (for-sl sexp))) |
> > > | ; SL -> S-è¡¨è¾¾å¼ |
> > > |   ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (for-sl sl)) |
> > > |   ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   ([å¦‚æžœ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) sl) '()] |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [[å¦åˆ™](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â (for-sexpÂ ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â sl)) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([for-sl](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â sl)))])) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â ; åŽŸå­ -> S-è¡¨è¾¾å¼ |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-atomÂ at) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [([æ•°å­—?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._number~3f%29%29)Â at)Â at] |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [([å­—ç¬¦ä¸²?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)Â at)Â at] |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [([ç¬¦å·?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â at)Â ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)Â ([ç­‰äºŽ?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._equal~3f%29%29)Â atÂ old)Â newÂ at)]))) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â (for-sexpÂ sexp))) |
> > > 
> å›¾ 120ï¼šä¸€ä¸ªå¾…ç®€åŒ–çš„ç¨‹åº

å›¾ 120 å±•ç¤ºäº†æ›¿æ¢å‡½æ•°çš„å®Œæ•´å®šä¹‰ã€‚è¯¥å®šä¹‰ä½¿ç”¨äº†[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)å’Œä¸‰ä¸ªè¾…åŠ©å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ç”±æ•°æ®å®šä¹‰å»ºè®®ä½¿ç”¨ã€‚å›¾ä¸­åŒ…å«äº†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹å»ºè®®çš„æ¯æ¬¡ç¼–è¾‘åŽé‡æ–°æµ‹è¯•è¯¥å‡½æ•°ã€‚åœæ­¢ï¼å¼€å‘é¢å¤–çš„æµ‹è¯•ç”¨ä¾‹ï¼›å‡ ä¹Žæ°¸è¿œä¸å¤Ÿä¸€ä¸ªã€‚

ç»ƒä¹  328ã€‚å°†å›¾ 120 å¤åˆ¶å¹¶ç²˜è´´åˆ° DrRacket ä¸­ï¼›åŒ…æ‹¬æ‚¨çš„æµ‹è¯•å¥—ä»¶ã€‚éªŒè¯æµ‹è¯•å¥—ä»¶ã€‚åœ¨é˜…è¯»æœ¬èŠ‚å‰©ä½™éƒ¨åˆ†æ—¶ï¼Œæ‰§è¡Œç¼–è¾‘å¹¶é‡æ–°è¿è¡Œæµ‹è¯•å¥—ä»¶ï¼Œä»¥ç¡®è®¤æˆ‘ä»¬è®ºç‚¹çš„æœ‰æ•ˆæ€§ã€‚

> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (substituteÂ sexpÂ oldÂ new) |
> > > | --- |
> > > |   ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (;Â S-è¡¨è¾¾å¼ -> S-è¡¨è¾¾å¼ |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-sexpÂ sexp) |
> > > |   ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   [(atom?Â sexp)Â (for-atomÂ sexp)] |
> > > |   [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â (for-slÂ sexp)])) |
> > > |   ;Â SL -> S-è¡¨è¾¾å¼ |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-slÂ sl) |
> > > |   ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)Â for-sexpÂ sl)) |
> > > |   ;Â åŽŸå­ -> S-è¡¨è¾¾å¼ |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-atomÂ at) |
> > > |   ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   [([number?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._number~3f%29%29)Â at)Â at] |
> > > |   [([string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)Â at)Â at] |
> > > |   [([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â at)Â ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)Â ([equal?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._equal~3f%29%29)Â atÂ old)Â newÂ at)]))) |
> > > |   (for-sexpÂ sexp))) |
> > > 
> å›¾ 121ï¼šç¨‹åºç®€åŒ–ï¼Œæ­¥éª¤ 1

ç”±äºŽæˆ‘ä»¬çŸ¥é“ SL æè¿°äº† S-expr çš„åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ [map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) æ¥ç®€åŒ– for-slã€‚è§ å›¾Â 121 ä»¥æŸ¥çœ‹ç»“æžœã€‚è™½ç„¶åŽŸå§‹ç¨‹åºè¡¨ç¤º for-sexp åº”ç”¨äºŽ sl ä¸Šçš„æ¯ä¸ªé¡¹ç›®ï¼Œä½†å…¶ä¿®è®¢åŽçš„å®šä¹‰ä½¿ç”¨ [map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) æ›´ç®€æ´åœ°è¡¨è¾¾äº†ç›¸åŒçš„æ¦‚å¿µã€‚

å¯¹äºŽç¬¬äºŒä¸ªç®€åŒ–æ­¥éª¤ï¼Œæˆ‘ä»¬éœ€è¦æé†’æ‚¨ï¼Œ[equal?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._equal~3f%29%29) æ¯”è¾ƒä»»æ„ä¸¤ä¸ªå€¼ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œç¬¬ä¸‰ä¸ª [local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) å‡½æ•°å°±å˜æˆäº†ä¸€è¡Œä»£ç ã€‚å›¾Â 122 å±•ç¤ºäº†è¿™ä¸€ç¬¬äºŒä¸ªç®€åŒ–è¿‡ç¨‹ã€‚

> > > | |Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (substituteÂ sexpÂ oldÂ new) |
> > > | --- | --- |
> > > | |Â Â ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (;Â S-expr -> S-expr |
> > > | |Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-sexpÂ sexp) |
> > > | |Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [(atom?Â sexp)Â (for-atomÂ sexp)] |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â (for-slÂ sexp)])) |
> > > | |Â Â Â Â Â Â Â Â Â ;Â SL -> S-expr |
> > > | |Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-slÂ sl)Â ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)Â for-sexpÂ sl)) |
> > > | |Â Â ;Â Atom -> S-expr |
> > > | |Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-atomÂ at) |
> > > |   ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)Â ([equal?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._equal~3f%29%29)Â atÂ old)Â newÂ at))) |
> > > |   (for-sexpÂ sexp))) |
> > > |   |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (substitute.v3Â sexpÂ oldÂ new) |
> > > |   ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (;Â S-expr -> S-expr |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (for-sexpÂ sexp) |
> > > |   ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   [(atom?Â sexp) |
> > > |   (ifÂ ([equal?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._equal~3f%29%29)Â sexpÂ old)Â newÂ sexp)] |
> > > |   [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> > > |   ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)Â for-sexpÂ sexp)]))) |
> > > |   (for-sexpÂ sexp))) |
> > > 
> å›¾ 122ï¼šç¨‹åºç®€åŒ–ï¼Œæ­¥éª¤ 2 å’Œ 3

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæœ€åŽä¸¤ä¸ª[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)å®šä¹‰ç”±ä¸€è¡Œç»„æˆã€‚æ­¤å¤–ï¼Œè¿™ä¸¤ä¸ªå®šä¹‰éƒ½ä¸æ˜¯é€’å½’çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ for-sexp ä¸­å†…è”å‡½æ•°ã€‚å†…è”æ„å‘³ç€ç”¨([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29) ([equal?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._equal~3f%29%29) sexp old) new sexp)æ›¿æ¢(for-atom sexp)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç”¨å®žé™…çš„å‚æ•° sexp æ›¿æ¢äº†å‚æ•° withã€‚åŒæ ·åœ°ï¼Œå¯¹äºŽ(for-sl sexp)ï¼Œæˆ‘ä»¬æ”¾å…¥([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) for-sexp sexp)ï¼›å‚è§å›¾ 121 çš„ä¸‹åŠéƒ¨åˆ†ã€‚æˆ‘ä»¬çŽ°åœ¨å‰©ä¸‹çš„åªæ˜¯ä¸€ä¸ªå®šä¹‰ä¸­å¼•å…¥äº†ä¸€ä¸ª[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)å‡½æ•°çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨ç›¸åŒçš„é‡å¤§å‚æ•°ä¸Šè¢«è°ƒç”¨ã€‚å¦‚æžœæˆ‘ä»¬ç³»ç»Ÿåœ°æä¾›å…¶ä»–ä¸¤ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å°±ä¼šç«‹å³çœ‹åˆ°å±€éƒ¨å®šä¹‰çš„å‡½æ•°å¯ä»¥ç”¨ä½œå¤–éƒ¨å‡½æ•°çš„æ›¿ä»£ã€‚

è¿™é‡Œæ˜¯å°†è¿™ä¸ªæœ€åŽçš„æ€æƒ³ç¿»è¯‘æˆä»£ç çš„ç»“æžœï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) ([substitute](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._substitute%29%29) sexp old new) |
> | --- |
> | ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â [(atom? sexp) ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29) ([equal?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._equal~3f%29%29) sexp old) new sexp)] |
> | ([else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> | ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29) (s) (substitute s old new))) sexp)])) |

åœï¼è§£é‡Šä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»ä½¿ç”¨[lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)æ¥å®Œæˆæœ€åŽçš„ç®€åŒ–ã€‚

### 20 è¿­ä»£ç»†åŒ–ðŸ”— "é“¾æŽ¥è‡³æ­¤")

å½“æ‚¨å¼€å‘çŽ°å®žä¸–ç•Œçš„ç¨‹åºæ—¶ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°å¤æ‚çš„ä¿¡æ¯å½¢å¼ä»¥åŠç”¨æ•°æ®è¡¨ç¤ºå®ƒä»¬çš„é—®é¢˜ã€‚å¤„ç†è¿™ä¸ªä»»åŠ¡çš„æœ€ä½³ç­–ç•¥æ˜¯ä½¿ç”¨è¿­ä»£ç»†åŒ–ï¼Œè¿™æ˜¯ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„ç§‘å­¦è¿‡ç¨‹ã€‚ç§‘å­¦å®¶çš„ä»»åŠ¡æ˜¯ä½¿ç”¨æŸç§å½¢å¼çš„æ•°å­¦æ¥è¡¨ç¤ºçŽ°å®žä¸–ç•Œçš„ä¸€éƒ¨åˆ†ã€‚è¿™ç§åŠªåŠ›çš„æˆæžœè¢«ç§°ä¸ºæ¨¡åž‹ã€‚ç„¶åŽç§‘å­¦å®¶é€šè¿‡å¤šç§æ–¹å¼æµ‹è¯•è¿™ä¸ªæ¨¡åž‹ï¼Œç‰¹åˆ«æ˜¯é€šè¿‡é¢„æµ‹å®žéªŒçš„ç»“æžœã€‚å¦‚æžœé¢„æµ‹å’Œæµ‹é‡ä¹‹é—´çš„å·®å¼‚å¤ªå¤§ï¼Œæ¨¡åž‹å°±ä¼šé€šè¿‡æ”¹è¿›é¢„æµ‹çš„ç›®æ ‡è¿›è¡Œç»†åŒ–ã€‚è¿™ä¸ªè¿­ä»£è¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°é¢„æµ‹è¶³å¤Ÿå‡†ç¡®ä¸ºæ­¢ã€‚

è€ƒè™‘ä¸€ä½å¸Œæœ›é¢„æµ‹ç«ç®­é£žè¡Œè½¨è¿¹çš„ç‰©ç†å­¦å®¶ã€‚è™½ç„¶â€œç«ç®­ä½œä¸ºä¸€ä¸ªç‚¹â€çš„è¡¨ç¤ºç®€å•ï¼Œä½†å®ƒä¹Ÿå¾ˆä¸å‡†ç¡®ï¼Œä¾‹å¦‚æ²¡æœ‰è€ƒè™‘åˆ°ç©ºæ°”æ‘©æ“¦ã€‚ä½œä¸ºå›žåº”ï¼Œç‰©ç†å­¦å®¶å¯èƒ½ä¼šæ·»åŠ ç«ç®­çš„ç²—ç³™è½®å»“å¹¶å¼•å…¥å¿…è¦çš„æ•°å­¦æ¥è¡¨ç¤ºæ‘©æ“¦ã€‚è¿™ä¸ªç¬¬äºŒä¸ªæ¨¡åž‹æ˜¯ç¬¬ä¸€ä¸ªæ¨¡åž‹çš„ç»†åŒ–ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç§‘å­¦å®¶ä¼šé‡å¤â€”â€”æˆ–è€…è¯´ç¨‹åºå‘˜ä¼šè¿­ä»£â€”â€”è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æ¨¡åž‹èƒ½å¤Ÿä»¥è¶³å¤Ÿçš„å‡†ç¡®æ€§é¢„æµ‹ç«ç®­çš„é£žè¡Œè½¨è¿¹ã€‚

åœ¨è®¡ç®—æœºç§‘å­¦ç³»å—è¿‡è®­ç»ƒçš„ç¨‹åºå‘˜åº”è¯¥åƒè¿™ä½ç‰©ç†å­¦å®¶ä¸€æ ·è¡Œäº‹ã€‚å…³é”®æ˜¯æ‰¾åˆ°å‡†ç¡®çš„æ•°æ®è¡¨ç¤ºçŽ°å®žä¸–ç•Œçš„ä¿¡æ¯ä»¥åŠå¤„ç†å®ƒä»¬çš„é€‚å½“å‡½æ•°ã€‚å¤æ‚æƒ…å†µéœ€è¦é€šè¿‡ç»†åŒ–è¿‡ç¨‹æ¥è¾¾åˆ°è¶³å¤Ÿçš„æ•°æ®è¡¨ç¤ºå’Œé€‚å½“çš„å‡½æ•°ã€‚è¿™ä¸ªè¿‡ç¨‹ä»ŽåŸºæœ¬çš„ä¿¡æ¯å—å¼€å§‹ï¼Œæ ¹æ®éœ€è¦æ·»åŠ å…¶ä»–ä¿¡æ¯ã€‚æœ‰æ—¶ç¨‹åºå‘˜å¿…é¡»åœ¨ç¨‹åºéƒ¨ç½²åŽå¯¹æ¨¡åž‹è¿›è¡Œç»†åŒ–ï¼Œå› ä¸ºç”¨æˆ·è¯·æ±‚é¢å¤–çš„åŠŸèƒ½ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åœ¨å¤„ç†å¤æ‚æ•°æ®å½¢å¼æ—¶å·²ç»ä¸ºæ‚¨ä½¿ç”¨äº†è¿­ä»£ç»†åŒ–ã€‚æœ¬ç« é€šè¿‡ä¸€ä¸ªæ‰©å±•çš„ç¤ºä¾‹æ¥è¯´æ˜Žè¿­ä»£ç»†åŒ–ä½œä¸ºç¨‹åºå¼€å‘çš„åŽŸåˆ™ï¼Œè¯¥ç¤ºä¾‹ä»£è¡¨å’Œå¤„ç†ï¼ˆéƒ¨åˆ†ï¼‰è®¡ç®—æœºçš„æ–‡ä»¶ç³»ç»Ÿã€‚æˆ‘ä»¬é¦–å…ˆç®€è¦è®¨è®ºæ–‡ä»¶ç³»ç»Ÿï¼Œç„¶åŽè¿­ä»£åœ°å¼€å‘ä¸‰ç§æ•°æ®è¡¨ç¤ºã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€äº›ç¼–ç¨‹ç»ƒä¹ ï¼Œä»¥ä¾¿æ‚¨çœ‹åˆ°è®¾è®¡é…æ–¹å¦‚ä½•å¸®åŠ©ä¿®æ”¹çŽ°æœ‰ç¨‹åºã€‚

#### 20.1 æ•°æ®åˆ†æžðŸ”— "é“¾æŽ¥è‡³æ­¤")

åœ¨å…³é—­ DrRacket ä¹‹å‰ï¼Œæ‚¨æƒ³è¦ç¡®ä¿æ‰€æœ‰çš„å·¥ä½œéƒ½å®‰å…¨åœ°ä¿å­˜åœ¨æŸä¸ªåœ°æ–¹ã€‚å¦åˆ™ï¼Œæ‚¨åœ¨ä¸‹æ¬¡å¯åŠ¨ DrRacket æ—¶å¿…é¡»é‡æ–°è¾“å…¥ä¸€åˆ‡ã€‚æ–‡ä»¶å®žé™…ä¸Šæ˜¯ä¸€ç³»åˆ—å­—èŠ‚ï¼Œä¸€ä¸ªæŽ¥ä¸€ä¸ªã€‚å°è¯•å®šä¹‰æ–‡ä»¶ç±»ã€‚æ‰€ä»¥æ‚¨è¦æ±‚è®¡ç®—æœºå°†ç¨‹åºå’Œæ•°æ®ä¿å­˜åœ¨æ–‡ä»¶ä¸­ã€‚æ–‡ä»¶å¤§è‡´ä¸Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

> > > ![image](img/03add47aad5b4abed5766964bbdf1c3c.png)
> > > 
> å›¾ 123ï¼šä¸€ä¸ªç¤ºä¾‹ç›®å½•æ ‘

åœ¨å¤§å¤šæ•°è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶ç»„ç»‡åœ¨ç›®å½•æˆ–æ–‡ä»¶å¤¹ä¸­ã€‚ç²—ç•¥åœ°è¯´ï¼Œç›®å½•åŒ…å«ä¸€äº›æ–‡ä»¶å’Œä¸€äº›æ›´å¤šçš„ç›®å½•ã€‚åŽè€…ç§°ä¸ºå­ç›®å½•ï¼Œå¯èƒ½åŒ…å«æ›´å¤šçš„å­ç›®å½•å’Œæ–‡ä»¶ã€‚ç”±äºŽå±‚æ¬¡ç»“æž„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç›®å½•æ ‘ã€‚

å›¾ 123 åŒ…å«äº†ä¸€ä¸ªå°ç›®å½•æ ‘çš„å›¾å½¢è‰å›¾ï¼Œå›¾ç‰‡è§£é‡Šäº†ä¸ºä»€ä¹ˆè®¡ç®—æœºç§‘å­¦å®¶ç§°å®ƒä»¬ä¸ºæ ‘ã€‚ä¸Žè®¡ç®—æœºç§‘å­¦çš„ä¼ ç»Ÿç›¸åï¼Œè¯¥å›¾æ˜¾ç¤ºæ ‘å‘ä¸Šç”Ÿé•¿ï¼Œæ ¹ç›®å½•å‘½åä¸º TSã€‚æ ¹ç›®å½•åŒ…å«ä¸€ä¸ªåä¸º read!çš„æ–‡ä»¶å’Œä¸¤ä¸ªå­ç›®å½•ï¼Œåˆ†åˆ«å‘½åä¸º Text å’Œ Libsã€‚ç¬¬ä¸€ä¸ªå­ç›®å½• Text åªåŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼›åŽè€… Libs åªåŒ…å«ä¸¤ä¸ªå­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•è‡³å°‘åŒ…å«ä¸€ä¸ªæ–‡ä»¶ã€‚æœ€åŽï¼Œæ¯ä¸ªæ¡†éƒ½æœ‰ä¸€ä¸ªæ³¨é‡Šï¼šç›®å½•ç”¨ DIR æ³¨é‡Šï¼Œæ–‡ä»¶ç”¨æ•°å­—æ³¨é‡Šï¼Œè¡¨ç¤ºå…¶å¤§å°ã€‚

ç»ƒä¹  329ã€‚æ–‡ä»¶å read!åœ¨ç›®å½•æ ‘ TS ä¸­å‡ºçŽ°äº†å¤šå°‘æ¬¡ï¼Ÿä½ èƒ½æè¿°ä»Žæ ¹ç›®å½•åˆ°å‡ºçŽ°å¤„çš„è·¯å¾„å—ï¼Ÿæ ‘ä¸­æ‰€æœ‰æ–‡ä»¶çš„æ€»å¤§å°æ˜¯å¤šå°‘ï¼Ÿå¦‚æžœæ¯ä¸ªç›®å½•èŠ‚ç‚¹çš„å¤§å°ä¸º 1ï¼Œæ ‘çš„æ€»å¤§å°æ˜¯å¤šå°‘ï¼Ÿå®ƒåŒ…å«å¤šå°‘å±‚ç›®å½•ï¼Ÿ

#### 20.2 ç»†åŒ–æ•°æ®å®šä¹‰ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ç»ƒä¹  329 åˆ—å‡ºäº†ç”¨æˆ·é€šå¸¸å…³äºŽç›®å½•æå‡ºçš„ä¸€äº›é—®é¢˜ã€‚ä¸ºäº†å›žç­”è¿™äº›é—®é¢˜ï¼Œè®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿæä¾›äº†å¯ä»¥å›žç­”å®ƒä»¬çš„ç¨‹åºã€‚å¦‚æžœæ‚¨æƒ³è®¾è®¡è¿™æ ·çš„ç¨‹åºï¼Œæ‚¨éœ€è¦ä¸ºç›®å½•æ ‘å¼€å‘æ•°æ®è¡¨ç¤ºã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿­ä»£ç»†åŒ–æ¥å¼€å‘ä¸‰ç§è¿™æ ·çš„æ•°æ®è¡¨ç¤ºã€‚å¯¹äºŽæ¯ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦å†³å®šåŒ…å«å“ªäº›å±žæ€§ä»¥åŠå¿½ç•¥å“ªäº›å±žæ€§ã€‚è€ƒè™‘å›¾ 123 ä¸­çš„ç›®å½•æ ‘ï¼Œå¹¶æƒ³è±¡å®ƒæ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚å½“ç”¨æˆ·é¦–æ¬¡åˆ›å»ºç›®å½•æ—¶ï¼Œå®ƒæ˜¯ç©ºçš„ã€‚éšç€æ—¶é—´çš„æŽ¨ç§»ï¼Œç”¨æˆ·ä¼šæ·»åŠ æ–‡ä»¶å’Œç›®å½•ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·é€šè¿‡åç§°æ¥å¼•ç”¨æ–‡ä»¶ï¼Œä½†é€šå¸¸å°†ç›®å½•è§†ä¸ºå®¹å™¨ã€‚

æ¨¡åž‹ 1 æˆ‘ä»¬çš„æ€æƒ³å®žéªŒè¡¨æ˜Žï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡åž‹åº”è¯¥ä¸“æ³¨äºŽæ–‡ä»¶ä½œä¸ºå…·æœ‰åç§°çš„åŽŸå­å®žä½“ï¼Œç›®å½•ä½œä¸ºå®¹å™¨ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¤„ç†ç›®å½•ä½œä¸ºåˆ—è¡¨å’Œæ–‡ä»¶ä½œä¸ºå­—ç¬¦ä¸²çš„æ•°æ®å®šä¹‰ï¼Œå³å®ƒä»¬çš„åç§°ï¼š

> | ;Â ä¸€ä¸ª Dir.v1ï¼ˆç®€ç§°ä¸ºç›®å½•ï¼‰æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š |
> | --- |
> | ;Â â€“  '() |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  File.v1  Dir.v1) |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Dir.v1  Dir.v1) |
> | Â  |
> | ;Â A File.v1 is a String. |

The names have a .v1 suffix to distinguish them from future refinements.

ç»ƒä¹  330\. å°† å›¾ 123 ä¸­çš„ç›®å½•æ ‘æ ¹æ®æ¨¡åž‹ 1 è½¬æ¢ä¸ºæ•°æ®è¡¨ç¤ºã€‚

ç»ƒä¹  331\. è®¾è®¡å‡½æ•° how-manyï¼Œè¯¥å‡½æ•°ç¡®å®šç»™å®š Dir.v1 åŒ…å«å¤šå°‘ä¸ªæ–‡ä»¶ã€‚è¯·è®°ä½éµå¾ªè®¾è®¡é…æ–¹ï¼›ç»ƒä¹  330 ä¸ºä½ æä¾›äº†æ•°æ®ç¤ºä¾‹ã€‚

æ¨¡åž‹ 2 å¦‚æžœä½ è§£å†³äº† ç»ƒä¹  331ï¼Œä½ ä¼šçŸ¥é“è¿™ä¸ªç¬¬ä¸€ä¸ªæ•°æ®å®šä¹‰ä»ç„¶ç›¸å½“ç®€å•ã€‚ä½†æ˜¯ï¼Œå®ƒä¹ŸæŽ©ç›–äº†ç›®å½•çš„æœ¬è´¨ã€‚ä½¿ç”¨è¿™ç§ç¬¬ä¸€ç§è¡¨ç¤ºï¼Œæˆ‘ä»¬æ— æ³•åˆ—å‡ºæŸäº›ç»™å®šç›®å½•çš„æ‰€æœ‰å­ç›®å½•åç§°ã€‚ä¸ºäº†æ¯”å®¹å™¨æ›´å¿ å®žåœ°å¯¹ç›®å½•è¿›è¡Œå»ºæ¨¡ï¼Œæˆ‘ä»¬å¿…é¡»å¼•å…¥ä¸€ä¸ªç»“åˆåç§°å’Œå®¹å™¨çš„ç»“æž„ç±»åž‹ï¼š

> ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â dirÂ [nameÂ content])

è¿™ç§æ–°çš„ç»“æž„ç±»åž‹ï¼Œåè¿‡æ¥ï¼Œå»ºè®®å¯¹æ•°æ®å®šä¹‰è¿›è¡Œä»¥ä¸‹ä¿®è®¢ï¼š

> | ;Â A Dir.v2 is a structure: |
> | --- |
> | ;Â Â Â (make-dir  String  LOFD) |
> | Â  |
> | ;Â An LOFD (short for list of files and directories) is one of: |
> | ;Â â€“  '() |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  File.v2  LOFD) |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Dir.v2  LOFD) |
> | Â  |
> | ;Â A File.v2 is a String. |

æ³¨æ„ Dir.v2 çš„æ•°æ®å®šä¹‰å¦‚ä½•å¼•ç”¨ LOFD çš„å®šä¹‰ï¼Œä»¥åŠ LOFD çš„å®šä¹‰åˆå¦‚ä½•å›žæŒ‡ Dir.v2ã€‚è¿™ä¸¤ä¸ªå®šä¹‰æ˜¯ç›¸äº’é€’å½’çš„ã€‚

ç»ƒä¹  332\. å°† å›¾ 123 ä¸­çš„ç›®å½•æ ‘æ ¹æ®æ¨¡åž‹ 2 è½¬æ¢ä¸ºæ•°æ®è¡¨ç¤ºã€‚

ç»ƒä¹  333. è®¾è®¡å‡½æ•° how-manyï¼Œè¯¥å‡½æ•°ç¡®å®šç»™å®š Dir.v2 åŒ…å«å¤šå°‘ä¸ªæ–‡ä»¶ã€‚ç»ƒä¹  332 æä¾›äº†æ•°æ®ç¤ºä¾‹ã€‚å°†ä½ çš„ç»“æžœä¸Ž ç»ƒä¹  331 çš„ç»“æžœè¿›è¡Œæ¯”è¾ƒã€‚

ç»ƒä¹  334. å±•ç¤ºå¦‚ä½•ä¸ºä¸€ä¸ªç›®å½•æ·»åŠ ä¸¤ä¸ªå±žæ€§ï¼šå¤§å°å’Œå¯è¯»æ€§ã€‚å‰è€…è¡¡é‡ç›®å½•æœ¬èº«ï¼ˆè€Œéžå…¶å†…å®¹ï¼‰å ç”¨çš„ç©ºé—´ï¼›åŽè€…æŒ‡å®šé™¤ç”¨æˆ·å¤–ï¼Œå…¶ä»–äººæ˜¯å¦å¯ä»¥æµè§ˆç›®å½•å†…å®¹ã€‚

ä¸Žç›®å½•ç±»ä¼¼ï¼Œæ–‡ä»¶ä¹Ÿæœ‰å±žæ€§ã€‚ä¸ºäº†å¼•å…¥è¿™äº›å±žæ€§ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸Šè¿°æ–¹æ³•è¿›è¡Œã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºæ–‡ä»¶å®šä¹‰ä¸€ä¸ªç»“æž„ï¼š

> ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â fileÂ [nameÂ sizeÂ content])

ç¬¬äºŒï¼Œæˆ‘ä»¬æä¾›æ•°æ®å®šä¹‰ï¼š

> | ;Â A File.v3 is a structure: |
> | --- |
> | ;Â Â Â (make-file  String  N  String) |

å¦‚å­—æ®µåç§°æ‰€ç¤ºï¼Œå­—ç¬¦ä¸²è¡¨ç¤ºæ–‡ä»¶çš„åç§°ï¼Œè‡ªç„¶æ•°è¡¨ç¤ºå…¶å¤§å°ï¼Œå­—ç¬¦ä¸²è¡¨ç¤ºå…¶å†…å®¹ã€‚æœ€åŽï¼Œè®©æˆ‘ä»¬å°†ç›®å½•çš„å†…å®¹å­—æ®µæ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šæ–‡ä»¶åˆ—è¡¨å’Œå­ç›®å½•åˆ—è¡¨ã€‚æ­¤æ›´æ”¹éœ€è¦ä¿®æ”¹ç»“æž„ç±»åž‹å®šä¹‰ï¼š

> ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â dir.v3Â [nameÂ dirsÂ files])

è¿™é‡Œæ˜¯ç²¾ç‚¼åŽçš„æ•°æ®å®šä¹‰ï¼š

> | ;Â A Dir.v3 is a structure: |
> | --- |
> | ;Â Â Â (make-dir.v3  String  Dir*  File*) |
> | Â  |
> | ;Â A Dir* is one of: |
> | ;Â â€“  '() |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Dir.v3  Dir*) |
> | Â  |
> | ;Â A File* is one of: |
> | ;Â â€“  '() |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  File.v3  File*) |

æŒ‰ç…§è®¡ç®—æœºç§‘å­¦ä¸­çš„æƒ¯ä¾‹ï¼Œåç§°æœ«å°¾ä½¿ç”¨ [*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) è¡¨ç¤ºâ€œå¤šä¸ªâ€ï¼Œå¹¶ä¸”æ˜¯åŒºåˆ†åç§°ä¸Žç±»ä¼¼åç§°çš„æ ‡è®°ï¼šFile.v3 å’Œ Dir.v3ã€‚

ç»ƒä¹  335. å°† å›¾ 123 ä¸­çš„ç›®å½•æ ‘è½¬æ¢ä¸ºæ¨¡åž‹ 3 çš„æ•°æ®è¡¨ç¤ºã€‚æ–‡ä»¶çš„å†…å®¹ä½¿ç”¨ "" è¡¨ç¤ºã€‚

ç»ƒä¹  336ã€‚è®¾è®¡å‡½æ•° how-manyï¼Œè¯¥å‡½æ•°ç¡®å®šç»™å®š Dir.v3 åŒ…å«å¤šå°‘ä¸ªæ–‡ä»¶ã€‚ç»ƒä¹  335 ä¸ºä½ æä¾›äº†æ•°æ®ç¤ºä¾‹ã€‚æ¯”è¾ƒä½ çš„ç»“æžœä¸Ž ç»ƒä¹  333 çš„ç»“æžœã€‚

è€ƒè™‘åˆ°æ•°æ®å®šä¹‰çš„å¤æ‚æ€§ï¼Œæ€è€ƒä»»ä½•äººå¦‚ä½•è®¾è®¡æ­£ç¡®çš„å‡½æ•°ã€‚ä¸ºä»€ä¹ˆä½ ç¡®ä¿¡ how-many äº§ç”Ÿæ­£ç¡®çš„ç»“æžœï¼Ÿ

ç»ƒä¹  337ã€‚ä½¿ç”¨ List-of ç®€åŒ–æ•°æ®å®šä¹‰ Dir.v3ã€‚ç„¶åŽä½¿ç”¨ ISL+ çš„åˆ—è¡¨å¤„ç†å‡½æ•°ä»Ž å›¾ 95 å’Œ 96 ç®€åŒ– ç»ƒä¹  336 çš„è§£å†³æ–¹æ¡ˆçš„å‡½æ•°å®šä¹‰ã€‚

ä»Žç¬¬ä¸€ä¸ªæ¨¡åž‹çš„ä¸€ä¸ªç®€å•è¡¨ç¤ºå¼€å§‹ï¼Œé€æ­¥æ”¹è¿›ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªç›¸å½“å‡†ç¡®çš„æ•°æ®è¡¨ç¤ºï¼Œç”¨äºŽç›®å½•æ ‘ã€‚äº‹å®žä¸Šï¼Œè¿™ä¸ªç¬¬ä¸‰ä¸ªæ•°æ®è¡¨ç¤ºæ¯”å‰ä¸¤ä¸ªæ›´å¿ å®žäºŽç›®å½•æ ‘çš„æœ¬è´¨ã€‚åŸºäºŽè¿™ä¸ªæ¨¡åž‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè®¸å¤šå…¶ä»–ç”¨æˆ·æœŸæœ›ä»Žè®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸­èŽ·å¾—çš„åŠŸèƒ½ã€‚

#### 20.3 ä¼˜åŒ–å‡½æ•°ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ä¸ºäº†ä½¿ä»¥ä¸‹ç»ƒä¹ æ›´å…·çŽ°å®žæ€§ï¼ŒDrRacket å°†æ¥è‡ªæœ¬ä¹¦ç¬¬ä¸€ç‰ˆçš„ dir.rkt æ•™å­¦åŒ…çš„ Add ([require](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._require%29%29)  htdp/dir) æ·»åŠ åˆ°å®šä¹‰åŒºåŸŸã€‚è¿™ä¸ªæ•™å­¦åŒ…ä»‹ç»äº†æ¨¡åž‹ 3 ä¸­çš„ä¸¤ç§ç»“æž„ç±»åž‹å®šä¹‰ï¼Œå°½ç®¡æ²¡æœ‰ .v3 åŽç¼€ã€‚æ­¤å¤–ï¼Œè¯¥æ•™å­¦åŒ…æä¾›äº†ä¸€ä¸ªåˆ›å»ºè®¡ç®—æœºä¸Šç›®å½•æ ‘è¡¨ç¤ºçš„å‡½æ•°ï¼š

> | ;Â String -> Dir.v3 |
> | --- |
> | ;Â åˆ›å»º a-path ç›®å½•çš„è¡¨ç¤º |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (create-dirÂ a-path)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |

ä¾‹å¦‚ï¼Œå¦‚æžœä½ æ‰“å¼€ DrRacket å¹¶å°†ä»¥ä¸‹ä¸‰è¡Œä»£ç è¾“å…¥åˆ°å®šä¹‰åŒºåŸŸï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â OÂ (create-dirÂ "/Users/..."))Â ;Â åœ¨ OS X ä¸Š |
> | --- |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â LÂ (create-dirÂ "/var/log/"))Â ;Â åœ¨ Linux ä¸Š |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â WÂ (create-dirÂ "C:\\Users\\..."))Â ;Â åœ¨ Windows ä¸Š |

åœ¨ä½ ä¿å­˜å¹¶è¿è¡Œç¨‹åºåŽï¼Œä½ ä¼šåœ¨è®¡ç®—æœºä¸Šå¾—åˆ°ç›®å½•çš„æ•°æ®è¡¨ç¤ºã€‚å®žé™…ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨`create-dir`å°†ä½ è®¡ç®—æœºä¸Šçš„æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿæ˜ å°„åˆ°`Dir.v3`çš„ä¸€ä¸ªå®žä¾‹ã€‚

è­¦å‘Šï¼ˆ1ï¼‰å¯¹äºŽå¤§åž‹ç›®å½•æ ‘ï¼ŒDrRacket å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´æ¥æž„å»ºè¡¨ç¤ºã€‚é¦–å…ˆåœ¨å°åž‹ç›®å½•æ ‘ä¸Šä½¿ç”¨`create-dir`ã€‚ï¼ˆ2ï¼‰ä¸è¦å®šä¹‰ä½ è‡ªå·±çš„ç›®å½•ç»“æž„ç±»åž‹ã€‚æ•™å­¦åŒ…å·²ç»å®šä¹‰äº†å®ƒä»¬ï¼Œå¹¶ä¸”ä½ ä¸èƒ½å®šä¹‰ç»“æž„ç±»åž‹ä¸¤æ¬¡ã€‚

è™½ç„¶`create-dir`åªæä¾›ç›®å½•æ ‘çš„è¡¨ç¤ºï¼Œä½†å®ƒè¶³å¤ŸçœŸå®žï¼Œå¯ä»¥è®©ä½ æ„Ÿå—åˆ°åœ¨é‚£ä¸ªçº§åˆ«è®¾è®¡ç¨‹åºçš„æ„Ÿè§‰ã€‚ä»¥ä¸‹ç»ƒä¹ è¯´æ˜Žäº†è¿™ä¸€ç‚¹ã€‚å®ƒä»¬ä½¿ç”¨`Dir`æ¥æŒ‡ä»£ç›®å½•æ ‘çš„æ•°æ®è¡¨ç¤ºçš„é€šç”¨æ¦‚å¿µã€‚è¯·ä½¿ç”¨æœ€ç®€å•çš„`Dir`æ•°æ®å®šä¹‰æ¥å®Œæˆç›¸åº”çš„ç»ƒä¹ ã€‚ä½ å¯ä»¥è‡ªç”±ä½¿ç”¨ç»ƒä¹  337 ä¸­çš„æ•°æ®å®šä¹‰ä»¥åŠå›¾ 95 å’Œ 96 ä¸­çš„å‡½æ•°ã€‚

ç»ƒä¹  338ã€‚ä½¿ç”¨`create-dir`å°†ä¸€äº›ç›®å½•è½¬æ¢ä¸º ISL+æ•°æ®è¡¨ç¤ºã€‚ç„¶åŽä½¿ç”¨ç»ƒä¹  336 ä¸­çš„`how-many`æ¥è®¡ç®—å®ƒä»¬åŒ…å«å¤šå°‘ä¸ªæ–‡ä»¶ã€‚ä¸ºä»€ä¹ˆä½ å¯¹`how-many`å¯¹è¿™äº›ç›®å½•äº§ç”Ÿæ­£ç¡®ç»“æžœæœ‰ä¿¡å¿ƒï¼Ÿ

ç»ƒä¹  339ã€‚è®¾è®¡`find?`å‡½æ•°ã€‚è¯¥å‡½æ•°æŽ¥å—ä¸€ä¸ª`Dir`å’Œä¸€ä¸ªæ–‡ä»¶åä½œä¸ºå‚æ•°ï¼Œå¹¶ç¡®å®šæ˜¯å¦åœ¨ç›®å½•æ ‘ä¸­å­˜åœ¨å…·æœ‰è¯¥åç§°çš„æ–‡ä»¶ã€‚

ç»ƒä¹  340ã€‚è®¾è®¡ä¸€ä¸ªåä¸º`ls`çš„å‡½æ•°ï¼Œå®ƒåˆ—å‡ºç»™å®š`Dir`ä¸­æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„åç§°ã€‚

ç»ƒä¹  341ã€‚è®¾è®¡ä¸€ä¸ªåä¸º`du`çš„å‡½æ•°ï¼Œå®ƒæŽ¥å—ä¸€ä¸ª`Dir`ä½œä¸ºå‚æ•°ï¼Œå¹¶è®¡ç®—æ•´ä¸ªç›®å½•æ ‘ä¸­æ‰€æœ‰æ–‡ä»¶çš„æ€»å¤§å°ã€‚å‡è®¾å°†ç›®å½•å­˜å‚¨åœ¨`Dir`ç»“æž„ä¸­éœ€è¦ 1 ä¸ªæ–‡ä»¶å­˜å‚¨å•ä½ã€‚åœ¨çŽ°å®žä¸–ç•Œä¸­ï¼Œç›®å½•åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ï¼Œå…¶å¤§å°å–å†³äºŽå…¶å…³è”çš„ç›®å½•å¤§å°ã€‚

å‰©ä½™çš„ç»ƒä¹ ä¾èµ–äºŽè·¯å¾„çš„æ¦‚å¿µï¼Œå¯¹äºŽæˆ‘ä»¬æ¥è¯´ï¼Œè·¯å¾„æ˜¯ä¸€ç³»åˆ—åç§°ï¼š

> | ;Â è·¯å¾„æ˜¯ [List-of  String]. |
> | --- |
> | ;Â å°†è§£é‡Šæ–¹å‘è½¬æ¢ä¸ºç›®å½•æ ‘ |

é‡æ–°å®¡è§† å›¾ 123ã€‚åœ¨è¯¥å›¾ä¸­ï¼Œä»Ž TS åˆ° part1 çš„è·¯å¾„æ˜¯ ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29) "TS" "Text" "part1")ã€‚åŒæ ·ï¼Œä»Ž TS åˆ° Code çš„è·¯å¾„æ˜¯ ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29) "TS" "Libs" "Code")ã€‚

ç»ƒä¹  342ï¼šè®¾è®¡ find å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªç›®å½• d å’Œä¸€ä¸ªæ–‡ä»¶å fã€‚å¦‚æžœ (find? d f) ä¸º #trueï¼Œåˆ™ find ç”Ÿæˆä¸€ä¸ªåä¸º f çš„æ–‡ä»¶çš„è·¯å¾„ï¼›å¦åˆ™å®ƒç”Ÿæˆ #falseã€‚

æç¤ºï¼šè™½ç„¶é¦–å…ˆæ£€æŸ¥æ–‡ä»¶åæ˜¯å¦å‡ºçŽ°åœ¨ç›®å½•æ ‘ä¸­å¾ˆæœ‰è¯±æƒ‘åŠ›ï¼Œä½†ä½ å¿…é¡»å¯¹æ¯ä¸ªå­ç›®å½•éƒ½è¿™æ ·åšã€‚å› æ­¤ï¼Œå°† find? å’Œ find çš„åŠŸèƒ½ç»“åˆèµ·æ¥ä¼šæ›´å¥½ã€‚

æŒ‘æˆ˜ï¼šfind å‡½æ•°åªå‘çŽ°äº† å›¾ 123 ä¸­åä¸º read! çš„ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„ä¸€ä¸ªã€‚è®¾è®¡ find-allï¼Œå®ƒæ³›åŒ– find å¹¶ç”Ÿæˆæ‰€æœ‰é€šå‘ d ä¸­ f çš„è·¯å¾„çš„åˆ—è¡¨ã€‚å½“ (find? d f) ä¸º #false æ—¶ï¼Œfind-all åº”è¯¥äº§ç”Ÿä»€ä¹ˆï¼Ÿè¿™ä¸ªé—®é¢˜ä¸ŽåŸºæœ¬é—®é¢˜ç›¸æ¯”ï¼Œè¿™éƒ¨åˆ†çœŸçš„æ˜¯ä¸€ä¸ªæŒ‘æˆ˜å—ï¼Ÿ

ç»ƒä¹  343ï¼šè®¾è®¡ ls-R å‡½æ•°ï¼Œè¯¥å‡½æ•°åˆ—å‡ºç»™å®š Dir ä¸­æ‰€æœ‰æ–‡ä»¶çš„è·¯å¾„ã€‚

ç»ƒä¹  344ï¼šä½¿ç”¨ ç»ƒä¹  343 ä¸­çš„ ls-R é‡æ–°è®¾è®¡ ç»ƒä¹  342 ä¸­çš„ find-allã€‚è¿™æ˜¯é€šè¿‡ç»„åˆè¿›è¡Œè®¾è®¡ï¼Œå¦‚æžœä½ è§£å†³äº† ç»ƒä¹  342 ä¸­çš„æŒ‘æˆ˜éƒ¨åˆ†ï¼Œä½ çš„æ–°å‡½æ•°ä¹Ÿå¯ä»¥æ‰¾åˆ°ç›®å½•ã€‚

### 21 ç²¾ç‚¼è§£é‡Šå™¨ðŸ”— "é“¾æŽ¥åˆ°è¿™é‡Œ")

DrRacket æ˜¯ä¸€ä¸ªç¨‹åºã€‚å®ƒæ˜¯ä¸€ä¸ªå¤æ‚çš„ç¨‹åºï¼Œå¤„ç†è®¸å¤šä¸åŒç±»åž‹çš„æ•°æ®ã€‚åƒå¤§å¤šæ•°å¤æ‚çš„ç¨‹åºä¸€æ ·ï¼ŒDrRacket ä¹Ÿç”±è®¸å¤šå‡½æ•°ç»„æˆï¼šä¸€ä¸ªå…è®¸ç¨‹åºå‘˜ç¼–è¾‘æ–‡æœ¬çš„å‡½æ•°ï¼Œå¦ä¸€ä¸ªå……å½“äº¤äº’åŒºåŸŸï¼Œç¬¬ä¸‰ä¸ªæ£€æŸ¥å®šä¹‰å’Œè¡¨è¾¾å¼æ˜¯å¦â€œè¯­æ³•æ­£ç¡®â€ï¼Œç­‰ç­‰ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å‘æ‚¨å±•ç¤ºå¦‚ä½•è®¾è®¡å®žçŽ°äº¤äº’åŒºåŸŸæ ¸å¿ƒåŠŸèƒ½çš„å‡½æ•°ã€‚è‡ªç„¶åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿­ä»£ç»†åŒ–æ¥å®Œæˆè¿™ä¸ªè®¾è®¡é¡¹ç›®ã€‚å®žé™…ä¸Šï¼Œä¸“æ³¨äºŽ DrRacket çš„è¿™ä¸ªæ–¹é¢çš„æƒ³æ³•æœ¬èº«å°±æ˜¯å¦ä¸€ä¸ªç»†åŒ–å®žä¾‹ï¼Œå³åªå®žçŽ°ä¸€ä¸ªåŠŸèƒ½éƒ¨ä»¶çš„æ˜Žæ˜¾å®žä¾‹ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œäº¤äº’åŒºåŸŸæ‰§è¡Œç¡®å®šä½ è¾“å…¥çš„è¡¨è¾¾å¼å€¼çš„ä»»åŠ¡ã€‚ç‚¹å‡»è¿è¡ŒåŽï¼Œäº¤äº’åŒºåŸŸäº†è§£æ‰€æœ‰å®šä¹‰ã€‚ç„¶åŽå®ƒå‡†å¤‡å¥½æŽ¥å—å¯èƒ½å¼•ç”¨è¿™äº›å®šä¹‰çš„è¡¨è¾¾å¼ï¼Œç¡®å®šè¿™ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰ç…§ä½ çš„æ„æ„¿é‡å¤è¿™ä¸ªå¾ªçŽ¯ã€‚å› æ­¤ï¼Œè®¸å¤šäººä¹Ÿå°†äº¤äº’åŒºåŸŸç§°ä¸ºè¯»å–-è¯„ä¼°-æ‰“å°å¾ªçŽ¯ï¼Œå…¶ä¸­ eval æ˜¯ evaluator çš„ç®€ç§°ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¹Ÿè¢«ç§°ä¸ºè§£é‡Šå™¨çš„å‡½æ•°ã€‚

å°±åƒè¿™æœ¬ä¹¦ä¸€æ ·ï¼Œæˆ‘ä»¬çš„ç²¾ç‚¼è¿‡ç¨‹ä»Žæ•°å€¼ BSL è¡¨è¾¾å¼å¼€å§‹ã€‚å®ƒä»¬å¾ˆç®€å•ï¼›å®ƒä»¬ä¸å‡è®¾å¯¹å®šä¹‰çš„ç†è§£ï¼›å³ä½¿ä½ çš„äº”å¹´çº§å¦¹å¦¹ä¹Ÿèƒ½ç¡®å®šå®ƒä»¬çš„å€¼ã€‚ä¸€æ—¦ä½ ç†è§£äº†è¿™ä¸ªç¬¬ä¸€æ­¥ï¼Œä½ å°±çŸ¥é“ BSL è¡¨è¾¾å¼ä¸Žå…¶è¡¨ç¤ºä¹‹é—´çš„åŒºåˆ«ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è½¬å‘å¸¦æœ‰å˜é‡çš„è¡¨è¾¾å¼ã€‚æœ€åŽä¸€æ­¥æ˜¯æ·»åŠ å®šä¹‰ã€‚

#### 21.1 è§£é‡Šè¡¨è¾¾å¼ðŸ”— "é“¾æŽ¥è‡³æ­¤")

æˆ‘ä»¬çš„é¦–è¦ä»»åŠ¡æ˜¯å°± BSL ç¨‹åºçš„è¡¨ç¤ºæ³•è¾¾æˆä¸€è‡´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¿…é¡»å¼„æ¸…æ¥šå¦‚ä½•å°†ä¸€ä¸ª BSL è¡¨è¾¾å¼è¡¨ç¤ºä¸º BSL æ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚èµ·åˆï¼Œè¿™å¬èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†å¹¶ä¸å›°éš¾ã€‚å‡è®¾æˆ‘ä»¬åªæ˜¯æƒ³è¡¨ç¤ºæ•°å­—ã€åŠ æ³•å’Œä¹˜æ³•ã€‚æ˜¾ç„¶ï¼Œæ•°å­—å¯ä»¥ä»£è¡¨æ•°å­—ã€‚ç„¶è€Œï¼ŒåŠ æ³•è¡¨è¾¾å¼éœ€è¦å¤åˆæ•°æ®ï¼Œå› ä¸ºå®ƒåŒ…å«ä¸¤ä¸ªè¡¨è¾¾å¼ï¼Œå¹¶ä¸”å®ƒä¸Žä¹˜æ³•è¡¨è¾¾å¼ä¸åŒï¼Œä¹˜æ³•è¡¨è¾¾å¼ä¹Ÿéœ€è¦æ•°æ®è¡¨ç¤ºã€‚

æ ¹æ®æ·»åŠ ç»“æž„ï¼Œè¡¨ç¤ºåŠ æ³•å’Œä¹˜æ³•çš„ä¸€ä¸ªç›´æŽ¥æ–¹æ³•æ˜¯ä¸ºæ¯ç§ç»“æž„ç±»åž‹å®šä¹‰ä¸¤ä¸ªå­—æ®µï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â addÂ [[left](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29)Â [right](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29)]) |
> | --- |
> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â mulÂ [[left](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29)Â [right](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29)]) |

ç›®çš„æ˜¯ï¼Œ[å·¦](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29) å­—æ®µåŒ…å«ä¸€ä¸ªæ“ä½œæ•°â€”â€”<wbr>ä½äºŽè¿ç®—ç¬¦â€œå·¦ä¾§â€çš„æ“ä½œæ•°â€”â€”<wbr>è€Œ [å³](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29) å­—æ®µåŒ…å«å¦ä¸€ä¸ªæ“ä½œæ•°ã€‚ä»¥ä¸‹è¡¨æ ¼å±•ç¤ºäº†ä¸‰ä¸ªç¤ºä¾‹ï¼š

> | BSL è¡¨è¾¾å¼ |  | BSL è¡¨è¾¾å¼çš„è¡¨ç¤º |
> | --- | --- | --- |
> | 3 |  | 3 |
> | ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) 1 1) |  | (make-add 1 1) |
> | ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 300001 100000) |  | (make-mul 300001 100000) |

æŽ¥ä¸‹æ¥çš„é—®é¢˜æ¶‰åŠå¸¦æœ‰å­è¡¨è¾¾å¼çš„è¡¨è¾¾å¼ï¼š

> ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 3 3) ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 4 4))

æƒŠäººçš„ç®€å•ç­”æ¡ˆæ˜¯ï¼Œå­—æ®µå¯ä»¥åŒ…å«ä»»ä½•å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ[å·¦](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29) å’Œ [å³](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29) å­—æ®µå¯ä»¥åŒ…å«è¡¨è¾¾å¼çš„è¡¨ç¤ºï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦åµŒå¥—åˆ°ä»»æ„æ·±åº¦ã€‚å‚è§ å›¾ 124 ä»¥èŽ·å–æ›´å¤šç¤ºä¾‹ã€‚

> > > | BSL è¡¨è¾¾å¼ |  | BSL è¡¨è¾¾å¼çš„è¡¨ç¤º |
> > > | --- | --- | --- |
> > > | ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 1 1) 10) |  | (make-add (make-mul 1 1) 10) |
> > > 
> > > |
> > > 
> > > &#124; ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 3 3) &#124;
> > > 
> > > &#124;   Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 4 4)) &#124;
> > > 
> > > |  |
> > > | --- |
> > > 
> > > &#124; (åŠ Â (ä¹˜Â 3Â 3) &#124;
> > > 
> > > &#124;Â Â Â Â Â Â Â Â Â (ä¹˜Â 4Â 4)) &#124;
> > > 
> > > |
> > > 
> > > |
> > > 
> > > &#124; ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â 1Â 2)Â 3) &#124;
> > > 
> > > &#124;Â Â Â Â Â Â (ä¹˜Â (ä¹˜Â ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â 1Â 1) &#124;
> > > 
> > > &#124;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 2) &#124;
> > > 
> > > &#124;Â Â Â Â Â Â Â Â Â 4)) &#124;
> > > 
> > > |  |
> > > | --- |
> > > 
> > > &#124; (åŠ Â (ä¹˜Â (åŠ Â 1Â 2)Â 3) &#124;
> > > 
> > > &#124;Â Â Â Â Â Â Â Â Â (ä¹˜Â (ä¹˜ &#124;
> > > 
> > > &#124;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (åŠ Â 1Â 1) &#124;
> > > 
> > > &#124;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 2) &#124;
> > > 
> > > &#124;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 4)) &#124;
> > > 
> > > |
> > > 
> å›¾Â 124: åœ¨ BSL ä¸­è¡¨ç¤º BSL è¡¨è¾¾å¼

ç»ƒä¹  345ã€‚æ ¹æ®åŠ æ³•å’Œä¹˜æ³•çš„ç»“æž„ç±»åž‹å®šä¹‰ï¼Œä¸º BSL è¡¨è¾¾å¼çš„è¡¨ç¤ºå½¢å¼åˆ¶å®šä¸€ä¸ªæ•°æ®å®šä¹‰ã€‚è®©æˆ‘ä»¬ç”¨ BSL-expr ç±»æ¯”ä¸º S-expr çš„æ–°æ•°æ®ç±»ã€‚

å°†ä»¥ä¸‹è¡¨è¾¾å¼è½¬æ¢ä¸ºæ•°æ®ï¼š

1.  ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)  10  -10)

1.  ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)  ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â 20Â 3)Â  33)

1.  ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)  ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)  3.14  ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)  2  3))  ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)  3.14  ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)  -1  -9)))

å°†ä»¥ä¸‹æ•°æ®è§£é‡Šä¸ºè¡¨è¾¾å¼ï¼š

1.  (make-add  -1  2)

1.  (make-add  (make-mul  -2  -3)  33) è¿™é‡Œâ€œè§£é‡Šâ€æ„å‘³ç€â€œå°†æ•°æ®è½¬æ¢ä¸ºä¿¡æ¯â€ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæœ¬ç« æ ‡é¢˜ä¸­çš„â€œè§£é‡Šå™¨â€æŒ‡çš„æ˜¯æ¶ˆè€—ç¨‹åºè¡¨ç¤ºå¹¶äº§ç”Ÿå…¶å€¼çš„ç¨‹åºã€‚è™½ç„¶è¿™ä¸¤ä¸ªæ¦‚å¿µç›¸å…³ï¼Œä½†å®ƒä»¬å¹¶ä¸ç›¸åŒã€‚

1.  (make-mul  (make-add  1  (make-mul  2  3))  3.14)

çŽ°åœ¨ä½ å·²ç»æœ‰äº† BSL ç¨‹åºçš„è¡¨ç¤ºï¼Œæ˜¯æ—¶å€™è®¾è®¡ä¸€ä¸ªè¯„ä¼°å™¨äº†ã€‚è¿™ä¸ªå‡½æ•°æ¶ˆè€— BSL è¡¨è¾¾å¼çš„è¡¨ç¤ºå¹¶äº§ç”Ÿå…¶å€¼ã€‚åŒæ ·ï¼Œè¿™ä¸ªå‡½æ•°ä¸Žä»»ä½•ä½ ä¹‹å‰è®¾è®¡çš„å‡½æ•°éƒ½ä¸åŒï¼Œå› æ­¤å°è¯•ä¸€äº›ç¤ºä¾‹ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ç®—æœ¯è§„åˆ™æ¥ç¡®å®šè¡¨è¾¾å¼çš„å€¼ï¼Œæˆ–è€…ä½ å¯ä»¥åœ¨ DrRacket çš„äº¤äº’åŒºåŸŸâ€œçŽ©è€â€ã€‚ä»¥ä¸‹è¡¨æ ¼å±•ç¤ºäº†æˆ‘ä»¬çš„ç¤ºä¾‹ï¼š

> | BSL è¡¨è¾¾å¼ |  | å…¶è¡¨ç¤º |  | å…¶å€¼ |
> | --- | --- | --- | --- | --- |
> | 3 |  | 3 |  | 3 |
> | ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â 1Â 1) |  | (make-addÂ 1Â 1) |  | 2 |
> | ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â 3Â 10) |  | (make-mulÂ 3Â 10) |  | 30 |
> | ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â 1Â 1)Â 10) |  | (make-addÂ (make-mulÂ 1Â 1)Â 10) |  | 11 |

ç»ƒä¹  346ã€‚ä¸º BSL è¡¨è¾¾å¼çš„è¡¨ç¤ºå¯ä»¥è¯„ä¼°çš„å€¼çš„ç±»åˆ«åˆ¶å®šä¸€ä¸ªæ•°æ®å®šä¹‰ã€‚

ç»ƒä¹  347ã€‚è®¾è®¡ eval-expression å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€— BSL è¡¨è¾¾å¼çš„è¡¨ç¤ºå¹¶è®¡ç®—å…¶å€¼ã€‚

ç»ƒä¹  348ã€‚ä¸ºä»Ž#trueã€#falseã€[and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)ã€[or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)å’Œ[not](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._not%29%29)æž„é€ çš„å¸ƒå°” BSL è¡¨è¾¾å¼å¼€å‘æ•°æ®è¡¨ç¤ºã€‚ç„¶åŽè®¾è®¡ eval-bool-expressionï¼Œå®ƒæ¶ˆè€—ï¼ˆè¡¨ç¤ºï¼‰å¸ƒå°” BSL è¡¨è¾¾å¼å¹¶è®¡ç®—å®ƒä»¬çš„å€¼ã€‚è¿™äº›å¸ƒå°”è¡¨è¾¾å¼ä¼šäº§ç”Ÿä»€ä¹ˆæ ·çš„å€¼ï¼Ÿ

ä¾¿åˆ©æ€§å’Œè§£æž S-expressions ä¸ºæˆ‘ä»¬ç¼–ç¨‹è¯­è¨€ä¸­è¡¨ç¤º BSL è¡¨è¾¾å¼æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼š

> | > ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) 1 1) |
> | --- |
> | 2 |
> | > '(+ 1 1) |
> | (list '+ 1 1) |
> | > ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 3 3) ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 4 4)) |
> | 25 |
> | > '(+ (* 3 3) (* 4 4)) |
> | (list '+ (list '* 3 3) (list '* 4 4)) |

é€šè¿‡åœ¨è¡¨è¾¾å¼å‰ç®€å•åœ°åŠ ä¸Šå¼•å·ï¼Œæˆ‘ä»¬å¾—åˆ° ISL+æ•°æ®ã€‚

è§£é‡Š S-expression è¡¨ç¤ºæ˜¯ç¬¨æ‹™çš„ï¼Œä¸»è¦æ˜¯å› ä¸ºå¹¶éžæ‰€æœ‰ S-expression éƒ½ä»£è¡¨ BSL-exprsã€‚ä¾‹å¦‚ï¼Œ#trueã€"hello"å’Œ'(+ x 1)éƒ½ä¸æ˜¯ BSL è¡¨è¾¾å¼çš„è¡¨ç¤ºã€‚å› æ­¤ï¼ŒS-expressions å¯¹äºŽè§£é‡Šå™¨çš„å¼€å‘è€…æ¥è¯´éžå¸¸ä¸æ–¹ä¾¿ã€‚

ç¨‹åºå‘˜å‘æ˜Žäº†è§£æžå™¨æ¥å¼¥åˆä½¿ç”¨ä¾¿åˆ©æ€§å’Œå®žçŽ°ä¹‹é—´çš„å·®è·ã€‚è§£æžå™¨åŒæ—¶æ£€æŸ¥æŸäº›æ•°æ®æ˜¯å¦ç¬¦åˆæ•°æ®å®šä¹‰ï¼Œå¦‚æžœç¬¦åˆï¼Œåˆ™ä»Žæ‰€é€‰æ•°æ®ç±»ä¸­æž„å»ºä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ã€‚åŽè€…ç§°ä¸ºè§£æžæ ‘ã€‚å¦‚æžœç»™å®šçš„æ•°æ®ä¸ç¬¦åˆï¼Œè§£æžå™¨ä¼šå‘å‡ºé”™è¯¯ä¿¡å·ï¼Œå°±åƒæ¥è‡ªè¾“å…¥é”™è¯¯çš„æ£€æŸ¥å‡½æ•°ä¸€æ ·ã€‚

å›¾ 125 å±•ç¤ºäº† S-expressions çš„ BSL è§£æžå™¨ã€‚å…·ä½“æ¥è¯´ï¼Œparse æ¶ˆè€—ä¸€ä¸ª S-expr å¹¶äº§ç”Ÿä¸€ä¸ª BSL-exprâ€”â€”å¦‚æžœä¸”ä»…å½“ç»™å®šçš„ S-expression æ˜¯å¼•ç”¨ä¸€ä¸ªå…·æœ‰ BSL-expr è¡¨ç¤ºçš„ BSL è¡¨è¾¾å¼çš„ç»“æžœã€‚

ç»ƒä¹  349. ä¸º parse åˆ›å»ºæµ‹è¯•ï¼Œç›´åˆ° DrRacket å‘Šè¯‰ä½ æµ‹è¯•è¿è¡ŒæœŸé—´å®šä¹‰åŒºåŸŸä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è¢«è¦†ç›–ã€‚

ç»ƒä¹  350. ä¸Žè®¾è®¡é…æ–¹ç›¸æ¯”ï¼Œè¿™ä¸ªç¨‹åºçš„å®šä¹‰æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„ï¼Ÿ

ç»ƒä¹  351. è®¾è®¡ interpreter-expr å‡½æ•°ã€‚è¯¥å‡½æ•°æŽ¥å— S è¡¨è¾¾å¼ã€‚å¦‚æžœ parse å°†å…¶è¯†åˆ«ä¸º BSL-exprï¼Œåˆ™äº§ç”Ÿå®ƒä»¬çš„å€¼ã€‚å¦åˆ™ï¼Œå®ƒå‘å‡ºä¸Ž parse ç›¸åŒçš„é”™è¯¯ã€‚

> > > |   ;Â S-expr -> BSL-expr |
> > > | --- |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (parseÂ s) |
> > > |   |Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   |Â Â Â [(atom?Â s)Â (parse-atomÂ s)] |
> > > |   |Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â (parse-slÂ s)])) |
> > > |   |   |
> > > |   ;Â SL -> BSL-expr |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (parse-slÂ s) |
> > > |   |Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   |Â Â Â [([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â (consists-of-3Â s)Â ([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â s))) |
> > > |   |Â Â Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > |   ([([symbol=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â s)Â '+) |
> > > |   |Â Â Â Â Â Â Â (make-addÂ (parseÂ ([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29)Â s))Â (parseÂ ([third](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._third%29%29)Â s)))] |
> > > | Â Â Â Â Â Â Â ([symbol=?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â s)Â '*) |
> > > | Â Â Â Â Â Â Â Â ([make-mul](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-mul%29%29)Â ([parse](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._parse%29%29)Â ([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29)Â s))Â ([parse](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._parse%29%29)Â ([third](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._third%29%29)Â s)))] |
> > > | Â Â Â Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â WRONG)])] |
> > > | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â WRONG)])) |
> > > | Â  |
> > > | ;Â åŽŸå­ -> BSL-è¡¨è¾¾å¼ |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (parse-atomÂ s) |
> > > | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â ([number?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._number~3f%29%29)Â s)Â s] |
> > > | ([string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)Â s)Â ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â WRONG)] |
> > > | Â Â Â Â ([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)Â s)Â ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â WRONG)) |
> > > | Â  |
> > > | ;Â SL -> å¸ƒå°” |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (consists-of-3Â s) |
> > > | |Â Â Â Â Â Â ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â s)Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â s))Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â s))) |
> > > | |Â Â Â Â Â Â ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â s)))))) |
> > > 
> å›¾Â 125ï¼šä»Ž S-expr åˆ° BSL-expr

#### 21.2 è§£é‡Šå˜é‡ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ç”±äºŽç¬¬ä¸€éƒ¨åˆ†å¿½ç•¥äº†å¸¸é‡å®šä¹‰ï¼Œå¦‚æžœè¡¨è¾¾å¼ä¸­åŒ…å«å˜é‡ï¼Œåˆ™è¯¥è¡¨è¾¾å¼æ²¡æœ‰å€¼ã€‚ç¡®å®žï¼Œé™¤éžæˆ‘ä»¬çŸ¥é“ x ä»£è¡¨ä»€ä¹ˆï¼Œå¦åˆ™è¯„ä¼° ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) 3  x) æ²¡æœ‰æ„ä¹‰ã€‚å› æ­¤ï¼Œè¯„ä¼°å™¨çš„ç¬¬ä¸€ä¸ªæ”¹è¿›æ˜¯å‘æˆ‘ä»¬è¦è¯„ä¼°çš„è¡¨è¾¾å¼ä¸­æ·»åŠ å˜é‡ã€‚å‡è®¾å®šä¹‰åŒºåŸŸåŒ…å«å¦‚ä¸‹å®šä¹‰

> ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â xÂ 5)

å¹¶ä¸”ç¨‹åºå‘˜åœ¨äº¤äº’åŒºåŸŸè¯„ä¼°åŒ…å« x çš„è¡¨è¾¾å¼ï¼š

> | > x |
> | --- |
> | 5 |
> | > ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â xÂ 3) |
> | 8 |
> | > ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â 1/2Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â xÂ 3)) |
> | 7.5 |

äº‹å®žä¸Šï¼Œä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªç¬¬äºŒä¸ªå®šä¹‰ï¼Œæ¯”å¦‚è¯´ ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)  y  3)ï¼Œä»¥åŠæ¶‰åŠä¸¤ä¸ªå˜é‡çš„äº¤äº’ï¼š

> |
> 
> &#124; > ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â xÂ x) &#124;
> 
> &#124;Â Â Â Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â yÂ y)) &#124;
> 
> |
> 
> | 34 |
> | --- |

å‰ä¸€èŠ‚éšå«åœ°æå‡ºå°†ç¬¦å·ä½œä¸ºå˜é‡çš„è¡¨ç¤ºã€‚æ¯•ç«Ÿï¼Œå¦‚æžœä½ é€‰æ‹©å¼•ç”¨ S è¡¨è¾¾å¼æ¥è¡¨ç¤ºå¸¦æœ‰å˜é‡çš„è¡¨è¾¾å¼ï¼Œç¬¦å·å°±ä¼šè‡ªç„¶å‡ºçŽ°ï¼š

> | > 'x |
> | --- |
> | 'x |
> | > '(*Â 1/2Â (*Â xÂ 3)) |
> | (list '* 0.5 (list '* 'x 3)) |

ä¸€ä¸ªæ˜Žæ˜¾çš„æ›¿ä»£æ–¹æ¡ˆæ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ · "x" å°±ä»£è¡¨ xï¼Œä½†æœ¬ä¹¦ä¸æ˜¯å…³äºŽè®¾è®¡è§£é‡Šå™¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åšæŒä½¿ç”¨ç¬¦å·ã€‚ä»Žè¿™ä¸ªå†³å®šä¸­ï¼Œå¯ä»¥æŽ¨æ–­å‡ºå¦‚ä½•ä¿®æ”¹ä»Ž ç»ƒä¹  345 çš„æ•°æ®å®šä¹‰ï¼š

> | ;Â ä¸€ä¸ª BSL-å˜é‡è¡¨è¾¾å¼å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š |
> | --- |
> | ;Â â€“ æ•°å­— |
> | ;Â â€“ ç¬¦å· |
> | ;Â â€“ (make-add  BSL-å˜é‡è¡¨è¾¾å¼  BSL-å˜é‡è¡¨è¾¾å¼) |
> | ;Â â€“ (make-mul  BSL-å˜é‡è¡¨è¾¾å¼  BSL-å˜é‡è¡¨è¾¾å¼) |

æˆ‘ä»¬åªéœ€åœ¨æ•°æ®å®šä¹‰ä¸­æ·»åŠ ä¸€æ¡è§„åˆ™ã€‚è‡³äºŽæ•°æ®ç¤ºä¾‹ï¼Œä¸‹è¡¨å±•ç¤ºäº†å¸¦æœ‰å˜é‡çš„ BSL è¡¨è¾¾å¼åŠå…¶ BSL-å˜é‡è¡¨è¾¾å¼ è¡¨ç¤ºï¼š

> | BSL è¡¨è¾¾å¼ |  | BSL è¡¨è¾¾å¼çš„è¡¨ç¤º |
> | --- | --- | --- |
> | x |  | 'x |
> | ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)Â xÂ 3) |  | (make-addÂ 'xÂ 3) |
> | ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â 1/2Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â xÂ 3)) |  | (make-mulÂ 1/2Â (make-mulÂ 'xÂ 3)) |
> 
> |
> 
> &#124; ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 'x 'x) &#124;
> 
> &#124; ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) y y)) &#124;
> 
> |  |
> | --- |
> 
> &#124; ([make-add](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-add%29%29) ([make-mul](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-mul%29%29) 'x 'x) &#124;
> 
> &#124; ([make-mul](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-mul%29%29) 'y 'y)) &#124;
> 
> |

å®ƒä»¬éƒ½æ¥è‡ªä¸Šé¢çš„äº¤äº’ï¼Œè¿™æ„å‘³ç€ä½ çŸ¥é“å½“ x æ˜¯ 5 ä¸” y æ˜¯ 3 æ—¶çš„ç»“æžœã€‚

ç¡®å®šå˜é‡è¡¨è¾¾å¼å€¼çš„ä¸€ç§æ–¹æ³•æ˜¯å°†æ‰€æœ‰å˜é‡æ›¿æ¢ä¸ºå®ƒä»¬æ‰€ä»£è¡¨çš„å€¼ã€‚è¿™æ˜¯ä½ åœ¨å­¦æ ¡æ•°å­¦è¯¾ä¸Šæ‰€çŸ¥é“çš„æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œå…¨åˆé€‚çš„æ–¹æ³•ã€‚

ç»ƒä¹  352ã€‚è®¾è®¡å­å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ª BSL-var-expr è¡¨è¾¾å¼ã€ä¸€ä¸ª Symbol x å’Œä¸€ä¸ª Number vã€‚å®ƒäº§ç”Ÿä¸€ä¸ªåƒ ex ä¸€æ ·çš„ BSL-var-exprï¼Œå…¶ä¸­æ‰€æœ‰ x çš„å‡ºçŽ°éƒ½è¢« v æ›¿æ¢ã€‚

ç»ƒä¹  353ã€‚è®¾è®¡ numeric?å‡½æ•°ã€‚å®ƒç¡®å®šä¸€ä¸ª BSL-var-expr æ˜¯å¦ä¹Ÿæ˜¯ä¸€ä¸ª BSL-exprã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾ä½ å¯¹ç»ƒä¹  345 çš„è§£å†³æ–¹æ¡ˆæ˜¯ BSL-var-expr çš„å®šä¹‰ï¼Œæ²¡æœ‰ Symbolsã€‚

ç»ƒä¹  354ã€‚è®¾è®¡ eval-variableã€‚æ£€æŸ¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ª BSL-var-expr å¹¶ç¡®å®šå…¶å€¼ï¼Œå¦‚æžœ numeric?å¯¹è¾“å…¥è¿”å›ž trueã€‚å¦åˆ™ï¼Œå®ƒå‘å‡ºé”™è¯¯ä¿¡å·ã€‚

é€šå¸¸ï¼Œä¸€ä¸ªç¨‹åºåœ¨å®šä¹‰åŒºåŸŸä¸­å®šä¹‰äº†è®¸å¤šå¸¸é‡ï¼Œè¡¨è¾¾å¼åŒ…å«å¤šä¸ªå˜é‡ã€‚ä¸ºäº†è¯„ä¼°è¿™æ ·çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŒ…å«ä¸€ç³»åˆ—å¸¸é‡å®šä¹‰æ—¶å®šä¹‰åŒºåŸŸçš„è¡¨ç¤ºã€‚å¯¹äºŽè¿™ä¸ªç»ƒä¹ ï¼Œæˆ‘ä»¬ä½¿ç”¨å…³è”åˆ—è¡¨ï¼š

> | ; ALï¼ˆå…³è”åˆ—è¡¨çš„ç®€ç§°ï¼‰æ˜¯[List-of Association]]ã€‚ |
> | --- |
> | ; ä¸€ä¸ªå…³è”åˆ—è¡¨æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼š |
> | ; ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) Symbol ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) Number '()))) |

æž„é€  AL çš„å…ƒç´ ã€‚

è®¾è®¡ eval-variable* å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ª BSL-var-expr ex å’Œä¸€ä¸ªå…³è”åˆ—è¡¨ daã€‚ä»Ž ex å¼€å§‹ï¼Œå®ƒè¿­ä»£åœ°å°† subst åº”ç”¨åˆ° da ä¸­çš„æ‰€æœ‰å…³è”ä¸­ã€‚å¦‚æžœç»“æžœä¸º numeric?ï¼Œåˆ™ç¡®å®šå…¶å€¼ï¼›å¦åˆ™ï¼Œå®ƒå‘å‡ºä¸Ž eval-variable ç›¸åŒçš„é”™è¯¯ä¿¡å·ã€‚æç¤ºï¼šå°†ç»™å®šçš„ BSL-var-expr è§†ä¸ºä¸€ä¸ªåŽŸå­å€¼ï¼Œå¹¶éåŽ†ç»™å®šçš„å…³è”åˆ—è¡¨ã€‚æˆ‘ä»¬æä¾›è¿™ä¸ªæç¤ºï¼Œå› ä¸ºåˆ›å»ºæ­¤å‡½æ•°éœ€è¦ä»Ž Simultaneous Processing ä¸­èŽ·å¾—ä¸€ç‚¹è®¾è®¡çŸ¥è¯†ã€‚

çŽ¯å¢ƒæ¨¡åž‹ ç»ƒä¹  354 ä¾èµ–äºŽå¯¹å¸¸é‡å®šä¹‰çš„æ•°å­¦ç†è§£ã€‚å¦‚æžœä¸€ä¸ªåç§°è¢«å®šä¹‰ä¸ºä»£è¡¨æŸä¸ªå€¼ï¼Œé‚£ä¹ˆè¯¥åç§°çš„æ‰€æœ‰å‡ºçŽ°éƒ½å¯ä»¥ç”¨è¯¥å€¼æ›¿æ¢ã€‚æ›¿æ¢åœ¨è¯„ä¼°è¿‡ç¨‹å¼€å§‹ä¹‹å‰ä¸€æ¬¡æ€§å®Œæˆè¿™ä¸ªæ›¿æ¢ã€‚

ä¸€ç§æ›¿ä»£æ–¹æ³•ï¼Œè¢«ç§°ä¸ºçŽ¯å¢ƒæ¨¡åž‹ï¼Œæ˜¯åœ¨éœ€è¦æ—¶æŸ¥æ‰¾å˜é‡çš„å€¼ã€‚è¯„ä¼°å™¨ç«‹å³å¼€å§‹å¤„ç†è¡¨è¾¾å¼ï¼Œä½†åŒæ—¶ä¹Ÿæºå¸¦å®šä¹‰åŒºåŸŸçš„è¡¨ç¤ºã€‚æ¯æ¬¡è¯„ä¼°å™¨é‡åˆ°ä¸€ä¸ªå˜é‡æ—¶ï¼Œå®ƒéƒ½ä¼šåœ¨å®šä¹‰åŒºåŸŸä¸­æŸ¥æ‰¾å…¶å€¼å¹¶ä½¿ç”¨å®ƒã€‚

ç»ƒä¹  355ã€‚è®¾è®¡ eval-var-lookup å‡½æ•°ã€‚æ­¤å‡½æ•°ä¸Ž eval-variable* å…·æœ‰ç›¸åŒçš„ç­¾åï¼š

> | ;Â BSL-var-expr  AL -> Number |
> | --- |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (eval-var-lookupÂ [e](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._e%29%29)da)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |

è¯¥å‡½æ•°ä¸æ˜¯ä½¿ç”¨æ›¿æ¢ï¼Œè€Œæ˜¯æŒ‰ç…§ BSL-var-expr çš„è®¾è®¡é£Ÿè°±éåŽ†è¡¨è¾¾å¼ã€‚åœ¨éåŽ†è¡¨è¾¾å¼æ—¶ï¼Œå®ƒâ€œæºå¸¦â€ç€ daã€‚å½“å®ƒé‡åˆ°ç¬¦å· x æ—¶ï¼Œå®ƒä½¿ç”¨ [assq](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._assq%29%29) åœ¨å…³è”åˆ—è¡¨ä¸­æŸ¥æ‰¾ x çš„å€¼ã€‚å¦‚æžœæ²¡æœ‰å€¼ï¼Œeval-var-lookup ä¼šå‘å‡ºé”™è¯¯ä¿¡å·ã€‚

#### 21.3 è§£é‡Šå‡½æ•°ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»äº†è§£äº†å¦‚ä½•è¯„ä¼°ç”±å¸¸é‡å®šä¹‰å’Œå˜é‡è¡¨è¾¾å¼ç»„æˆçš„ BSL ç¨‹åºã€‚è‡ªç„¶åœ°ï¼Œä½ æƒ³è¦æ·»åŠ å‡½æ•°å®šä¹‰ï¼Œè¿™æ ·ä½ è‡³å°‘åœ¨åŽŸåˆ™ä¸ŠçŸ¥é“å¦‚ä½•å¤„ç†æ‰€æœ‰çš„ BSLã€‚

æœ¬èŠ‚çš„ç›®æ ‡æ˜¯æ”¹è¿› è§£é‡Šå˜é‡ çš„è¯„ä¼°å™¨ï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†å‡½æ•°ã€‚ç”±äºŽå‡½æ•°å®šä¹‰å‡ºçŽ°åœ¨å®šä¹‰åŒºåŸŸï¼Œå¦ä¸€ç§æè¿°æ”¹è¿›çš„è¯„ä¼°å™¨çš„æ–¹å¼æ˜¯è¯´ï¼Œå½“å®šä¹‰åŒºåŸŸåŒ…å«å¤šä¸ªå‡½æ•°å®šä¹‰æ—¶ï¼Œå®ƒæ¨¡æ‹Ÿ DrRacketï¼Œå½“ç¨‹åºå‘˜åœ¨äº¤äº’åŒºåŸŸè¾“å…¥åŒ…å«è¿™äº›å‡½æ•°ä½¿ç”¨çš„è¡¨è¾¾å¼æ—¶ã€‚

ä¸ºäº†ç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬å‡è®¾å®šä¹‰åŒºåŸŸä¸­çš„æ‰€æœ‰å‡½æ•°éƒ½æ¶ˆè€—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªè¿™æ ·çš„å®šä¹‰ã€‚å¿…è¦çš„é¢†åŸŸçŸ¥è¯†å¯ä»¥è¿½æº¯åˆ°ä½ åœ¨å­¦æ ¡å­¦ä¹ æ—¶ï¼Œä½ äº†è§£åˆ° f(x) = e ä»£è¡¨å‡½æ•° f çš„å®šä¹‰ï¼Œf(a) ä»£è¡¨å°† f åº”ç”¨åˆ° a ä¸Šï¼Œå¹¶ä¸”ä¸ºäº†è¯„ä¼°åŽè€…ï¼Œä½ å°† a æ›¿æ¢ä¸º e ä¸­çš„ xã€‚å®žé™…ä¸Šï¼Œåœ¨ BSL è¿™æ ·çš„è¯­è¨€ä¸­ï¼Œå‡½æ•°åº”ç”¨çš„è¯„ä¼°ä¹Ÿå¤§è‡´å¦‚æ­¤ã€‚

åœ¨è§£å†³ä»¥ä¸‹ç»ƒä¹ ä¹‹å‰ï¼Œä½ å¯èƒ½å¸Œæœ›å¤ä¹ ä¸€ä¸‹ç¬¬ä¸€éƒ¨åˆ†ä¸­å…³äºŽå‡½æ•°çš„æœ¯è¯­ã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œä»£æ•°è¯¾ç¨‹ä¼šå¿½ç•¥æ•°å­¦çš„è¿™ä¸€æ–¹é¢ï¼Œä½†å½“ä½ å¸Œæœ›è§£å†³è¿™äº›é—®é¢˜æ—¶ï¼Œç²¾ç¡®çš„æœ¯è¯­ä½¿ç”¨å’Œç†è§£æ˜¯å¿…è¦çš„ã€‚

ç»ƒä¹  356ã€‚æ‰©å±• è§£é‡Šå˜é‡ çš„æ•°æ®è¡¨ç¤ºï¼Œä»¥åŒ…æ‹¬ç¨‹åºå‘˜å®šä¹‰çš„å‡½æ•°çš„åº”ç”¨ã€‚å›žæƒ³ä¸€ä¸‹ï¼Œå‡½æ•°åº”ç”¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ªåç§°å’Œä¸€ä¸ªè¡¨è¾¾å¼ã€‚å‰è€…æ˜¯åº”ç”¨åˆ°çš„å‡½æ•°çš„åç§°ï¼›åŽè€…æ˜¯å‚æ•°ã€‚

è¡¨ç¤ºä»¥ä¸‹è¡¨è¾¾å¼ï¼šï¼ˆk  ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)  1  1))ï¼Œ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)  5  (k  ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)  1  1)))ï¼Œ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)  (i  5)  (k  ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)  1  1)))ã€‚æˆ‘ä»¬å°†è¿™ä¸ªæ–°å®šä¹‰çš„æ•°æ®ç±»åˆ«ç§°ä¸º BSL-fun-exprã€‚

ç»ƒä¹  357ã€‚è®¾è®¡ eval-definition1ã€‚è¯¥å‡½æ•°æŽ¥å—å››ä¸ªå‚æ•°ï¼š

1.  ä¸€ä¸ª BSL-fun-expr exï¼›

1.  ä¸€ä¸ªç¬¦å· fï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå‡½æ•°åï¼›

1.  ä¸€ä¸ªç¬¦å· xï¼Œå®ƒä»£è¡¨å‡½æ•°çš„å‚æ•°ï¼›ä»¥åŠ

1.  ä¸€ä¸ª BSL-fun-expr bï¼Œå®ƒä»£è¡¨å‡½æ•°çš„ä¸»ä½“ã€‚

å®ƒç¡®å®š ex çš„å€¼ã€‚å½“ eval-definition1 é‡åˆ°å¯¹ f çš„æŸä¸ªå‚æ•°çš„åº”ç”¨æ—¶ï¼Œ

1.  è¯„ä¼°å‚æ•°ï¼Œ

1.  å°†å‚æ•°çš„å€¼æ›¿æ¢ä¸º b ä¸­çš„ xï¼›

1.  æœ€åŽä½¿ç”¨ eval-definition1 è¯„ä¼°ç»“æžœè¡¨è¾¾å¼ã€‚

è¿™é‡Œæ˜¯å¦‚ä½•å°†æ­¥éª¤è¡¨ç¤ºä¸ºä»£ç çš„ç¤ºä¾‹ï¼Œå‡è®¾ arg æ˜¯å‡½æ•°åº”ç”¨çš„å‚æ•°ï¼š

> | ([å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) value (è¯„ä¼°å®šä¹‰ 1 arg f x b))) |
> | --- |
> | |Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) plugd (æ›¿æ¢ b x value))) |
> | |Â Â Â (è¯„ä¼°å®šä¹‰ 1 plugd f x b)) |

æ³¨æ„åˆ°è¿™ä¸€è¡Œä½¿ç”¨äº†å°šæœªä»‹ç»è¿‡çš„é€’å½’å½¢å¼ã€‚æ­¤ç±»å‡½æ•°çš„é€‚å½“è®¾è®¡åœ¨ç”Ÿæˆé€’å½’ä¸­è®¨è®ºã€‚

å¦‚æžœ eval-definition1 é‡åˆ°å˜é‡ï¼Œå®ƒå°†å‘å‡ºä¸Žç»ƒä¹  354 ä¸­çš„ eval-variable ç›¸åŒçš„é”™è¯¯ã€‚å®ƒè¿˜ä¼šå¯¹å¼•ç”¨é™¤ f ä¹‹å¤–çš„å…¶ä»–å‡½æ•°åçš„å‡½æ•°åº”ç”¨å‘å‡ºé”™è¯¯ã€‚

è­¦å‘Šï¼šä½¿ç”¨è¿™ç§æœªå‘çŽ°çš„é€’å½’å½¢å¼å°†å¼•å…¥ä½ çš„è®¡ç®—ä¸­çš„ä¸€ä¸ªæ–°å…ƒç´ ï¼šéžç»ˆæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå¯èƒ½æ°¸è¿œè¿è¡Œè€Œä¸æ˜¯æä¾›ç»“æžœæˆ–å‘å‡ºé”™è¯¯ã€‚å¦‚æžœä½ éµå¾ªäº†å‰å››éƒ¨åˆ†çš„è®¾è®¡é£Ÿè°±ï¼Œä½ ä¸èƒ½ç¼–å†™è¿™æ ·çš„ç¨‹åºã€‚ä¸ºäº†å¥½çŽ©ï¼Œæž„é€ ä¸€ä¸ªè¾“å…¥ï¼Œä½¿ eval-definition1 æ— é™æœŸè¿è¡Œã€‚ä½¿ç”¨ STOP æ¥ç»ˆæ­¢ç¨‹åºã€‚

å¯¹äºŽæ¨¡æ‹Ÿäº¤äº’åŒºåŸŸçš„è¯„ä¼°å™¨ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰åŒºåŸŸçš„ä¸€ä¸ªè¡¨ç¤ºã€‚æˆ‘ä»¬å‡è®¾å®ƒæ˜¯ä¸€ä¸ªå®šä¹‰åˆ—è¡¨ã€‚

ç»ƒä¹  358ã€‚æä¾›ä¸€ä¸ªç»“æž„ç±»åž‹å’Œæ•°æ®å®šä¹‰ç”¨äºŽå‡½æ•°å®šä¹‰ã€‚å›žæƒ³ä¸€ä¸‹ï¼Œæ­¤ç±»å®šä¹‰æœ‰ä¸‰ä¸ªåŸºæœ¬å±žæ€§ï¼š

1.  å‡½æ•°çš„åç§°ï¼Œå®ƒç”¨ç¬¦å·è¡¨ç¤ºï¼›

1.  å‡½æ•°çš„å‚æ•°ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªåç§°ï¼›å¹¶ä¸”

1.  å‡½æ•°çš„ä¸»ä½“ï¼Œå®ƒæ˜¯ä¸€ä¸ªå˜é‡è¡¨è¾¾å¼ã€‚

æˆ‘ä»¬ä½¿ç”¨ BSL-fun-def æ¥æŒ‡ä»£æ­¤ç±»æ•°æ®ã€‚ä½¿ç”¨ä½ çš„æ•°æ®å®šä¹‰æ¥è¡¨ç¤ºè¿™äº› BSL å‡½æ•°å®šä¹‰ï¼š

1.  ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (f x) ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29) 3 x))

1.  ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (g y) (f ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) 2 y)))

1.  ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)  (h  v)  ([+](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29)  (f  v)  (g  v)))

æŽ¥ä¸‹æ¥ï¼Œå®šä¹‰ç±» BSL-fun-def*æ¥è¡¨ç¤ºç”±å¤šä¸ªå•å‚æ•°å‡½æ•°å®šä¹‰ç»„æˆçš„å®šä¹‰åŒºåŸŸã€‚å°†å®šä¹‰ fã€g å’Œ h çš„å®šä¹‰åŒºåŸŸè½¬æ¢ä¸ºä½ çš„æ•°æ®è¡¨ç¤ºï¼Œå¹¶å‘½åä¸º da-fghã€‚

æœ€åŽï¼Œç€æ‰‹ä»¥ä¸‹æ„¿æœ›ï¼š

> | ;Â BSL-fun-def*  Symbol -> BSL-fun-def |
> | --- |
> | ;Â åœ¨ da ä¸­æ£€ç´¢ f çš„å®šä¹‰ |
> | ;Â å¦‚æžœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™å‘å‡ºé”™è¯¯ä¿¡å· |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (lookup-defÂ da-fghÂ 'g)Â g) |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (lookup-defÂ daÂ f)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |

åœ¨è¯„ä¼°åº”ç”¨æ—¶éœ€è¦æŸ¥æ‰¾å®šä¹‰ã€‚

ç»ƒä¹  359ã€‚è®¾è®¡ eval-function*å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€— exï¼Œä¸€ä¸ª BSL-fun-expr è¡¨è¾¾å¼ï¼Œä»¥åŠ daï¼Œä¸€ä¸ªè¡¨ç¤ºå®šä¹‰åŒºåŸŸçš„ BSL-fun-def*è¡¨ç¤ºã€‚å¦‚æžœå®šä¹‰åŒºåŸŸåŒ…å« daï¼Œå®ƒå°†äº§ç”Ÿ DrRacket åœ¨äº¤äº’åŒºåŸŸä¸­è¯„ä¼° ex æ—¶æ˜¾ç¤ºçš„ç»“æžœã€‚

è¯¥å‡½æ•°çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºŽç»ƒä¹  357 ä¸­çš„ eval-definition1ã€‚å¯¹äºŽæŸä¸ªå‡½æ•° f çš„åº”ç”¨ï¼Œå®ƒ

1.  è¯„ä¼°å‚æ•°ï¼›

1.  åœ¨ da çš„ BSL-fun-def è¡¨ç¤ºä¸­æŸ¥æ‰¾ f çš„å®šä¹‰ï¼Œè¯¥è¡¨ç¤ºåŒ…å«å‚æ•°å’Œä¸»ä½“ï¼›

1.  å°†å‚æ•°çš„å€¼æ›¿æ¢ä¸ºå‡½æ•°ä¸»ä½“ä¸­çš„å‡½æ•°å‚æ•°ï¼›ç„¶åŽ

1.  é€šè¿‡é€’å½’è¯„ä¼°æ–°çš„è¡¨è¾¾å¼ã€‚

ä¸Ž DrRacket ç±»ä¼¼ï¼Œå½“ eval-function*é‡åˆ°å®šä¹‰åŒºåŸŸä¸­æœªå®šä¹‰çš„å˜é‡æˆ–å‡½æ•°åæ—¶ï¼Œä¼šå‘å‡ºé”™è¯¯ä¿¡å·ã€‚

#### 21.4 è§£é‡Šæ‰€æœ‰å†…å®¹ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

æŸ¥çœ‹ä»¥ä¸‹ BSL ç¨‹åºï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â close-to-piÂ 3.14) |
> | --- |
> | Â  |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (area-of-circleÂ r) |
> | Â Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â close-to-piÂ ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â rÂ r))) |
> | Â  |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (volume-of-10-cylinderÂ r) |
> | Â Â ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â 10Â (area-of-circleÂ r))) |

å°†è¿™äº›å®šä¹‰è§†ä¸º DrRacket ä¸­çš„å®šä¹‰åŒºåŸŸã€‚åœ¨ç‚¹å‡» RUN åŽï¼Œä½ å¯ä»¥åœ¨äº¤äº’åŒºåŸŸè¯„ä¼°æ¶‰åŠ close-to-piã€area-of-circle å’Œ volume-of-10-cylinder çš„è¡¨è¾¾å¼ï¼š

> | > (area-of-circleÂ 1) |
> | --- |
> | #i3.14 |
> | > (volume-of-10-cylinderÂ 1) |
> | #i31.400000000000002 |
> | > ([*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29)Â 3Â close-to-pi) |
> | #i9.42 |

æœ¬èŠ‚çš„ç›®æ ‡æ˜¯å†æ¬¡æ”¹è¿›ä½ çš„è¯„ä¼°å™¨ï¼Œä½¿å…¶èƒ½å¤Ÿæ¨¡ä»¿ DrRacket çš„è¿™ä¸€éƒ¨åˆ†ã€‚

ç»ƒä¹  360ã€‚ä¸º DrRacket çš„å®šä¹‰åŒºåŸŸè¡¨ç¤ºå½¢å¼åˆ¶å®šæ•°æ®å®šä¹‰ã€‚å…·ä½“æ¥è¯´ï¼Œæ•°æ®è¡¨ç¤ºåº”è¯¥é€‚ç”¨äºŽè‡ªç”±æ··åˆå¸¸é‡å®šä¹‰å’Œå•å‚æ•°å‡½æ•°å®šä¹‰çš„åºåˆ—ã€‚ç¡®ä¿ä½ å¯ä»¥è¡¨ç¤ºæœ¬èŠ‚å¼€å¤´åŒ…å«ä¸‰ä¸ªå®šä¹‰çš„å®šä¹‰åŒºåŸŸã€‚æˆ‘ä»¬ç§°æ­¤ç±»æ•°æ®ä¸º BSL-da-allã€‚

è®¾è®¡ lookup-con-def å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ª BSL-da-all da å’Œä¸€ä¸ªç¬¦å· xã€‚å¦‚æžœ da ä¸­å­˜åœ¨åä¸º x çš„å¸¸é‡å®šä¹‰ï¼Œåˆ™è¯¥å‡½æ•°äº§ç”Ÿè¯¥å¸¸é‡å®šä¹‰çš„è¡¨ç¤ºï¼›å¦åˆ™ï¼Œå‡½æ•°ä¼šå‘å‡ºé”™è¯¯ä¿¡å·ï¼Œè¡¨ç¤ºæ‰¾ä¸åˆ°æ­¤ç±»å¸¸é‡å®šä¹‰ã€‚

è®¾è®¡ lookup-fun-def å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ª BSL-da-all da å’Œä¸€ä¸ªç¬¦å· fã€‚å¦‚æžœ da ä¸­å­˜åœ¨åä¸º f çš„å‡½æ•°å®šä¹‰ï¼Œåˆ™è¯¥å‡½æ•°äº§ç”Ÿè¯¥å‡½æ•°å®šä¹‰çš„è¡¨ç¤ºï¼›å¦åˆ™ï¼Œå‡½æ•°ä¼šå‘å‡ºé”™è¯¯ä¿¡å·ï¼Œè¡¨ç¤ºæ‰¾ä¸åˆ°æ­¤ç±»å‡½æ•°å®šä¹‰ã€‚

ç»ƒä¹  361ã€‚è®¾è®¡ eval-all å‡½æ•°ã€‚ç±»ä¼¼äºŽç»ƒä¹  359 ä¸­çš„ eval-function*ï¼Œè¿™ä¸ªå‡½æ•°æ¶ˆè€—ä¸€ä¸ªè¡¨è¾¾å¼çš„è¡¨ç¤ºå’Œå®šä¹‰åŒºåŸŸã€‚å¦‚æžœè¡¨è¾¾å¼åœ¨äº¤äº’åŒºåŸŸçš„æç¤ºç¬¦ä¸­è¾“å…¥ï¼Œå¹¶ä¸”å®šä¹‰åŒºåŸŸåŒ…å«é€‚å½“çš„å®šä¹‰ï¼Œå®ƒå°†äº§ç”Ÿ DrRacket æ˜¾ç¤ºçš„ç›¸åŒå€¼ã€‚æç¤ºï¼šä½ çš„ eval-all å‡½æ•°åº”è¯¥åƒç»ƒä¹  355 ä¸­çš„ eval-var-lookup ä¸€æ ·å¤„ç†ç»™å®šè¡¨è¾¾å¼ä¸­çš„å˜é‡ã€‚

ç»ƒä¹  362ã€‚è¾“å…¥åŸºäºŽç»“æž„çš„ BSL è¡¨è¾¾å¼å’Œå®šä¹‰åŒºåŸŸå¾ˆéº»çƒ¦ã€‚æ­£å¦‚è§£é‡Šè¡¨è¾¾å¼çš„ç»“å°¾æ‰€å±•ç¤ºçš„ï¼Œå¼•ç”¨è¡¨è¾¾å¼å’Œï¼ˆå®šä¹‰çš„ï¼‰åˆ—è¡¨è¦å®¹æ˜“å¾—å¤šã€‚

è®¾è®¡ä¸€ä¸ªå‡½æ•°è§£é‡Šå™¨ã€‚å®ƒæŽ¥å—ä¸€ä¸ª S-expr å’Œä¸€ä¸ª Slã€‚å‰è€…åº”è¯¥è¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼ï¼ŒåŽè€…æ˜¯ä¸€ä¸ªå®šä¹‰åˆ—è¡¨ã€‚è¯¥å‡½æ•°ä½¿ç”¨é€‚å½“çš„è§£æžå‡½æ•°è§£æžè¿™ä¸¤ä¸ªï¼Œç„¶åŽä½¿ç”¨æ¥è‡ªç»ƒä¹  361 çš„ eval-all æ¥è¯„ä¼°è¡¨è¾¾å¼ã€‚æç¤ºï¼šä½ å¿…é¡»å°†ç»ƒä¹  350 ä¸­çš„æƒ³æ³•æ”¹ç¼–æˆå®šä¹‰å’Œå®šä¹‰åˆ—è¡¨çš„è§£æžå™¨ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»å¯¹è§£é‡Š BSLï¼ˆå¸ƒå°”ç¬¦å·è¯­è¨€ï¼‰æœ‰äº†å¾ˆå¤šäº†è§£ã€‚è¿™é‡Œæœ‰ä¸€äº›ç¼ºå¤±çš„éƒ¨åˆ†ï¼šå¸ƒå°”ä¸Ž[æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)æˆ–[if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)ç»“åˆï¼›å­—ç¬¦ä¸²ä»¥åŠè¯¸å¦‚[string-length](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-length%29%29)æˆ–[string-append](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-append%29%29)è¿™æ ·çš„æ“ä½œï¼›ä»¥åŠä½¿ç”¨'()ã€[empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)ã€[cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)ã€[cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)ã€[first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)ã€[rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)ç­‰æ“ä½œçš„åˆ—è¡¨ï¼›ç­‰ç­‰ã€‚ä¸€æ—¦ä½ çš„è¯„ä¼°å™¨èƒ½å¤Ÿå¤„ç†æ‰€æœ‰è¿™äº›ï¼ŒåŸºæœ¬ä¸Šå°±å®Œæˆäº†ï¼Œå› ä¸ºä½ çš„è¯„ä¼°å™¨å·²ç»çŸ¥é“å¦‚ä½•è§£é‡Šé€’å½’å‡½æ•°ã€‚çŽ°åœ¨å½“æˆ‘ä»¬è¯´â€œç›¸ä¿¡æˆ‘ä»¬ï¼Œä½ çŸ¥é“å¦‚ä½•è®¾è®¡è¿™äº›æ”¹è¿›â€æ—¶ï¼Œæˆ‘ä»¬æ˜¯è®¤çœŸçš„ã€‚

### 22 é¡¹ç›®ï¼šXML çš„å•†ä¸šðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

XML æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æ•°æ®è¯­è¨€ã€‚ä¸€ç§ç”¨é€”æ¶‰åŠåœ¨ä¸åŒè®¡ç®—æœºä¸Šè¿è¡Œçš„ç¨‹åºä¹‹é—´çš„æ¶ˆæ¯äº¤æ¢ã€‚ä¾‹å¦‚ï¼Œå½“ä½ ç”¨ç½‘ç»œæµè§ˆå™¨æŒ‡å‘ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œä½ æ˜¯åœ¨å°†ä½ ç”µè„‘ä¸Šçš„ä¸€ä¸ªç¨‹åºè¿žæŽ¥åˆ°å¦ä¸€å°ç”µè„‘ä¸Šçš„ä¸€ä¸ªç¨‹åºï¼ŒåŽè€…å°† XML æ•°æ®å‘é€åˆ°å‰è€…ã€‚ä¸€æ—¦æµè§ˆå™¨æŽ¥æ”¶åˆ° XML æ•°æ®ï¼Œå®ƒå°±ä¼šåœ¨ä½ çš„ç”µè„‘æ˜¾ç¤ºå™¨ä¸Šå°†å…¶æ¸²æŸ“ä¸ºå›¾åƒã€‚

ä»¥ä¸‹æ¯”è¾ƒé€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­è¯´æ˜Žäº†è¿™ä¸ªæƒ³æ³•ï¼š

> | XML æ•°æ® |  | åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ |
> | --- | --- | --- |
> 
> |
> 
> &#124; <ul> &#124;
> 
> &#124; Â <li> hello </li> &#124;
> 
> &#124; Â <li> <ul> &#124;
> 
> &#124; Â Â Â Â Â <li> one </li> &#124;
> 
> &#124; Â Â Â Â Â <li> two </li> &#124;
> 
> &#124; Â Â Â Â </ul> &#124;
> 
> &#124; Â </li> &#124;
> 
> &#124; Â <li> world </li> &#124;
> 
> &#124; Â <li> good bye </li> &#124;
> 
> &#124; </ul> &#124;
> 
> |  | ![](img/a8b82bdb5f9d0eb29ca092c00c8bfdcf.png) |
> | --- | --- |

åœ¨å·¦è¾¹ï¼Œä½ çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªç½‘ç«™å¯èƒ½å‘é€åˆ°ä½ çš„ç½‘ç»œæµè§ˆå™¨çš„ XML æ•°æ®ç‰‡æ®µã€‚åœ¨å³è¾¹ï¼Œä½ çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªæµè¡Œçš„æµè§ˆå™¨å¦‚ä½•å›¾å½¢åŒ–åœ°æ¸²æŸ“è¿™ä¸ªç‰‡æ®µã€‚

æœ¬ç« è§£é‡Šäº†å°† XML ä½œä¸ºå¦ä¸€ä¸ªæ¶‰åŠäº¤ç»‡æ•°æ®å®šä¹‰å’Œè¿­ä»£ç²¾ç‚¼çš„è®¾è®¡ç»ƒä¹ çš„åŸºæœ¬å¤„ç†æ–¹æ³•ã€‚ä¸‹ä¸€èŠ‚ä»Žéžæ­£å¼æ¯”è¾ƒ S è¡¨è¾¾å¼å’Œ XML æ•°æ®å¼€å§‹ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥åˆ¶å®šå®Œæ•´çš„æ•°æ®å®šä¹‰ã€‚å…¶ä½™éƒ¨åˆ†é€šè¿‡ç¤ºä¾‹è§£é‡Šå¦‚ä½•å¤„ç† XML æ•°æ®çš„ S è¡¨è¾¾å¼ã€‚

#### 22.1XML ä½œä¸º S è¡¨è¾¾å¼ðŸ”— "é“¾æŽ¥è‡³æ­¤")

æœ€åŸºæœ¬çš„ XML æ•°æ®çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

> | <machine> </machine> |
> | --- |

å®ƒè¢«ç§°ä¸ºå…ƒç´ ï¼Œå…¶ä¸­â€œmachineâ€æ˜¯å…ƒç´ çš„åç§°ã€‚å…ƒç´ çš„ä¸¤ä¸ªéƒ¨åˆ†å°±åƒæ‹¬å·ï¼Œç”¨äºŽç•Œå®šå…ƒç´ çš„å†…å®¹ã€‚å½“ä¸¤ä¸ªéƒ¨åˆ†ä¹‹é—´æ²¡æœ‰å†…å®¹ï¼ˆé™¤äº†ç©ºç™½å­—ç¬¦ï¼‰æ—¶ï¼ŒXML å…è®¸ä½¿ç”¨ç¼©å†™ï¼š

> | <machine /> |
> | --- |

ä½†æ˜¯ï¼Œå°±æˆ‘ä»¬åœ¨è¿™é‡Œè®¨è®ºçš„å†…å®¹è€Œè¨€ï¼Œè¿™ä¸ªç¼©å†™ä¸Žæ˜¾å¼æ‹¬å·ç‰ˆæœ¬ç­‰æ•ˆã€‚ä»Ž S è¡¨è¾¾å¼è§’åº¦æ¥çœ‹ï¼ŒXML å…ƒç´ æ˜¯ä¸€ä¸ªå‘½åå¯¹æ‹¬å·ï¼Œå®ƒåŒ…å›´äº†ä¸€äº›å†…å®¹ã€‚Racket çš„ xml åº“ä½¿ç”¨ç»“æž„ä»¥åŠ S è¡¨è¾¾å¼æ¥è¡¨ç¤º XMLã€‚å®žé™…ä¸Šï¼Œä½¿ç”¨ S è¡¨è¾¾å¼æ¥è¡¨ç¤ºä¸Šè¿°å†…å®¹æ˜¯éžå¸¸è‡ªç„¶çš„ï¼š

> '(machine)

è¿™ç‰‡æ•°æ®æœ‰å¼€é—­æ‹¬å·ï¼Œå¹¶å¸¦æœ‰åµŒå…¥å†…å®¹çš„ç©ºé—´ã€‚è¿™é‡Œæœ‰ä¸€ç‰‡å¸¦æœ‰å†…å®¹çš„ XML æ•°æ®ï¼š

> | <machine><action /></machine> |
> | --- |

è®°ä½ï¼Œ<action />éƒ¨åˆ†æ˜¯ä¸€ä¸ªç¼©å†™ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å®žé™…ä¸Šæ­£åœ¨æŸ¥çœ‹ä»¥ä¸‹æ•°æ®ç‰‡æ®µï¼š

> | <machine><action></action></machine> |
> | --- |

é€šå¸¸ï¼ŒXML å…ƒç´ çš„å†…å®¹æ˜¯ä¸€ç³»åˆ— XML å…ƒç´ ï¼š

> | <machine><action /><action /><action /></machine> |
> | --- |

åœæ­¢ï¼åœ¨ç»§ç»­ä¹‹å‰ï¼Œå…ˆå±•å¼€<action />çš„ç¼©å†™ã€‚S è¡¨è¾¾å¼è¡¨ç¤ºæ³•çœ‹èµ·æ¥ä»ç„¶å¾ˆç®€å•ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼š

> '(machineÂ (action))

è¿™æ˜¯ç¬¬äºŒä¸ªè¡¨ç¤ºï¼š

> '(machineÂ (action)Â (action)Â (action))

å½“ä½ æŸ¥çœ‹åŒ…å«ä¸‰ä¸ª<action />å…ƒç´ åºåˆ—çš„ XML æ•°æ®æ—¶ï¼Œä½ ä¼šæ„è¯†åˆ°ä½ å¯èƒ½å¸Œæœ›åŒºåˆ†è¿™äº›å…ƒç´ ã€‚ä¸ºæ­¤ï¼ŒXML å…ƒç´ å¸¦æœ‰å±žæ€§ã€‚ä¾‹å¦‚ï¼Œ

> | <machine initial="red"></machine> |
> | --- |

â€œmachineâ€å…ƒç´ åŒ…å«ä¸€ä¸ªåä¸ºâ€œinitialâ€çš„å±žæ€§ï¼Œå…¶å€¼åœ¨å­—ç¬¦ä¸²å¼•å·å†…ä¸ºâ€œredâ€ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå…·æœ‰åµŒå¥—å…ƒç´ ä¸”ä¹Ÿå…·æœ‰å±žæ€§çš„å¤æ‚ XML å…ƒç´ ï¼š

> | <machine initial="red"> |
> | --- |
> | Â Â <action state="red"Â Â Â Â next="green" /> |
> | Â Â <action state="green"Â Â next="yellow" /> |
> | Â Â <action state="yellow" next="red" /> |
> | </machine> |

æˆ‘ä»¬ä½¿ç”¨ç©ºæ ¼ã€ç¼©è¿›å’Œæ¢è¡Œæ¥ä½¿å…ƒç´ å¯è¯»ï¼Œä½†åœ¨è¿™é‡Œï¼Œè¿™ç§ç©ºç™½æ²¡æœ‰æ„ä¹‰ã€‚è‡ªç„¶åœ°ï¼Œè¿™äº›â€œmachineâ€å…ƒç´ çš„ S è¡¨è¾¾å¼çœ‹èµ·æ¥ä¸Žå®ƒä»¬çš„ XML è¡¨äº²éžå¸¸ç›¸ä¼¼ï¼šXML æ¯” S è¡¨è¾¾å¼å¹´è½» 40 å¹´ã€‚

> '(machineÂ ((initialÂ "red")))

è¦å‘å…ƒç´ æ·»åŠ å±žæ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨çš„åˆ—è¡¨ï¼Œå…¶ä¸­åŽè€…åŒ…å«ä¸¤ä¸ªé¡¹ç›®ï¼šä¸€ä¸ªç¬¦å·å’Œä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ç¬¦å·ä»£è¡¨å±žæ€§çš„åç§°ï¼Œå­—ç¬¦ä¸²ä»£è¡¨å…¶å€¼ã€‚è¿™ä¸ªæƒ³æ³•è‡ªç„¶ä¹Ÿé€‚ç”¨äºŽæ›´å¤æ‚çš„ XML æ•°æ®å½¢å¼ï¼š

> | '(machineÂ ((initialÂ "red")) |
> | --- |
> | Â Â (actionÂ ((stateÂ "red")Â (nextÂ "green"))) |
> | Â Â (actionÂ ((stateÂ "green")Â (nextÂ "yellow"))) |
> | Â Â (actionÂ ((stateÂ "yellow")Â (nextÂ "red")))) |

ç›®å‰è¯·æ³¨æ„ï¼Œå±žæ€§é€šè¿‡ä¸¤ä¸ªå¼€æ‹¬å·æ ‡è®°ï¼Œè€Œå‰©ä½™çš„ XML å…ƒç´ è¡¨ç¤ºåˆ—è¡¨åªæœ‰ä¸€ä¸ªå¼€æ‹¬å·ã€‚

ä½ å¯èƒ½è¿˜è®°å¾—æ¥è‡ª Intermezzo 2: Quote, Unquote çš„æƒ³æ³•ï¼Œå®ƒä½¿ç”¨ S è¡¨è¾¾å¼æ¥è¡¨ç¤º XHTMLï¼Œè¿™æ˜¯ XML çš„ä¸€ç§ç‰¹æ®Šæ–¹è¨€ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¿™ä¸ªç‰‡æ®µå±•ç¤ºäº†ç¨‹åºå‘˜å¦‚ä½•è½»æ¾åœ°å†™ä¸‹éžå¹³å‡¡çš„ XML æ•°æ®å’Œ XML è¡¨ç¤ºçš„æ¨¡æ¿ï¼Œä½¿ç”¨åå¼•å·å’Œ[unquote](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._unquote%29%29)ã€‚å½“ç„¶ï¼ŒInterpreting Expressions æŒ‡å‡ºï¼Œä½ éœ€è¦ä¸€ä¸ªè§£æžå™¨æ¥ç¡®å®šä»»ä½•ç»™å®šçš„ S è¡¨è¾¾å¼æ˜¯å¦æ˜¯ XML æ•°æ®çš„è¡¨ç¤ºï¼Œè€Œè§£æžå™¨æ˜¯ä¸€ç§å¤æ‚ä¸”ä¸å¯»å¸¸çš„å‡½æ•°ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨åŸºäºŽ S è¡¨è¾¾å¼çš„ XML è¡¨ç¤ºæ¥å±•ç¤ºè¿™ä¸ªå¤è€ã€å¯Œæœ‰è¯—æ„çš„æƒ³æ³•åœ¨å®žè·µä¸­çš„å®žç”¨æ€§ã€‚æˆ‘ä»¬é€æ­¥è¿›è¡Œï¼Œä»¥å®žçŽ°æ•°æ®å®šä¹‰ï¼Œå¹¶åˆ©ç”¨è¿­ä»£ä¼˜åŒ–ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåˆæ­¥å°è¯•ï¼š

> | ;Â An Xexpr.v0 (short for X-expression) is a one-item list: |
> | --- |
> | ;Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Symbol  '()) |

è¿™æ˜¯æœ¬èŠ‚å¼€å¤´æåˆ°çš„â€œå‘½åæ‹¬å·â€æ€æƒ³ã€‚ä¸ºè¿™ä¸ªå…ƒç´ è¡¨ç¤ºæ·»åŠ å†…å®¹å¾ˆå®¹æ˜“ï¼š

> | ;Â ä¸€ä¸ª Xexpr.v1 æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼š |
> | --- |
> | ;Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Symbol  List-of  [Xexpr.v1]) |

ç¬¦å·åç§°æˆä¸ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œè¯¥åˆ—è¡¨ç”±å…¶ä»– XML å…ƒç´ è¡¨ç¤ºç»„æˆã€‚æœ€åŽçš„ç»†åŒ–æ­¥éª¤æ˜¯æ·»åŠ å±žæ€§ã€‚ç”±äºŽ XML å…ƒç´ ä¸­çš„å±žæ€§æ˜¯å¯é€‰çš„ï¼Œä¿®è®¢åŽçš„æ•°æ®å®šä¹‰æœ‰ä¸¤ä¸ªå­å¥ï¼š

> | ;Â ä¸€ä¸ª Xexpr.v2 æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼š |
> | --- |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Symbol  Body) |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Symbol  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  [List-of  Attribute]  Body)) |
> | ;Â å…¶ä¸­ Body æ˜¯ [List-of  Xexpr.v2] çš„ç®€ç§° |
> | ;Â ä¸€ä¸ªå±žæ€§æ˜¯ä¸¤ä¸ªé¡¹ç›®çš„åˆ—è¡¨ï¼š |
> | ;Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Symbol  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  String  '())) |

ç»ƒä¹  363. Xexpr.v2 çš„æ‰€æœ‰å…ƒç´ éƒ½ä»¥ Symbol å¼€å¤´ï¼Œä½†æœ‰äº›åŽé¢è·Ÿç€å±žæ€§åˆ—è¡¨ï¼Œæœ‰äº›åˆ™åªè·Ÿç€ Xexpr.v2 åˆ—è¡¨ã€‚é‡æ–°åˆ¶å®š Xexpr.v2 çš„å®šä¹‰ï¼Œä»¥éš”ç¦»å…±åŒçš„å¼€å¤´å¹¶çªå‡ºä¸åŒçš„ç»“å°¾ç±»åž‹ã€‚

ä»Ž Xexpr.v2 ä¸­æ¶ˆé™¤ List-of çš„ä½¿ç”¨ã€‚

ç»ƒä¹  364. å°†æ­¤ XML æ•°æ®è¡¨ç¤ºä¸º Xexpr.v2 çš„å…ƒç´ ï¼š

1.  <transition from="seen-e" to="seen-f" />

1.  <ul><li><word /><word /></li><li><word /></li></ul>

å“ªä¸€ä¸ªå¯ä»¥ç”¨ Xexpr.v0 æˆ– Xexpr.v1 è¡¨ç¤ºï¼Ÿç»ƒä¹  365. è§£é‡Šä»¥ä¸‹ Xexpr.v2 å…ƒç´ ä½œä¸º XML æ•°æ®ï¼š

1.  '(server  ((name  "example.org")))

1.  '(carcas  (board  (grass))  (player  ((name  "sam"))))

1.  '(start)

å“ªäº›æ˜¯ Xexpr.v0 æˆ– Xexpr.v1 çš„å…ƒç´ ï¼Ÿç²—ç•¥åœ°è¯´ï¼ŒX è¡¨è¾¾å¼é€šè¿‡åˆ—è¡¨æ¨¡æ‹Ÿç»“æž„ã€‚è¿™ç§æ¨¡æ‹Ÿå¯¹ç¨‹åºå‘˜æ¥è¯´å¾ˆæ–¹ä¾¿ï¼›å®ƒè¦æ±‚æœ€å°‘çš„é”®ç›˜è¾“å…¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä¸€ä¸ª X è¡¨è¾¾å¼ä¸å¸¦å±žæ€§åˆ—è¡¨ï¼Œå®ƒå°±ç®€å•åœ°è¢«çœç•¥ã€‚è¿™ç§æ•°æ®è¡¨ç¤ºçš„é€‰æ‹©ä»£è¡¨äº†åœ¨æ‰‹åŠ¨ç¼–å†™æ­¤ç±»è¡¨è¾¾å¼å’Œå¤„ç†å®ƒä»¬ä¹‹é—´çš„ä¸€ç§æƒè¡¡ã€‚è§£å†³åŽè€…çš„æœ€ä½³æ–¹æ³•æ˜¯æä¾›ä½¿ X è¡¨è¾¾å¼çœ‹èµ·æ¥åƒç»“æž„çš„å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯è®¿é—®å‡†å­—æ®µçš„å‡½æ•°ï¼š

+   xexpr-nameï¼Œå®ƒæå–å…ƒç´ è¡¨ç¤ºçš„æ ‡ç­¾ï¼›

+   xexpr-attrï¼Œå®ƒæå–å±žæ€§åˆ—è¡¨ï¼›å¹¶ä¸”

+   xexpr-contentï¼Œå®ƒæå–å†…å®¹å…ƒç´ åˆ—è¡¨ã€‚

ä¸€æ—¦æˆ‘ä»¬æœ‰äº†è¿™äº›å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åˆ—è¡¨æ¥è¡¨ç¤º XMLï¼ŒåŒæ—¶å®ƒä»¬è¡¨çŽ°å¾—åƒç»“æž„ç±»åž‹çš„å®žä¾‹ã€‚è¿™äº›å‡½æ•°è§£æž S è¡¨è¾¾å¼ï¼Œè§£æžå™¨çš„è®¾è®¡å¾ˆå¤æ‚ã€‚æ‰€ä»¥è®©æˆ‘ä»¬ä»”ç»†è®¾è®¡å®ƒä»¬ï¼Œä»Žä¸€äº›æ•°æ®ç¤ºä¾‹å¼€å§‹ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â a0Â '((initialÂ "X"))) |
> | --- |
> | Â  |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â e0Â '(machine)) |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â e1Â `(machineÂ ,a0)) |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â e2Â '(machineÂ (action))) |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â e3Â '(machineÂ ()Â (action))) |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â e4Â `(machineÂ ,a0Â (action)Â (action))) |

ç¬¬ä¸€ä¸ªå®šä¹‰å¼•å…¥äº†ä¸€ä¸ªå±žæ€§åˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨åœ¨æž„å»º X è¡¨è¾¾å¼æ—¶è¢«é‡å¤ä½¿ç”¨ä¸¤æ¬¡ã€‚e0 çš„å®šä¹‰æé†’æˆ‘ä»¬ï¼ŒX è¡¨è¾¾å¼å¯èƒ½æ—¢ä¸å¸¦å±žæ€§ä¹Ÿä¸å¸¦å†…å®¹ã€‚ä½ åº”è¯¥èƒ½å¤Ÿè§£é‡Šä¸ºä»€ä¹ˆ e2 å’Œ e3 åŸºæœ¬ä¸Šæ˜¯ç­‰ä»·çš„ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ¶å®šäº†ä¸€ä¸ªç­¾åã€ä¸€ä¸ªç›®çš„å£°æ˜Žå’Œä¸€ä¸ªå¤´ä¿¡æ¯ï¼š

> | ;Â Xexpr.v2 -> [List-of  Attribute] |
> | --- |
> | ;Â retrieves the list of attributes of xe |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (xexpr-attrÂ xe)Â '()) |

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å…³æ³¨ xexpr-attrï¼›å…¶ä»–ä¸¤ä¸ªç•™ä½œç»ƒä¹ ã€‚æž„å»ºåŠŸèƒ½ç¤ºä¾‹éœ€è¦å†³å®šä»Žæ²¡æœ‰ä»»ä½•å±žæ€§çš„ X è¡¨è¾¾å¼ä¸­æå–å±žæ€§ã€‚è™½ç„¶æˆ‘ä»¬é€‰æ‹©çš„è¡¨çŽ°å½¢å¼å®Œå…¨çœç•¥äº†ç¼ºå¤±çš„å±žæ€§ï¼Œä½†æˆ‘ä»¬å¿…é¡»ä¸º XML çš„ç»“æž„åŒ–è¡¨ç¤ºæä¾›'()ã€‚å› æ­¤ï¼Œè¯¥å‡½æ•°ä¸ºè¿™æ ·çš„ X è¡¨è¾¾å¼äº§ç”Ÿ'()ï¼š

> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xexpr-attrÂ e0)Â '()) |
> | --- |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xexpr-attrÂ e1)Â '((initialÂ "X"))) |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xexpr-attrÂ e2)Â '()) |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xexpr-attrÂ e3)Â '()) |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xexpr-attrÂ e4)Â '((initialÂ "X"))) |

æ˜¯æ—¶å€™å¼€å‘æ¨¡æ¿äº†ã€‚ç”±äºŽ Xexpr.v2 çš„æ•°æ®å®šä¹‰å¤æ‚ï¼Œæˆ‘ä»¬é€æ­¥è¿›è¡Œã€‚é¦–å…ˆï¼Œæ•°æ®å®šä¹‰åŒºåˆ†äº†ä¸¤ç§ X è¡¨è¾¾å¼ï¼Œä½†ä¸¤ä¸ªå­å¥éƒ½æè¿°äº†é€šè¿‡[cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)å°†ç¬¦å·æ·»åŠ åˆ°åˆ—è¡¨ä¸­æž„å»ºçš„æ•°æ®ã€‚å…¶æ¬¡ï¼Œä¸¤ä¸ªå­å¥çš„åŒºåˆ«åœ¨äºŽåˆ—è¡¨çš„å…¶ä½™éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯å±žæ€§åˆ—è¡¨çš„å¯é€‰å­˜åœ¨ã€‚è®©æˆ‘ä»¬å°†è¿™äº›æ´žå¯Ÿè½¬åŒ–ä¸ºæ¨¡æ¿ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (xexpr-attrÂ xe) |
> | --- |
> |   ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â optional-loa+contentÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â xe))) |
> |   ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | ([([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) å¯é€‰åŠ è½½å†…å®¹) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> | Â Â Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)]))) |

å±€éƒ¨å®šä¹‰åˆ‡æŽ‰äº† X è¡¨è¾¾å¼çš„åç§°ï¼Œå¹¶ç•™ä¸‹äº†åˆ—è¡¨çš„å…¶ä½™éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†å¯èƒ½ä»¥å±žæ€§åˆ—è¡¨å¼€å§‹ï¼Œä¹Ÿå¯èƒ½ä¸ä»¥å±žæ€§åˆ—è¡¨å¼€å§‹ã€‚å…³é”®æ˜¯å®ƒåªæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œä¸¤ä¸ª [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) æ¡ä»¶å­å¥è¡¨æ˜Žäº†è¿™ä¸€ç‚¹ã€‚ç¬¬ä¸‰ï¼Œè¿™ä¸ªåˆ—è¡¨ä¸æ˜¯é€šè¿‡è‡ªå¼•ç”¨å®šä¹‰çš„ï¼Œè€Œæ˜¯é€šè¿‡å°†ä¸€äº›å±žæ€§ä½œä¸ºå¯é€‰çš„ [cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) é¡¹æ·»åŠ åˆ°ä¸€ä¸ªå¯èƒ½ä¸ºç©ºçš„ X è¡¨è¾¾å¼åˆ—è¡¨ä¸Šå®šä¹‰çš„ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦åŒºåˆ†ä¸¤ç§å¸¸è§æƒ…å†µå¹¶æå–é€šå¸¸çš„ç‰‡æ®µï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (xexpr-attr xe) |
> | --- |
> | Â Â ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) å¯é€‰åŠ è½½å†…å®¹ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) xe))) |
> | Â Â Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â Â Â ([([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) å¯é€‰åŠ è½½å†…å®¹) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> | ï¼ˆ[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â optional-loa+content) |
> | ï¼ˆ[...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â optional-loa+content)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))))) |

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€’å½’å¯¹äºŽå½“å‰ä»»åŠ¡ä¸æ˜¯å¿…éœ€çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è½¬å‘è®¾è®¡æ–¹æ¡ˆçš„ç¬¬äº”æ­¥ã€‚æ˜¾ç„¶ï¼Œå¦‚æžœç»™å®šçš„ X è¡¨è¾¾å¼é™¤äº†åç§°ä¹‹å¤–æ²¡æœ‰ä»»ä½•å…¶ä»–å†…å®¹ï¼Œåˆ™æ²¡æœ‰å±žæ€§ã€‚åœ¨ç¬¬äºŒä¸ªå­å¥ä¸­ï¼Œé—®é¢˜æ˜¯åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªé¡¹ç›®æ˜¯å¦æ˜¯å±žæ€§åˆ—è¡¨æˆ–åªæ˜¯ä¸€ä¸ª Xexpr.v2ã€‚å› ä¸ºè¿™ä¼¼ä¹Žå¾ˆå¤æ‚ï¼Œæˆ‘ä»¬å¸Œæœ›ï¼š

> | ;Â [List-of  Attribute]æˆ– Xexpr.v2 -> ??? |
> | --- |
> | ;Â åˆ¤æ–­ x æ˜¯å¦æ˜¯[List-of  Attribute]çš„å…ƒç´  |
> | ;Â å¦åˆ™ä¸º#false |
> | ï¼ˆ[define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (list-of-attributes?Â x) |
> | ï¼ˆ[#false](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._#false%29%29)ï¼‰ |

ä½¿ç”¨æ­¤å‡½æ•°ï¼Œå®Œæˆ xexpr-attr çš„ä»»åŠ¡éžå¸¸ç›´æŽ¥ï¼›å‚è§å›¾ 126ã€‚å¦‚æžœç¬¬ä¸€ä¸ªé¡¹ç›®æ˜¯ä¸€ä¸ªå±žæ€§åˆ—è¡¨ï¼Œåˆ™å‡½æ•°ä¼šç”Ÿæˆå®ƒï¼›å¦åˆ™æ²¡æœ‰å±žæ€§ã€‚

> > > | ï¼ˆ[define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (xexpr-attrÂ xe) |
> > > | --- |
> > > | ï¼ˆ[local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â optional-loa+contentÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â xe))) |
> > > | ï¼ˆ[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â Â Â [([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) å¯é€‰-loa+å†…å®¹) '()] |
> > > | Â Â Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> > > | Â Â Â Â Â Â Â ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) loa-or-x |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) å¯é€‰-loa+å†…å®¹))) |
> > > | Â Â Â Â Â Â Â Â Â ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29) (å±žæ€§åˆ—è¡¨? loa-or-x) |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â Â loa-or-x |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â Â '()))]))) |
> > > 
> å›¾ 126ï¼šxexpr-attr çš„å®Œæ•´å®šä¹‰

å¯¹äºŽ list-of-attributes?çš„è®¾è®¡ï¼Œæˆ‘ä»¬ä»¥åŒæ ·çš„æ–¹å¼è¿›è¡Œï¼Œå¹¶å¾—åˆ°ä»¥ä¸‹å®šä¹‰ï¼š

> | ;Â [å±žæ€§åˆ—è¡¨ æˆ– Xexpr.v2 ] -> å¸ƒå°”å€¼ |
> | --- |
> | ;Â is x a list of attributes |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (å±žæ€§åˆ—è¡¨? x) |
> | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) x) #true] |
> | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> | Â Â Â Â Â ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) å¯èƒ½çš„å±žæ€§ ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) x))) |
> | Â Â Â Â Â Â Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) å¯èƒ½çš„å±žæ€§))])) |

æˆ‘ä»¬è·³è¿‡è®¾è®¡è¿‡ç¨‹çš„ç»†èŠ‚ï¼Œå› ä¸ºå®ƒä»¬å¹¶ä¸å¼•äººæ³¨ç›®ã€‚å¼•äººæ³¨ç›®çš„æ˜¯è¯¥å‡½æ•°çš„ç­¾åã€‚å®ƒä¸æ˜¯æŒ‡å®šä¸€ä¸ªå¯èƒ½çš„æ•°æ®å®šä¹‰ä½œä¸ºè¾“å…¥ï¼Œè€Œæ˜¯å°†ä¸¤ä¸ªç”±è‹±è¯­å•è¯â€œæˆ–â€åˆ†éš”çš„æ•°æ®å®šä¹‰ç»„åˆåœ¨ä¸€èµ·ã€‚åœ¨ ISL+ ä¸­ï¼Œè¿™ç§å…·æœ‰æ˜Žç¡®æ„ä¹‰çš„éžæ­£å¼ç­¾åæœ‰æ—¶æ˜¯å¯ä»¥æŽ¥å—çš„ã€‚

ç»ƒä¹  366\. è®¾è®¡ xexpr-name å’Œ xexpr-contentã€‚

ç»ƒä¹  367\. è®¾è®¡é…æ–¹è¦æ±‚åœ¨ xexpr-attr çš„æ¨¡æ¿ä¸­è¿›è¡Œè‡ªæˆ‘å¼•ç”¨ã€‚å°†æ­¤è‡ªæˆ‘å¼•ç”¨æ·»åŠ åˆ°æ¨¡æ¿ä¸­ï¼Œç„¶åŽè§£é‡Šä¸ºä»€ä¹ˆæœ€ç»ˆçš„è§£æžå‡½æ•°ä¸åŒ…å«å®ƒã€‚

ç»ƒä¹  368\. ä¸º list-of-attributes å‡½æ•°çš„å®šä¹‰æ›¿æ¢éžæ­£å¼çš„â€œæˆ–â€ç­¾åã€‚

ç»ƒä¹  369\. è®¾è®¡ find-attr å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªå±žæ€§åˆ—è¡¨å’Œä¸€ä¸ªç¬¦å·ã€‚å¦‚æžœå±žæ€§åˆ—è¡¨å°†ç¬¦å·ä¸Žä¸€ä¸ªå­—ç¬¦ä¸²å…³è”ï¼Œåˆ™å‡½æ•°æ£€ç´¢æ­¤å­—ç¬¦ä¸²ï¼›å¦åˆ™å®ƒè¿”å›ž #falseã€‚æŸ¥é˜… [assq](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._assq%29%29) å¹¶ä½¿ç”¨å®ƒæ¥å®šä¹‰è¯¥å‡½æ•°ã€‚

åœ¨æœ¬ç« å‰©ä½™éƒ¨åˆ†ï¼ŒXexpr æŒ‡çš„æ˜¯ Xexpr.v2ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å‡è®¾ xexpr-nameã€xexpr-attr å’Œ xexpr-content å·²ç»å®šä¹‰ã€‚æœ€åŽï¼Œæˆ‘ä»¬ä½¿ç”¨æ¥è‡ª ç»ƒä¹  369 çš„ find-attr æ¥æ£€ç´¢å±žæ€§å€¼ã€‚

#### 22.2 æ¸²æŸ“ XML æžšä¸¾ðŸ”— "é“¾æŽ¥åˆ°è¿™é‡Œ")

XML å®žé™…ä¸Šæ˜¯ä¸€ç»„è¯­è¨€çš„é›†åˆã€‚äººä»¬ä¸ºç‰¹å®šçš„é€šä¿¡æ¸ é“å®šä¹‰æ–¹è¨€ã€‚ä¾‹å¦‚ï¼ŒXHTML æ˜¯ç”¨äºŽä»¥ XML æ ¼å¼å‘é€ç½‘é¡µå†…å®¹çš„è¯­è¨€ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•è®¾è®¡ä¸€ä¸ªç”¨äºŽå°æ®µ XHTML çš„æ¸²æŸ“å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯æœ¬ç« å¼€å¤´çš„æžšä¸¾ã€‚

ul æ ‡ç­¾åŒ…å›´ä¸€ä¸ªæ‰€è°“çš„æ— åºåˆ—è¡¨ã€‚åˆ—è¡¨ä¸­çš„æ¯ä¸ªé¡¹ç›®éƒ½å¸¦æœ‰ li æ ‡ç­¾ï¼Œå®ƒé€šå¸¸åŒ…å«å•è¯ï¼Œä½†ä¹Ÿå¯èƒ½åŒ…å«å…¶ä»–å…ƒç´ ï¼Œç”šè‡³æžšä¸¾ã€‚æ— åºåˆ—è¡¨çš„æ„æ€æ˜¯æ¯ä¸ªé¡¹ç›®éƒ½åº”è¯¥ç”¨å‰å¯¼é¡¹ç›®ç¬¦å·è€Œä¸æ˜¯æ•°å­—æ¥æ¸²æŸ“ã€‚

ç”±äºŽ Xexpr ä¸åŒ…å«æ™®é€šå­—ç¬¦ä¸²ï¼Œå› æ­¤å¦‚ä½•è¡¨ç¤º XHTML æžšä¸¾åœ¨å­é›†ä¸­å¹¶ä¸æ˜Žæ˜¾ã€‚ä¸€ä¸ªé€‰é¡¹æ˜¯è¿›ä¸€æ­¥ç»†åŒ–æ•°æ®è¡¨ç¤ºï¼Œä½¿å¾—ä¸€ä¸ª Xexpr å¯ä»¥æ˜¯ä¸€ä¸ª Stringã€‚å¦ä¸€ä¸ªé€‰é¡¹æ˜¯å¼•å…¥æ–‡æœ¬è¡¨ç¤ºï¼š

> ; ä¸€ä¸ª XWord æ˜¯ '(word  ((text  String))).

è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§é€‰é¡¹ï¼›Racketï¼Œæ•™å­¦è¯­è¨€ä»Žä¸­è¡ç”Ÿå‡ºæ¥çš„è¯­è¨€ï¼Œæä¾›äº†åŒ…å« String åœ¨ Xexpr ä¸­çš„ teachpacksã€‚

ç»ƒä¹  370. ä¸º XWord æž„é€ ä¸‰ä¸ªç¤ºä¾‹ã€‚è®¾è®¡ä¸€ä¸ªå•è¯æŸ¥è¯¢ï¼Œæ£€æŸ¥æŸä¸ª ISL+ å€¼æ˜¯å¦åœ¨ XWord ä¸­ï¼Œä»¥åŠä¸€ä¸ªå•è¯æ–‡æœ¬ï¼Œç”¨äºŽæå– XWord å®žä¾‹çš„å”¯ä¸€å±žæ€§å€¼ã€‚

ç»ƒä¹  371. ç²¾ç‚¼ Xexpr çš„å®šä¹‰ï¼Œä»¥ä¾¿å¯ä»¥è¡¨ç¤ºåŒ…æ‹¬æžšä¸¾ä¸­çš„é¡¹åœ¨å†…çš„çº¯å­—ç¬¦ä¸² XML å…ƒç´ ã€‚

ç»™å®šå•è¯çš„è¡¨ç¤ºï¼Œè¡¨ç¤ºä¸€ä¸ªç±»ä¼¼ XHTML çš„å•è¯æžšä¸¾æ˜¯ç›´æŽ¥çš„ï¼š

> | ;Â An XEnum.v1 is one of: |
> | --- |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'ul  [List-of  XItem.v1]) |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'ul  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Attributes  [List-of  XItem.v1])) |
> | ;Â An XItem.v1 is one of: |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'li  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  XWord  '())) |
> | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'li  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Attributes  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  XWord  '()))) |

ä¸ºäº†å®Œæ•´æ€§ï¼Œæ•°æ®å®šä¹‰åŒ…æ‹¬å±žæ€§åˆ—è¡¨ï¼Œå³ä½¿å®ƒä»¬ä¸å½±å“æ¸²æŸ“ã€‚

åœæ­¢ï¼è®ºè¯ XEnum.v1 çš„æ¯ä¸ªå…ƒç´ ä¹Ÿéƒ½åœ¨ XExpr ä¸­ã€‚

è¿™é‡Œæ˜¯ XEnum.v1 çš„ä¸€ä¸ªç¤ºä¾‹å…ƒç´ ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â e0 |
> | --- |
> | Â Â '(ul |
> | Â Â Â Â (liÂ (wordÂ ((textÂ "one")))) |
> | Â Â Â Â (liÂ (wordÂ ((textÂ "two")))))) |

å®ƒå¯¹åº”äºŽç« èŠ‚å¼€å¤´çš„ç¤ºä¾‹çš„å†…è”æžšä¸¾ã€‚ä½¿ç”¨ 2htdp/image æ•™å­¦åŒ…æ¸²æŸ“å®ƒåº”è¯¥å¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„å›¾åƒï¼š

> ![image](img/3cb365e73fec6305d41977c2a280f916.png)

é¡¹ç›®ç¬¦å·çš„åŠå¾„å’Œé¡¹ç›®ç¬¦å·ä¸Žæ–‡æœ¬ä¹‹é—´çš„è·ç¦»æ˜¯ç¾Žå­¦é—®é¢˜ï¼›è¿™é‡Œé‡è¦çš„æ˜¯æƒ³æ³•ã€‚è¦åˆ›å»ºè¿™ç§å›¾åƒï¼Œä½ å¯èƒ½ä½¿ç”¨è¿™ä¸ª ISL+ ç¨‹åºï¼šæˆ‘ä»¬åœ¨äº¤äº’åŒºåŸŸå¼€å‘äº†è¿™äº›è¡¨è¾¾å¼ã€‚ä½ ä¼šæ€Žä¹ˆåšï¼Ÿ

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â e0-rendered |
> | --- |
> | Â Â ([above/align](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._above%2Falign%29%29) |
> | å·¦å¯¹é½ |
> | Â Â Â ([beside/align](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%2Falign%29%29)Â 'centerÂ BTÂ ([text](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29)Â "one"Â 12Â 'black)) |
> | ([beside/align](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%2Falign%29%29)Â 'centerÂ BTÂ ([text](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29)Â "two"Â 12Â 'black)))) |

å‡è®¾ BT æ˜¯ä¸€ä¸ªé¡¹ç›®ç¬¦å·çš„æ¸²æŸ“ã€‚

çŽ°åœ¨æˆ‘ä»¬ä»”ç»†è®¾è®¡è¿™ä¸ªå‡½æ•°ã€‚ç”±äºŽæ•°æ®è¡¨ç¤ºéœ€è¦ä¸¤ä¸ªæ•°æ®å®šä¹‰ï¼Œè®¾è®¡é…æ–¹å‘Šè¯‰ä½ å¿…é¡»å¹¶è¡Œè®¾è®¡ä¸¤ä¸ªå‡½æ•°ã€‚ç„¶è€Œï¼Œå†æ¬¡å®¡è§†æ—¶ï¼Œæˆ‘ä»¬å‘çŽ°åœ¨è¿™ä¸ªç‰¹å®šæƒ…å†µä¸‹ï¼Œç¬¬äºŒä¸ªæ•°æ®å®šä¹‰ä¸Žç¬¬ä¸€ä¸ªæ˜¯åˆ†ç¦»çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å•ç‹¬å¤„ç†å®ƒã€‚

æ­¤å¤–ï¼ŒXItem.v1 çš„å®šä¹‰ç”±ä¸¤ä¸ªå­å¥ç»„æˆï¼Œè¿™æ„å‘³ç€å‡½æ•°æœ¬èº«åº”è¯¥ç”±ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå­å¥çš„ [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å‡½æ•°ç»„æˆã€‚ç„¶è€Œï¼Œå°† XItem.v1 è§†ä¸º Xexpr çš„å­è¯­è¨€çš„ç›®çš„æ˜¯å°†è¿™äº›ä¸¤ä¸ªå­å¥è§†ä¸º Xexpr é€‰æ‹©å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯ xexpr-contentã€‚ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æå–é¡¹ç›®çš„æ–‡æœ¬éƒ¨åˆ†ï¼Œæ— è®ºå®ƒæ˜¯å¦å¸¦æœ‰å±žæ€§ï¼š

> | ;Â XItem.v1 -> Image |
> | --- |
> | ;Â æ¸²æŸ“ä¸€ä¸ªä»¥é¡¹ç›®ç¬¦å·ä¸ºå‰ç¼€çš„â€œå•è¯â€ |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (render-item1Â i) |
> | Â Â ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (xexpr-contentÂ i)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))) |

é€šå¸¸ï¼Œxexpr-content æå–ä¸€ä¸ª Xexpr çš„åˆ—è¡¨ï¼›åœ¨è¿™ä¸ªç‰¹å®šæƒ…å†µä¸‹ï¼Œåˆ—è¡¨ä¸­æ°å¥½åŒ…å«ä¸€ä¸ª XWordï¼Œå¹¶ä¸”è¿™ä¸ªå•è¯åŒ…å«ä¸€ä¸ªæ–‡æœ¬ï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) render-item1 i) |
> | --- |
> | ï¼ˆ[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (xexpr-content i))) |
> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) å…ƒç´  ([ç¬¬ä¸€ä¸ª](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) å†…å®¹)ï¼‰ |
> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) a-word (word-text element))) |
> | ï¼ˆ[çœç•¥å·](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) a-word [çœç•¥å·](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)ï¼‰ |

ä»Žè¿™é‡Œå¼€å§‹ï¼Œæ“ä½œå¾ˆç®€å•ï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) render-item1 i) |
> | --- |
> | ï¼ˆ[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (xexpr-content i))) |
> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) element ([ç¬¬ä¸€ä¸ª](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) content)) |
> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) a-word (word-text element)) |
> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) item ([æ–‡æœ¬](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29) a-word 12 'black))) |
> | Â Â Â Â ([beside/align](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%2Falign%29%29)Â 'centerÂ BTÂ item))) |

åœ¨æå–å‡ºè¦æ¸²æŸ“åœ¨æ¡ç›®ä¸­çš„æ–‡æœ¬ä¹‹åŽï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå°†å…¶æ¸²æŸ“ä¸ºæ–‡æœ¬å¹¶åœ¨å…¶å‰é¢æ·»åŠ ä¸€ä¸ªé¡¹ç›®ç¬¦å·çš„é—®é¢˜ï¼›è¯·å‚è§ä¸Šé¢çš„ç¤ºä¾‹ï¼Œäº†è§£æ‚¨å¯èƒ½å¦‚ä½•å‘çŽ°è¿™ä¸€æœ€åŽæ­¥éª¤ã€‚

ç»ƒä¹  372ã€‚åœ¨ç»§ç»­é˜…è¯»ä¹‹å‰ï¼Œä¸º render-item1 çš„å®šä¹‰æ·»åŠ æµ‹è¯•ã€‚ç¡®ä¿ä»¥è¿™ç§æ–¹å¼åˆ¶å®šè¿™äº›æµ‹è¯•ï¼Œä»¥ä¾¿å®ƒä»¬ä¸ä¾èµ–äºŽ BT å¸¸æ•°ã€‚ç„¶åŽè§£é‡Šè¯¥å‡½æ•°çš„å·¥ä½œåŽŸç†ï¼›è¯·è®°ä½ï¼Œç›®çš„è¯´æ˜Žè§£é‡Šäº†å®ƒåšä»€ä¹ˆã€‚

çŽ°åœ¨æˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºŽè®¾è®¡ä¸€ä¸ªæ¸²æŸ“æžšä¸¾çš„å‡½æ•°ã€‚ä½¿ç”¨ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå‰ä¸¤ä¸ªè®¾è®¡æ­¥éª¤å¾ˆå®¹æ˜“ï¼š

> | ;Â XEnum.v1 -> Image |
> | --- |
> | ;Â renders a simple enumeration as an image |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (render-enum1Â e0)Â e0-rendered) |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (render-enum1Â xe)Â [empty-image](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-image%29%29)) |

å…³é”®æ­¥éª¤æ˜¯æ¨¡æ¿çš„å¼€å‘ã€‚æ ¹æ®æ•°æ®å®šä¹‰ï¼ŒXEnum.v1 çš„ä¸€ä¸ªå…ƒç´ åŒ…å«ä¸€ä¸ªæœ‰è¶£çš„æ•°æ®ç‰‡æ®µï¼Œå³ XML å…ƒç´ çš„ï¼ˆè¡¨ç¤ºï¼‰ã€‚ç¬¬ä¸€ä¸ªé¡¹ç›®æ€»æ˜¯ 'ulï¼Œå› æ­¤ä¸éœ€è¦æå–å®ƒï¼Œç¬¬äºŒä¸ªå¯é€‰çš„é¡¹ç›®æ˜¯ä¸€ä¸ªå±žæ€§åˆ—è¡¨ï¼Œæˆ‘ä»¬å¿½ç•¥å®ƒã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œç¬¬ä¸€ä¸ªæ¨¡æ¿è‰æ¡ˆçœ‹èµ·æ¥å°±åƒ render-item1 çš„é‚£ä¸ªï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (render-enum1Â xe) |
> | --- |
> | Â Â ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â (xexpr-contentÂ xe)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)))Â ;Â [List-of  XItem.v1] |

è™½ç„¶é¢å‘æ•°æ®çš„è®¾è®¡æ–¹æ³•å‘Šè¯‰ä½ ï¼Œæ¯å½“é‡åˆ°å¤æ‚çš„æ•°æ®å½¢å¼æ—¶ï¼Œä½ åº”è¯¥è®¾è®¡ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œä½†åŸºäºŽæŠ½è±¡çš„è®¾è®¡æ–¹æ³•æ¥è‡ªæŠ½è±¡ï¼Œå»ºè®®å°½å¯èƒ½é‡ç”¨çŽ°æœ‰çš„æŠ½è±¡ï¼Œä¾‹å¦‚ï¼Œä»Žå›¾ 95 å’Œ 96 ä¸­çš„åˆ—è¡¨å¤„ç†å‡½æ•°ï¼Œå½“å¯èƒ½æ—¶ã€‚é‰´äºŽ render-enum1 åº”è¯¥å¤„ç†åˆ—è¡¨å¹¶ä»Žä¸­åˆ›å»ºå•ä¸ªå›¾åƒï¼Œå”¯ä¸€ç¬¦åˆè¦æ±‚çš„ä¸¤ä¸ªåˆ—è¡¨å¤„ç†æŠ½è±¡æ˜¯ [foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29)å’Œ [foldl](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldl%29%29)ã€‚å¦‚æžœä½ è¿˜ç ”ç©¶äº†å®ƒä»¬çš„ç”¨é€”è¯´æ˜Žï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªç±»ä¼¼äºŽä¸Šé¢ e0-rendered ç¤ºä¾‹çš„æ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯å¯¹äºŽ [foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29)ã€‚è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨å®ƒï¼Œéµå¾ªé‡ç”¨è®¾è®¡æ–¹æ³•ï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) render-enum1 xe) |
> | --- |
> | |Â Â Â ([å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (xexpr-content xe))) |
> | ï¼›XItem.v1  å›¾åƒ -> å›¾åƒ |
> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) deal-with-one item-so-farï¼‰ |
> | |Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))) |
> | |Â Â Â Â ([æŠ˜å å³](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29) deal-with-one [ç©ºå›¾åƒ](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-image%29%29) å†…å®¹))) |

ä»Žç±»åž‹åŒ¹é…ä¸­ï¼Œä½ è¿˜å¯ä»¥äº†è§£åˆ°ï¼š

1.  [foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29) çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼›

1.  ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯å›¾åƒï¼›å¹¶ä¸”

1.  æœ€åŽä¸€ä¸ªå‚æ•°æ˜¯è¡¨ç¤º XML å†…å®¹çš„åˆ—è¡¨ã€‚

è‡ªç„¶åœ° [ç©ºå›¾åƒ](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-image%29%29) æ˜¯æ­£ç¡®çš„èµ·ç‚¹ã€‚è¿™ç§é€šè¿‡é‡ç”¨è¿›è¡Œè®¾è®¡çš„æ–¹æ³•å°†æˆ‘ä»¬çš„æ³¨æ„åŠ›é›†ä¸­åœ¨è¦â€œæŠ˜å â€çš„åˆ—è¡¨ä¸Šçš„å‡½æ•°ã€‚å®ƒå°†ä¸€ä¸ªé¡¹ç›®å’Œåˆ°ç›®å‰ä¸ºæ­¢ç”± [æŠ˜å å³](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29) åˆ›å»ºçš„å›¾åƒè½¬æ¢æˆå¦ä¸€ä¸ªå›¾åƒã€‚deal-with-one çš„ç­¾åé˜è¿°äº†è¿™ä¸€æ´žå¯Ÿã€‚ç”±äºŽç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ XItem.v1ï¼Œrender-item1 æ˜¯æ¸²æŸ“å®ƒçš„å‡½æ•°ã€‚è¿™äº§ç”Ÿäº†ä¸¤ä¸ªå¿…é¡»ç»„åˆçš„å›¾åƒï¼šç¬¬ä¸€ä¸ªé¡¹ç›®çš„å›¾åƒå’Œå…¶ä½™é¡¹ç›®çš„å›¾åƒã€‚ä¸ºäº†å †å å®ƒä»¬ï¼Œæˆ‘ä»¬ä½¿ç”¨ [åœ¨ä¸Šæ–¹](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._above%29%29)ï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (render-enum1 xe) |
> | --- |
> | ï¼ˆ[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (xexpr-content xe)ï¼‰ |
> | Â Â Â Â Â Â Â Â Â Â ;Â XItem.v1  Image -> Image |
> | Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (deal-with-one item so-far) |
> | Â Â Â Â Â Â Â Â Â Â Â Â ([åœ¨ä¸Šæ–¹å¯¹é½](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._above%2Falign%29%29) 'left |
> | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (render-item1 item) |
> | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â so-far))) |
> | Â Â Â Â ([æŠ˜å å³](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29) deal-with-one [ç©ºå›¾åƒ](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-image%29%29) content))) |
> > > > | ;Â An XItem.v2 is one of: |
> > > > | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) 'li  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) XWord '())) |
> > > > | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'li  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  [List-of  Attribute]  ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)  XWord))) |
> > > > | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'li  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  XEnum.v2  '())) |
> > > > | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'li  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  [List-of  Attribute]  ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)  XEnum.v2))) |
> > > > | ;Â  |
> > > > | ;Â An XEnum.v2 is one of: |
> > > > | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'ul  [List-of  XItem.v2]) |
> > > > | ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'ul  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  [List-of  Attribute]  [List-of  XItem.v2])) |
> > > > 
> å›¾Â 127ï¼šXML æžšä¸¾çš„çŽ°å®žæ•°æ®è¡¨ç¤º

å¹³é¢æžšä¸¾å¾ˆå¸¸è§ï¼Œä½†å®ƒä»¬ä¹Ÿæ˜¯å®Œæ•´æžšä¸¾æƒ…å†µçš„ä¸€ä¸ªç®€å•è¿‘ä¼¼ã€‚åœ¨çŽ°å®žä¸–ç•Œä¸­ï¼Œç½‘ç»œæµè§ˆå™¨å¿…é¡»å¤„ç†é€šè¿‡ç½‘ç»œåˆ°è¾¾çš„ä»»æ„åµŒå¥—çš„æžšä¸¾ã€‚åœ¨ XML åŠå…¶ç½‘ç»œæµè§ˆå™¨æ–¹è¨€ XHTML ä¸­ï¼ŒåµŒå¥—æ˜¯ç›´æŽ¥çš„ã€‚ä»»ä½•å…ƒç´ éƒ½å¯ä»¥ä½œä¸ºä»»ä½•å…¶ä»–å…ƒç´ çš„å†…å®¹å‡ºçŽ°ã€‚ä¸ºäº†åœ¨æˆ‘ä»¬çš„æœ‰é™ XHTML è¡¨ç¤ºä¸­è¡¨ç¤ºè¿™ç§å…³ç³»ï¼Œæˆ‘ä»¬è¯´ä¸€ä¸ªé¡¹ç›®è¦ä¹ˆæ˜¯ä¸€ä¸ªå•è¯ï¼Œè¦ä¹ˆæ˜¯å¦ä¸€ä¸ªæžšä¸¾ã€‚å›¾Â 127 æ˜¾ç¤ºäº†æ•°æ®å®šä¹‰çš„ç¬¬äºŒç‰ˆä¿®è®¢ã€‚å®ƒåŒ…æ‹¬æžšä¸¾çš„æ•°æ®å®šä¹‰ä¿®è®¢ï¼Œä»¥ä¾¿ç¬¬ä¸€ä¸ªå®šä¹‰å¼•ç”¨äº†æ­£ç¡®çš„é¡¹ç›®å½¢å¼ã€‚

> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) SIZE 12)Â ;Â å­—ä½“å¤§å° |
> > > | --- |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) COLOR "black")Â ;Â å­—ä½“é¢œè‰² |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) BTÂ ;Â ä¸€ä¸ªå›¾å½¢å¸¸é‡ |
> > > |   ([beside](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%29%29) ([circle](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29) 1 'solid BLACK) ([text](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29) " " SIZE COLOR))) |
> > > |   |
> > > |   ;Â Image -> Image |
> > > |   ;Â ç”¨é¡¹ç›®ç¬¦å·æ ‡è®°é¡¹ç›®Â Â  |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (bulletize item) |
> > > |   ([beside/align](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%2Falign%29%29) 'center BT item)) |
> > > |   |
> > > |   ;Â XEnum.v2 -> Image |
> > > |   ;Â å°† XEnum.v2 æ¸²æŸ“ä¸ºå›¾åƒ |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (render-enum xe) |
> > > |   ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)(([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (xexpr-content xe))) |
> > > | Â Â Â Â Â Â Â Â Â Â ;Â XItem.v2  Image -> Image |
> > > | Â Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (deal-with-oneÂ itemÂ so-far) |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â ([above/align](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._above%2Falign%29%29)Â 'leftÂ (render-itemÂ item)Â so-far))) |
> > > | Â Â Â Â ([foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29)Â deal-with-oneÂ [empty-image](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-image%29%29)Â content)]) |
> > > | Â  |
> > > | ;Â XItem.v2 -> Image |
> > > | ;Â æ¸²æŸ“ä¸€ä¸ª XItem.v2 ä¸ºå›¾åƒ |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (render-itemÂ an-item) |
> > > | Â Â ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â contentÂ ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â (xexpr-contentÂ an-item)))) |
> > > | Â Â Â Â (bulletize |
> > > | Â Â Â Â Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â Â Â Â Â [(word?Â content) |
> > > | Â Â Â Â Â Â Â Â Â ([text](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29)Â (word-textÂ content)Â SIZEÂ BLACK)] |
> > > | Â Â Â Â Â Â Â Â [[å¦åˆ™](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29)Â (render-enumÂ content)])))) |
> > > 
> å›¾ 128ï¼šå°†å‡½æ•°ç»†åŒ–ä»¥åŒ¹é…æ•°æ®å®šä¹‰çš„ç»†åŒ–

ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•è¿™ä¸ªæ•°æ®å®šä¹‰çš„æ”¹å˜å½±å“æ¸²æŸ“å‡½æ•°ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ render-enum1 å’Œ render-item1ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥å¤„ç† XEnum.v2 å’Œ XItem.v2ï¼Œåˆ†åˆ«ã€‚è½¯ä»¶å·¥ç¨‹å¸ˆç»å¸¸é¢ä¸´è¿™ç±»é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯è®¾è®¡é£Ÿè°±å¤§æ”¾å¼‚å½©çš„å¦ä¸€ç§æƒ…å†µã€‚

å›¾ 128 å±•ç¤ºäº†å®Œæ•´çš„ç­”æ¡ˆã€‚ç”±äºŽæ›´æ”¹ä»…é™äºŽ XItem.v2 çš„æ•°æ®å®šä¹‰ï¼Œå› æ­¤æ›´æ”¹åœ¨æ¸²æŸ“ç¨‹åºä¸­çš„å‡½æ•°ä¸­æ˜¾ç¤ºå¹¶ä¸ä»¤äººæƒŠè®¶ã€‚è™½ç„¶ render-item1 ä¸éœ€è¦åŒºåˆ† XItem.v1 çš„ä¸åŒå½¢å¼ï¼Œä½† render-item è¢«è¿«ä½¿ç”¨ [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å› ä¸º XItem.v2 åˆ—å‡ºäº†ä¸¤ç§ä¸åŒç±»åž‹çš„é¡¹ã€‚é‰´äºŽè¿™ä¸ªæ•°æ®å®šä¹‰æŽ¥è¿‘çŽ°å®žä¸–ç•Œä¸­çš„ä¸€ä¸ªï¼Œå…¶åŒºåˆ†ç‰¹å¾ä¸æ˜¯ç®€å•çš„ä¸œè¥¿â€”â€”æ¯”å¦‚ '() ä¸Ž [cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29%)â€”â€”è€Œæ˜¯ç»™å®šé¡¹çš„ç‰¹å®šéƒ¨åˆ†ã€‚å¦‚æžœé¡¹çš„å†…å®¹æ˜¯ XWordï¼Œåˆ™æ¸²æŸ“å‡½æ•°æŒ‰ä¹‹å‰çš„æ–¹å¼è¿›è¡Œã€‚å¦åˆ™ï¼Œé¡¹åŒ…å«ä¸€ä¸ªæžšä¸¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œrender-item ä½¿ç”¨ render-enum å¤„ç†æ•°æ®ï¼Œå› ä¸º XItem.v2 çš„æ•°æ®å®šä¹‰åœ¨æ­¤å¤„ç²¾ç¡®åœ°å¼•ç”¨äº† XEnum.v2ã€‚

ç»ƒä¹  373. å›¾ 128 ç¼ºå°‘æµ‹è¯•ç”¨ä¾‹ã€‚ä¸ºæ‰€æœ‰å‡½æ•°å¼€å‘æµ‹è¯•ç”¨ä¾‹ã€‚

ç»ƒä¹  374. å›¾ 127 ä¸­çš„æ•°æ®å®šä¹‰ä½¿ç”¨ [list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)ã€‚å°†å®ƒä»¬é‡å†™ä¸ºä½¿ç”¨ [cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)ã€‚ç„¶åŽä»Žå¤´å¼€å§‹ä½¿ç”¨é…æ–¹è®¾è®¡ XEnum.v2 å’Œ XItem.v2 çš„æ¸²æŸ“å‡½æ•°ã€‚ä½ åº”è¯¥å¾—å‡ºä¸Ž å›¾ 128 ä¸­ç›¸åŒçš„å®šä¹‰ã€‚

ç»ƒä¹  375. å¯¹ [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) çš„åŒ…è£…

> ([beside/align](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%2Falign%29%29)Â 'centerÂ BTÂ [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))

å¯èƒ½ä¼šä»¤ä½ æƒŠè®¶ã€‚ç¼–è¾‘å‡½æ•°å®šä¹‰ï¼Œä»¥ä¾¿åœ¨æ¯ä¸ªå­å¥ä¸­åªå‡ºçŽ°ä¸€æ¬¡åŒ…è£…ã€‚ä½ ä¸ºä»€ä¹ˆç›¸ä¿¡ä½ çš„æ›´æ”¹æ˜¯æœ‰æ•ˆçš„ï¼Ÿä½ æ›´å–œæ¬¢å“ªä¸ªç‰ˆæœ¬ï¼Ÿ

ç»ƒä¹  376. è®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œç”¨äºŽè®¡ç®— XEnum.v2 å®žä¾‹ä¸­æ‰€æœ‰ "hello" çš„æ•°é‡ã€‚

ç»ƒä¹  377. è®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œå°†æžšä¸¾ä¸­çš„æ‰€æœ‰ "hello" æ›¿æ¢ä¸º "bye"ã€‚

#### 22.3 é¢†åŸŸç‰¹å®šè¯­è¨€ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

å·¥ç¨‹å¸ˆé€šå¸¸æž„å»ºéœ€è¦ç‰¹å®šä¸Šä¸‹æ–‡é…ç½®æ‰èƒ½è¿è¡Œçš„å¤§åž‹è½¯ä»¶ç³»ç»Ÿã€‚è¿™é¡¹é…ç½®ä»»åŠ¡å¾€å¾€è½åœ¨ç³»ç»Ÿç®¡ç†å‘˜èº«ä¸Šï¼Œä»–ä»¬å¿…é¡»å¤„ç†è®¸å¤šä¸åŒçš„è½¯ä»¶ç³»ç»Ÿã€‚å•è¯â€œé…ç½®â€æŒ‡çš„æ˜¯ç¨‹åºåœ¨å‘½ä»¤è¡Œæˆ–é€šè¿‡æ‰‹åŠ¿ï¼ˆé¼ æ ‡ç‚¹å‡»ã€æ»‘åŠ¨ï¼‰å¯åŠ¨æ—¶ä¸»å‡½æ•°æ‰€éœ€çš„æ•°æ®ã€‚åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œé…ç½®åªæ˜¯ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œå°½ç®¡å®ƒé€šå¸¸å¦‚æ­¤å¤æ‚ï¼Œä»¥è‡³äºŽç¨‹åºè®¾è®¡è€…æ›´æ„¿æ„é€šè¿‡æ–‡ä»¶æ¥ä¼ é€’å®ƒã€‚

ç”±äºŽè½¯ä»¶å·¥ç¨‹å¸ˆä¸èƒ½å‡è®¾ç³»ç»Ÿç®¡ç†å‘˜äº†è§£æ¯ç§ç¼–ç¨‹è¯­è¨€ï¼Œä»–ä»¬å€¾å‘äºŽè®¾è®¡ç®€å•ã€ä¸“ç”¨çš„é…ç½®è¯­è¨€ã€‚è¿™äº›ä¸“ç”¨è¯­è¨€ä¹Ÿè¢«ç§°ä¸ºé¢†åŸŸç‰¹å®šè¯­è¨€ï¼ˆDSLï¼‰ã€‚å› ä¸ºé…ç½®æŠ½è±¡äº†ç¨‹åºåœ¨å¤šä¸ªæ•°æ®ç‰‡æ®µä¸Šçš„æ¦‚å¿µï¼ŒPaul Hudak åœ¨ 1990 å¹´ä»£æå‡ºï¼ŒDSL æ˜¯ç»ˆæžæŠ½è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬å®Œç¾Žåœ°æ¦‚æ‹¬äº† æŠ½è±¡ çš„æ€æƒ³ã€‚å›´ç»•ä¸€ä¸ªå…±åŒçš„æ ¸å¿ƒï¼ˆæ¯”å¦‚ä¼—æ‰€å‘¨çŸ¥çš„ XML è¯­æ³•ï¼‰å¼€å‘è¿™äº› DSL ç®€åŒ–äº†ç³»ç»Ÿç®¡ç†å‘˜çš„ç”Ÿæ´»ã€‚ä»–ä»¬å¯ä»¥ç¼–å†™å°çš„ XML â€œç¨‹åºâ€ï¼Œä»Žè€Œé…ç½®ä»–ä»¬å¿…é¡»å¯åŠ¨çš„ç³»ç»Ÿã€‚

è™½ç„¶æž„å»º DSL é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€é¡¹é«˜çº§ç¨‹åºå‘˜çš„ä»»åŠ¡ï¼Œä½†å®žé™…ä¸Šä½ å·²ç»å¤„äºŽç†è§£ã€æ¬£èµå’Œå®žçŽ°ä¸€ä¸ªç›¸å½“å¤æ‚çš„ DSL çš„ä½ç½®ã€‚æœ¬èŠ‚è§£é‡Šäº†è¿™ä¸€åˆ‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å®ƒé¦–å…ˆè®©ä½ é‡æ–°ç†Ÿæ‚‰æœ‰é™çŠ¶æ€æœºï¼ˆFSMï¼‰ã€‚ç„¶åŽå®ƒå±•ç¤ºäº†å¦‚ä½•è®¾è®¡ã€å®žçŽ°å’Œç¼–ç¨‹ä¸€ä¸ªç”¨äºŽé…ç½®æ¨¡æ‹Ÿä»»æ„ FSM çš„ç³»ç»Ÿçš„ DSLã€‚

æœ‰é™çŠ¶æ€æœº è®°å¿† æœ‰é™çŠ¶æ€æœºçš„ä¸»é¢˜åœ¨è®¡ç®—æœºç§‘å­¦ä¸­éžå¸¸é‡è¦ï¼Œè¿™æœ¬ä¹¦å·²ç»å¤šæ¬¡ä»‹ç»äº†å®ƒã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é‡ç”¨ æœ‰é™çŠ¶æ€æœº ä¸­çš„ä¾‹å­ï¼Œä½œä¸ºæˆ‘ä»¬å¸Œæœ›è®¾è®¡å’Œå®žçŽ°é…ç½® DSL çš„ç»„ä»¶ã€‚

> > > | ;Â ä¸€ä¸ªæœ‰é™çŠ¶æ€æœºï¼ˆFSMï¼‰æ˜¯ä¸€ä¸ª [åˆ—è¡¨  1 è½¬æ¢] |
> > > | --- |
> > > | ;Â ä¸€ä¸ª 1 è½¬æ¢æ˜¯ä¸¤ä¸ªé¡¹ç›®çš„åˆ—è¡¨ï¼š |
> > > | ;Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  FSM-State  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  FSM-State  '())) |
> > > | ;Â ä¸€ä¸ª FSM-çŠ¶æ€æ˜¯ä¸€ä¸ª å­—ç¬¦ä¸² æŒ‡å®šä¸€ä¸ªé¢œè‰² |
> > > | Â  |
> > > | ;Â æ•°æ®ç¤ºä¾‹ |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) fsm-traffic |
> > > | Â Â '(("red"Â "green")Â ("green"Â "yellow")Â ("yellow"Â "red"))) |
> > > | Â  |
> > > | ;Â FSM-State  FSM -> FSM-State |
> > > | ;Â matches the keys pressed by a player with the given FSM |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (simulateÂ state0Â transitions) |
> > > | Â Â ([big-bang](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29)Â state0Â ;Â FSM-State |
> > > | Â Â Â Â [[to-draw](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29) |
> > > | Â Â Â Â Â Â ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)Â (current) |
> > > | Â Â Â Â Â Â Â Â ([square](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._square%29%29)Â 100Â "solid"Â current))] |
> > > | Â Â Â Â [[on-key](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29) |
> > > | Â Â Â Â Â Â ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)Â (currentÂ key-event) |
> > > | Â Â Â Â Â Â Â Â (findÂ transitionsÂ current))])) |
> > > | Â  |
> > > | ;Â [X Y] [List-of [List  X  Y]] X -> Y |
> > > | ;Â finds the matching Y for the given X in alist |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (findÂ alistÂ x) |
> > > | Â Â ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â fmÂ ([assoc](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._assoc%29%29)Â xÂ alist))) |
> > > | ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29) ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) fm) ([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29) fm) ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29) "not found"))) |
> > > 
> å›¾ 129ï¼šæœ‰é™çŠ¶æ€æœºï¼Œå›žé¡¾

ä¸ºäº†æ–¹ä¾¿ï¼Œå›¾ 129 å†æ¬¡å±•ç¤ºäº†æ•´ä¸ªä»£ç ï¼Œå°½ç®¡å®ƒä»…ä½¿ç”¨åˆ—è¡¨é‡æ–°ç¼–å†™ï¼Œå¹¶å……åˆ†åˆ©ç”¨äº† ISL+çš„å…¨éƒ¨åŠŸèƒ½ã€‚è¯¥ç¨‹åºåŒ…æ‹¬ä¸¤ä¸ªæ•°æ®å®šä¹‰ã€ä¸€ä¸ªæ•°æ®ç¤ºä¾‹å’Œä¸¤ä¸ªå‡½æ•°å®šä¹‰ï¼šsimulate å’Œ findã€‚ä¸Žå‰é¢ç« èŠ‚ä¸­çš„ç›¸å…³ç¨‹åºä¸åŒï¼Œè¿™ä¸ªç¨‹åºå°†è½¬æ¢è¡¨ç¤ºä¸ºä¸¤ä¸ªé¡¹ç›®çš„åˆ—è¡¨ï¼šå½“å‰çŠ¶æ€å’Œä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚

ä¸»è¦å‡½æ•° simulate æŽ¥å—ä¸€ä¸ªè½¬æ¢è¡¨å’Œä¸€ä¸ªåˆå§‹çŠ¶æ€ï¼›ç„¶åŽè¯„ä¼°ä¸€ä¸ª[å¤§çˆ†ç‚¸](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29)è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼å¯¹æ¯ä¸ªé”®äº‹ä»¶åšå‡ºçŠ¶æ€è½¬æ¢çš„ååº”ã€‚çŠ¶æ€ä»¥å½©è‰²æ–¹å—çš„å½¢å¼æ˜¾ç¤ºã€‚[to-draw](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29)å’Œ[on-key](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29)å­å¥ä½¿ç”¨[lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)è¡¨è¾¾å¼æŒ‡å®šï¼Œè¿™äº›è¡¨è¾¾å¼æ¶ˆè€—å½“å‰çŠ¶æ€ä»¥åŠå®žé™…é”®äº‹ä»¶ï¼Œå¹¶åˆ†åˆ«äº§ç”Ÿå›¾åƒæˆ–ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚

å¦‚å…¶ç­¾åæ‰€ç¤ºï¼Œè¾…åŠ© find å‡½æ•°å®Œå…¨ç‹¬ç«‹äºŽ FSM åº”ç”¨ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªåŒ…å«ä¸¤é¡¹çš„åˆ—è¡¨å’Œä¸€ä¸ªé¡¹ç›®ï¼Œä½†å®žé™…é¡¹ç›®çš„æ€§è´¨æ˜¯é€šè¿‡å‚æ•°æŒ‡å®šçš„ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼ŒX å’Œ Y ä»£è¡¨ FSM-Stateï¼Œè¿™æ„å‘³ç€ find å‡½æ•°æ¶ˆè€—ä¸€ä¸ªè½¬æ¢è¡¨ä»¥åŠä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªçŠ¶æ€ã€‚å‡½æ•°ä½“ä½¿ç”¨å†…ç½®çš„ [assoc](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._assoc%29%29) å‡½æ•°æ¥å®Œæˆå¤§éƒ¨åˆ†å·¥ä½œã€‚æŸ¥é˜… [assoc](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._assoc%29%29) çš„æ–‡æ¡£ï¼Œä»¥ä¾¿äº†è§£ä¸ºä»€ä¹ˆ [local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) çš„ä¸»ä½“ä½¿ç”¨äº†ä¸€ä¸ª [if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29) è¡¨è¾¾å¼ã€‚

ç»ƒä¹  378ã€‚ä¿®æ”¹æ¸²æŸ“å‡½æ•°ï¼Œä»¥ä¾¿å°†çŠ¶æ€åç§°å åŠ åˆ°å½©è‰²æ–¹å—ä¸Šã€‚

ç»ƒä¹  379ã€‚ä¸º find å‡½æ•°åˆ¶å®šæµ‹è¯•ç”¨ä¾‹ã€‚

ç»ƒä¹  380ã€‚é‡æ–°åˆ¶å®š 1Transition çš„æ•°æ®å®šä¹‰ï¼Œä»¥ä¾¿å¯ä»¥å°†è½¬æ¢é™åˆ¶ä¸ºæŸäº›æŒ‰é”®ã€‚å°è¯•åˆ¶å®šè¿™ç§å˜åŒ–ï¼Œä»¥ä¾¿ find å‡½æ•°åœ¨æ— éœ€æ›´æ”¹çš„æƒ…å†µä¸‹ç»§ç»­å·¥ä½œã€‚ä¸ºäº†ä½¿å®Œæ•´çš„ç¨‹åºæ­£å¸¸å·¥ä½œï¼Œè¿˜éœ€è¦æ›´æ”¹ä»€ä¹ˆï¼Ÿè®¾è®¡é…æ–¹ä¸­çš„å“ªä¸€éƒ¨åˆ†æä¾›äº†ç­”æ¡ˆï¼Ÿå‚è§ ç»ƒä¹  229 äº†è§£åŽŸå§‹çš„ç»ƒä¹ è¯´æ˜Žã€‚

é…ç½® FSM æ¨¡æ‹Ÿå‡½æ•°ä½¿ç”¨ä¸¤ä¸ªå‚æ•°ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å…±åŒæè¿°äº†ä¸€å°æœºå™¨ã€‚ä¸Žå…¶æ•™ä¸€ä¸ªæ½œåœ¨çš„â€œå®¢æˆ·â€å¦‚ä½•åœ¨ DrRacket ä¸­æ‰“å¼€ ISL+ ç¨‹åºå¹¶å¯åŠ¨ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œæ¨¡æ‹Ÿçš„â€œå–å®¶â€å¯èƒ½å¸Œæœ›ç”¨é…ç½®ç»„ä»¶æ¥è¡¥å……è¿™ä¸ªäº§å“ã€‚

é…ç½®ç»„ä»¶ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯å®¢æˆ·ç”¨æ¥ä¸ºç»„ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼ˆsï¼‰åˆ¶å®šåˆå§‹å‚æ•°çš„å¹¿æ³›ä½¿ç”¨çš„ç®€å•è¯­è¨€ã€‚ç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸€ä¸ªå°†å®¢æˆ·æ‰€è¯´çš„è¯è½¬æ¢ä¸ºä¸»åŠŸèƒ½å‡½æ•°è°ƒç”¨çš„å‡½æ•°ã€‚å¯¹äºŽ FSM æ¨¡æ‹Ÿå™¨ï¼Œæˆ‘ä»¬å¿…é¡»å°±å¦‚ä½•åœ¨ XML ä¸­è¡¨ç¤ºæœ‰é™çŠ¶æ€æœºè¾¾æˆä¸€è‡´ã€‚é€šè¿‡å‘¨å¯†è§„åˆ’ï¼ŒXML ä½œä¸º S è¡¨è¾¾å¼å‘ˆçŽ°äº†ä¸€ç³»åˆ—çœ‹èµ·æ¥éžå¸¸é€‚åˆè¿™é¡¹ä»»åŠ¡çš„æœºå™¨ç¤ºä¾‹ã€‚å›žæƒ³ä¸€ä¸‹æœ¬èŠ‚æœ€åŽçš„æœºå™¨ç¤ºä¾‹ï¼š

> | <machine initial="red"> |
> | --- |
> | Â Â <action state="red"Â Â Â Â next="green" /> |
> | Â Â <action state="green"Â Â next="yellow" /> |
> | Â Â <action state="yellow" next="red" /> |
> | </machine> |

å°†å…¶ä¸Ž å›¾ 129 ä¸­çš„ fsm-traffic è½¬æ¢è¡¨è¿›è¡Œæ¯”è¾ƒã€‚åŒæ—¶å›žå¿†ä¸€ä¸‹è¿™ä¸ªç¤ºä¾‹çš„çº¦å®š Xexpr è¡¨ç¤ºå½¢å¼ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â xm0 |
> | --- |
> | |Â Â Â '(machineÂ ((initialÂ "red")) |
> | |Â Â Â Â Â (actionÂ ((stateÂ "red")Â (nextÂ "green"))) |
> | |Â Â Â Â Â (actionÂ ((stateÂ "green")Â (nextÂ "yellow"))) |
> | |Â Â Â Â Â (actionÂ ((stateÂ "yellow")Â (nextÂ "red"))))) |

æˆ‘ä»¬ä»ç„¶ç¼ºå°‘ä¸€ä¸ªé€šç”¨æ•°æ®å®šä¹‰ï¼Œç”¨äºŽæè¿°æ‰€æœ‰å¯èƒ½çš„ FSM çš„ Xexpr è¡¨ç¤ºå½¢å¼ï¼š

> | ;Â ä¸€ä¸ª XMachine æ˜¯è¿™ç§å½¢çŠ¶çš„åµŒå¥—åˆ—è¡¨ï¼š |
> | --- |
> | ;Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'machine  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  `((initial  ,FSM-State))Â Â [List-of  X1T])) |
> | ;Â ä¸€ä¸ª X1T æ˜¯è¿™ç§å½¢çŠ¶çš„åµŒå¥—åˆ—è¡¨ï¼š |
> | ;Â Â Â `(action  ((state  ,FSM-State)  (next  ,FSM-State))) |

ä¸Ž XEnum.v2 ç±»ä¼¼ï¼ŒXMachine æè¿°äº†æ‰€æœ‰ Xexpr çš„ä¸€ä¸ªå­é›†ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬è®¾è®¡å¤„ç†è¿™ç§æ–°åž‹æ•°æ®å½¢å¼çš„å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä½¿ç”¨é€šç”¨çš„ Xexpr å‡½æ•°æ¥è®¿é—®ç‰‡æ®µã€‚

ç»ƒä¹  381. XMachine å’Œ X1T çš„å®šä¹‰ä½¿ç”¨äº†å¼•å·ï¼Œè¿™å¯¹æ–°æ‰‹ç¨‹åºå‘˜æ¥è¯´éžå¸¸ä¸åˆé€‚ã€‚é¦–å…ˆå°†å®ƒä»¬é‡å†™ä¸ºä½¿ç”¨ [list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29) å’Œ [cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)ã€‚

ç»ƒä¹  382. ä¸º BW æœºå™¨åˆ¶å®šä¸€ä¸ª XML é…ç½®ï¼Œè¯¥é…ç½®åœ¨æ¯ä¸ªæŒ‰é”®äº‹ä»¶æ—¶ä»Žç™½è‰²åˆ‡æ¢åˆ°é»‘è‰²ï¼Œç„¶åŽå†åˆ‡æ¢å›žæ¥ã€‚å°† XML é…ç½®è½¬æ¢ä¸º XMachine è¡¨ç¤ºå½¢å¼ã€‚å‚è§ ç»ƒä¹  227 ä»¥äº†è§£å°†æœºå™¨ä½œä¸ºç¨‹åºå®žçŽ°çš„ç¤ºä¾‹ã€‚

åœ¨æˆ‘ä»¬æ·±å…¥é…ç½®é—®é¢˜çš„ç¿»è¯‘éƒ¨åˆ†ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ˜Žç¡®ä¸€ä¸‹ï¼š

> æ ·æœ¬é—®é¢˜ï¼šè®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œä½¿ç”¨ XMachine é…ç½®æ¥è¿è¡Œæ¨¡æ‹Ÿã€‚

è™½ç„¶è¿™ä¸ªé—®é¢˜é’ˆå¯¹æˆ‘ä»¬çš„æ¡ˆä¾‹æ˜¯ç‰¹å®šçš„ï¼Œä½†å¾ˆå®¹æ˜“æƒ³è±¡ä¸€ä¸ªé€‚ç”¨äºŽç±»ä¼¼ç³»ç»Ÿçš„æ³›åŒ–ï¼Œæˆ‘ä»¬é¼“åŠ±æ‚¨è¿™æ ·åšã€‚é—®é¢˜é™ˆè¿°å»ºè®®ä¸€ä¸ªå®Œæ•´çš„æ¦‚è¿°ï¼š

> | ;Â XMachine -> FSM-State |
> | --- |
> | ;Â é€šè¿‡ç»™å®šçš„é…ç½®æ¨¡æ‹Ÿæœ‰é™çŠ¶æ€æœº |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (simulate-xmachineÂ xm) |
> | Â Â (simulateÂ [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))) |

æŒ‰ç…§é—®é¢˜é™ˆè¿°ï¼Œæˆ‘ä»¬çš„å‡½æ•°è°ƒç”¨ä½¿ç”¨ä¸¤ä¸ªå¾…ç¡®å®šçš„å‚æ•°è¿›è¡Œæ¨¡æ‹Ÿã€‚æˆ‘ä»¬éœ€è¦å®Œæˆå®šä¹‰çš„æ˜¯ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªåˆå§‹çŠ¶æ€å’Œä¸€ä¸ªè½¬æ¢è¡¨ã€‚è¿™ä¸¤ä¸ªéƒ¨åˆ†æ˜¯ xm çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬æœ€å¥½å¸Œæœ›æœ‰é€‚å½“çš„å‡½æ•°ï¼š

+   xm-state0 ä»Žç»™å®šçš„ XMachine ä¸­æå–åˆå§‹çŠ¶æ€ï¼š

    > ([æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xm-state0Â xm0)Â "red")

+   xm->transitions å°†åµŒå…¥çš„ X1T åˆ—è¡¨è½¬æ¢ä¸º 1Transition åˆ—è¡¨ï¼š

    > ([æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xm->transitionsÂ xm0)Â fsm-traffic)
    > 
> > > | ;Â XMachine -> FSM-State |
> > > | --- |
> > > | ;Â å°†ç»™å®šçš„é…ç½®è§£é‡Šä¸ºçŠ¶æ€æœº |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (simulate-xmachineÂ xm) |
> > > | Â Â (simulateÂ (xm-state0Â xm)Â (xm->transitionsÂ xm))) |
> > > | Â  |
> > > | ;Â XMachine -> FSM-State |
> > > | ;Â ä»Ž xm0 ä¸­æå–å¹¶è½¬æ¢è½¬æ¢è¡¨ |
> > > | Â  |
> > > | ([æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (xm-state0Â xm0)Â "red") |
> > > | Â  |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (xm-state0Â xm0) |
> > > | Â Â (find-attrÂ (xexpr-attrÂ xm0)Â 'initial)) |
> > > | Â  |
> > > | ;Â XMachine -> [åˆ—è¡¨  1Transition] |
> > > | ;Â ä»Ž xm ä¸­æå–è½¬æ¢è¡¨ |
> > > | Â  |
> > > | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29) (xm->transitions xm0) fsm-traffic) |
> > > | Â  |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (xm->transitions xm) |
> > > | ï¼ˆ[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (; X1T -> 1Transition |
> > > | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (xaction->action xa) |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29) (find-attr (xexpr-attr xa) 'state) |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (find-attr (xexpr-attr xa) 'next)))) |
> > > | Â Â Â Â ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) xaction->action (xexpr-content xm)))) |
> > > 
> å›¾ 130ï¼šè§£é‡Š DSL ç¨‹åº

ç”±äºŽ XMachine æ˜¯ Xexpr çš„ä¸€ä¸ªå­é›†ï¼Œå› æ­¤å®šä¹‰ xm-state0 æ˜¯ç›´æŽ¥çš„ã€‚é‰´äºŽåˆå§‹çŠ¶æ€è¢«æŒ‡å®šä¸ºä¸€ä¸ªå±žæ€§ï¼Œxm-state0 ä½¿ç”¨ xexpr-attr æå–å±žæ€§åˆ—è¡¨ï¼Œç„¶åŽæ£€ç´¢'initial å±žæ€§å€¼ã€‚

æŽ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è½¬å‘ xm->transitionsï¼Œå®ƒå°† XMachine é…ç½®å†…éƒ¨çš„è½¬æ¢è½¬æ¢ä¸ºè½¬æ¢è¡¨ï¼š

> | ; XMachine -> [List-of 1Transition] |
> | --- |
> | ; ä»Ž xm ä¸­æå–å¹¶è½¬æ¢è½¬æ¢è¡¨ |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (xm->transitions xm) |
> | ï¼ˆï¼‰ |

å‡½æ•°çš„åç§°è§„å®šäº†ç­¾åå¹¶æš—ç¤ºäº†ä¸€ä¸ªç›®çš„å£°æ˜Žã€‚æˆ‘ä»¬çš„ç›®çš„å£°æ˜Žæè¿°äº†ä¸€ä¸ªä¸¤æ­¥è¿‡ç¨‹ï¼šï¼ˆ1ï¼‰æå–è½¬æ¢çš„ Xexpr è¡¨ç¤ºå½¢å¼ï¼Œï¼ˆ2ï¼‰å°†å®ƒä»¬è½¬æ¢æˆ[åˆ—è¡¨ 1 è½¬æ¢]çš„ä¸€ä¸ªå®žä¾‹ã€‚è™½ç„¶æå–éƒ¨åˆ†æ˜¾ç„¶ä½¿ç”¨ xexpr-content æ¥èŽ·å–åˆ—è¡¨ï¼Œä½†è½¬æ¢éƒ¨åˆ†éœ€è¦æ›´å¤šçš„åˆ†æžã€‚å¦‚æžœä½ å›žé¡¾ XMachine çš„æ•°æ®å®šä¹‰ï¼Œä½ ä¼šçœ‹åˆ° Xexpr çš„å†…å®¹æ˜¯ä¸€ä¸ª X1T çš„åˆ—è¡¨ã€‚ç­¾åå‘Šè¯‰æˆ‘ä»¬è½¬æ¢è¡¨æ˜¯ä¸€ä¸ª 1 è½¬æ¢çš„åˆ—è¡¨ã€‚ç¡®å®žï¼Œå¾ˆæ˜Žæ˜¾å‰ä¸€ä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸ªé¡¹ç›®éƒ½è½¬æ¢æˆäº†åŽä¸€ä¸ªåˆ—è¡¨ä¸­çš„ä¸€ä¸ªé¡¹ç›®ï¼Œè¿™æš—ç¤ºäº†ä½¿ç”¨[æ˜ å°„](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)ï¼š

> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) ï¼ˆxm->transitions xmï¼‰ |
> | --- |
> | ï¼ˆ[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ï¼ˆ; X1T -> 1 è½¬æ¢ |
> | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) ï¼ˆxaction->action xaï¼‰ |
> | ...ï¼ˆ[æ›´å¤šå†…å®¹](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))) |
> | ï¼ˆ[æ˜ å°„](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) xaction->action ï¼ˆxexpr-content xm)))) |

å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬éµå¾ªäº†é€šè¿‡ç¤ºä¾‹ä½¿ç”¨æŠ½è±¡çš„è®¾è®¡ç†å¿µï¼Œå¹¶å°†å‡½æ•°å®šä¹‰ä¸º[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)å½¢å¼ï¼Œå…¶ä¸»ä½“ä½¿ç”¨[æ˜ å°„](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)ã€‚å®šä¹‰ xaction->action å†æ¬¡åªæ˜¯ä»Ž Xexpr ä¸­æå–é€‚å½“çš„å€¼çš„é—®é¢˜ã€‚

å›¾ 130 æ˜¾ç¤ºäº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨è¿™é‡Œï¼Œä»Ž DSL åˆ°é€‚å½“å‡½æ•°è°ƒç”¨çš„è½¬æ¢ä¸ŽåŽŸå§‹ç»„ä»¶çš„å¤§å°ç›¸å½“ã€‚åœ¨çŽ°å®žä¸–ç•Œçš„ç³»ç»Ÿä¸­å¹¶éžå¦‚æ­¤ï¼›DSL ç»„ä»¶å¾€å¾€æ˜¯æ•´ä½“äº§å“çš„ä¸€å°éƒ¨åˆ†ï¼Œè¿™ä¹Ÿæ˜¯è¿™ç§æ–¹æ³•å¦‚æ­¤å—æ¬¢è¿Žçš„åŽŸå› ã€‚

ç»ƒä¹  383ã€‚ä½¿ç”¨æ¥è‡ªç»ƒä¹  382 çš„ BW æœºå™¨é…ç½®ï¼ˆ#%28counter._%28exercise._ex~3axmachine-data1%29%29ï¼‰è¿è¡Œå›¾ 130 ä¸­çš„ä»£ç ï¼ˆ#%28counter._%28figure._fig~3adsl%29%29ï¼‰ã€‚

> > > > > machine-configuration.xml
> > > > > 
> > > > > > |  |
> > > > > > | --- |
> > > > > > | Â Â <machine initial="red"> |
> > > > > > | Â Â Â <action state="red"Â Â Â Â next="green" /> |
> > > > > > | Â Â Â <action state="green"Â Â next="yellow" /> |
> > > > > > | Â Â Â <action state="yellow" next="red" /> |
> > > > > > | Â Â </machine> |
> > > > > > |  |
> > > > > > 
> å›¾ 131ï¼šå…·æœ‰æœºå™¨é…ç½®çš„æ–‡ä»¶

#### 22.4 è¯»å– XMLðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ç³»ç»Ÿç®¡ç†å‘˜æœŸæœ›å¤æ‚çš„åº”ç”¨ç¨‹åºä»Žæ–‡ä»¶æˆ–å¯èƒ½ä»Žç½‘ç»œä¸Šçš„æŸä¸ªåœ°æ–¹è¯»å–é…ç½®ç¨‹åºã€‚åœ¨ ISL+ ä¸­ï¼Œæ‚¨çš„ç¨‹åºå¯ä»¥æ£€ç´¢ï¼ˆä¸€äº›ï¼‰XML ä¿¡æ¯ã€‚å›¾ 132 æ˜¾ç¤ºäº†æ•™å­¦åŒ…ä¸­çš„ç›¸å…³æ‘˜å½•ã€‚ä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œè¯¥å›¾ä½¿ç”¨ .v3 åŽç¼€è¡¨ç¤ºå…¶ XML è¡¨ç¤ºå½¢å¼ï¼ŒåŒ…æ‹¬é‚£äº›æ²¡æœ‰ç‰ˆæœ¬ 2 çš„æ•°æ®å®šä¹‰ï¼š

> | ;Â Xexpr.v3 æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š |
> | --- |
> | ;Â   â€“  Symbol |
> | ;Â   â€“  String |
> | ;Â   â€“  æ•°å­— |
> | ;Â   â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Symbol  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Attribute*.v3  [List-of  Xexpr.v3])) |
> | ;Â   â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Symbol  [List-of  Xexpr.v3])) |
> | ;Â  |
> | ;Â Attribute*.v3 æ˜¯ä¸€ä¸ª [List-of  Attribute.v3]ã€‚ |
> | ;Â Â Â  |
> | ;Â Attribute.v3 æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé¡¹ç›®çš„åˆ—è¡¨ï¼š |
> | ;Â Â Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)  Symbol  String) |
> > > | ;Â Any -> Boolean |
> > > | ;Â x æ˜¯å¦æ˜¯ä¸€ä¸ª Xexpr.v3 |
> > > | ;Â å¦‚æžœ x ä¸æ˜¯ä¸€ä¸ª Xexpr.v3ï¼Œåˆ™æ•ˆæžœæ˜¾ç¤ºä¸è‰¯çš„ç‰‡æ®µ |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ([xexpr?](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._xexpr~3f%29%29)Â x)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |
> > > | Â  |
> > > | ;Â String -> Xexpr.v3 |
> > > | ;Â ç”Ÿæˆæ–‡ä»¶ f ä¸­çš„ç¬¬ä¸€ä¸ª XML å…ƒç´  |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ([read-xexpr](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-xexpr%29%29)Â f)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |
> > > | Â  |
> > > | ;Â String -> Boolean |
> > > | ;Â å¦‚æžœæ­¤ URL è¿”å›ž '404'ï¼Œåˆ™è¿”å›ž #falseï¼›å¦åˆ™è¿”å›ž #true |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ([url-exists?](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._url-exists~3f%29%29)Â u)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |
> > > | Â  |
> > > | ;Â String -> [Maybe  Xexpr.v3] |
> > > | ;Â ä»Ž URL u ä¸­æ£€ç´¢ç¬¬ä¸€ä¸ª XML (HTML) å…ƒç´  |
> > > | ;Â å¦‚æžœ ([not](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._not%29%29)  ([url-exists?](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._url-exists~3f%29%29)  u)) |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ([read-plain-xexpr/web](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-plain-xexpr%2Fweb%29%29)Â u)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |
> > > | Â  |
> > > | ;Â String -> [Maybe  Xexpr.v3] |
> > > | ;Â ä»Ž URL u ä¸­æ£€ç´¢ç¬¬ä¸€ä¸ª XML (HTML) å…ƒç´  |
> > > | ;Â #false if ([not](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._not%29%29)  ([url-exists?](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._url-exists~3f%29%29)  u)) |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â ([read-xexpr/web](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-xexpr%2Fweb%29%29)Â u)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |
> > > 
> å›¾ 132ï¼šè¯»å– X è¡¨è¾¾å¼

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶åœ¨å›¾ 131 ä¸­ã€‚å¦‚æžœéœ€è¦ 2htdp/batch-io æ•™å­¦åŒ…ï¼Œç¨‹åºå¯ä»¥è¯»å–[read-plain-xexpr](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-plain-xexpr%29%29)å…ƒç´ ã€‚è¯¥å‡½æ•°ä»¥ä¸Ž XMachine æ•°æ®å®šä¹‰ç›¸åŒ¹é…çš„æ ¼å¼æ£€ç´¢ XML å…ƒç´ ã€‚è¯¥æ•™å­¦åŒ…ä¸­è¿˜æœ‰ä¸€ä¸ªç”¨äºŽä»Žç½‘ç»œæ£€ç´¢ XML å…ƒç´ çš„å‡½æ•°ã€‚åœ¨ DrRacket ä¸­å°è¯•ä»¥ä¸‹æ“ä½œï¼š

> | >Â ([read-plain-xexpr/web](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-plain-xexpr%2Fweb%29%29) |
> | --- |
> | Â Â Â Â ([string-append](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-append%29%29) |
> | Â Â Â Â Â Â Â "Https://Felleisen.org/" |
> | Â Â Â Â Â Â Â "matthias/" |
> | Â Â Â Â Â Â Â "HtDP2e/Files/machine-configuration.xml")) |

å¦‚æžœä½ çš„è®¡ç®—æœºè¿žæŽ¥åˆ°ç½‘ç»œï¼Œè¿™ä¸ªè¡¨è¾¾å¼å°†æ£€ç´¢æˆ‘ä»¬çš„æ ‡å‡†æœºå™¨é…ç½®ã€‚

è¯»å–æ–‡ä»¶æˆ–ç½‘é¡µå°†ä¸€ä¸ªå…¨æ–°çš„æƒ³æ³•å¼•å…¥åˆ°æˆ‘ä»¬çš„è®¡ç®—æ¨¡åž‹ä¸­ã€‚æ­£å¦‚ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆå­¦è€…è¯­è¨€æ‰€è§£é‡Šçš„ï¼ŒBSL ç¨‹åºæ˜¯ä»¥ä¸Žä½ åœ¨ä»£æ•°ä¸­è¯„ä¼°å˜é‡è¡¨è¾¾å¼ç›¸åŒçš„æ–¹å¼è¿›è¡Œè¯„ä¼°çš„ã€‚å‡½æ•°å®šä¹‰ä¹Ÿåƒåœ¨ä»£æ•°ä¸­ä¸€æ ·è¢«å¤„ç†ã€‚å®žé™…ä¸Šï¼Œå¤§å¤šæ•°ä»£æ•°è¯¾ç¨‹éƒ½ä»‹ç»äº†æ¡ä»¶å‡½æ•°å®šä¹‰ï¼Œè¿™æ„å‘³ç€[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)ä¹Ÿä¸ä¼šå¸¦æ¥ä»»ä½•æŒ‘æˆ˜ã€‚æœ€åŽï¼Œè™½ç„¶ ISL+å°†å‡½æ•°ä½œä¸ºå€¼å¼•å…¥ï¼Œä½†è¯„ä¼°æ¨¡åž‹ä»ç„¶ä¿æŒåŸºæœ¬ç›¸åŒã€‚

è¿™ä¸ªè®¡ç®—æ¨¡åž‹çš„ä¸€ä¸ªåŸºæœ¬ç‰¹æ€§æ˜¯ï¼Œæ— è®ºä½ å¤šå°‘æ¬¡åœ¨æŸä¸ªå‚æ•°ä¸Šè°ƒç”¨å‡½æ•° fï¼Œ[...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)

> (fÂ aÂ [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))

ç­”æ¡ˆä¿æŒä¸å˜ã€‚ç„¶è€Œï¼Œ[read-file](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29)ï¼Œ[read-xexpr](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-xexpr%29%29)ï¼ŒåŠå…¶ç›¸å…³åŠŸèƒ½çš„å¼•å…¥ç ´åäº†è¿™ä¸€å±žæ€§ã€‚é—®é¢˜æ˜¯æ–‡ä»¶å’Œç½‘ç«™å¯èƒ½ä¼šéšæ—¶é—´å˜åŒ–ï¼Œå› æ­¤æ¯æ¬¡ç¨‹åºè¯»å–æ–‡ä»¶æˆ–ç½‘ç«™æ—¶ï¼Œå®ƒå¯èƒ½ä¼šå¾—åˆ°æ–°çš„ç»“æžœã€‚

è€ƒè™‘æŸ¥æ‰¾å…¬å¸è‚¡ä»·çš„æƒ³æ³•ã€‚å°†æ‚¨çš„æµè§ˆå™¨æŒ‡å‘ google.com/finance æˆ–ä»»ä½•å…¶ä»–æ­¤ç±»é‡‘èžç½‘ç«™ï¼Œå¹¶è¾“å…¥æ‚¨å–œæ¬¢çš„å…¬å¸åç§°ï¼Œä¾‹å¦‚ï¼Œç¦ç‰¹ã€‚ä½œä¸ºå›žåº”ï¼Œè¯¥ç½‘ç«™å°†æ˜¾ç¤ºå…¬å¸è‚¡ç¥¨çš„å½“å‰ä»·æ ¼å’Œå…¶ä»–ä¿¡æ¯â€”â€”ä¾‹å¦‚ï¼Œè‡ªä¸Šæ¬¡å‘å¸ƒä»¥æ¥ä»·æ ¼çš„å˜åŒ–ï¼Œå½“å‰æ—¶é—´ï¼Œä»¥åŠè®¸å¤šå…¶ä»–äº‹å®žå’Œå¹¿å‘Šã€‚é‡è¦çš„æ˜¯ï¼Œåœ¨ä¸€å¤©æˆ–ä¸€å‘¨å†…é‡æ–°åŠ è½½æ­¤é¡µé¢æ—¶ï¼Œæ­¤ç½‘é¡µä¸Šçš„ä¸€äº›ä¿¡æ¯å°†å‘ç”Ÿå˜åŒ–ã€‚

æŸ¥æ‰¾æ­¤ç±»å…¬å¸ä¿¡æ¯çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ç¼–å†™ä¸€ä¸ªå°ç¨‹åºï¼Œå®šæœŸæ£€ç´¢æ­¤ç±»ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œæ¯ 15 ç§’ä¸€æ¬¡ã€‚ä½¿ç”¨ ISLï¼Œæ‚¨å¯ä»¥ç¼–å†™ä¸€ä¸ªæ‰§è¡Œæ­¤ä»»åŠ¡çš„å…¨çƒç¨‹åºã€‚æ‚¨å°†åƒè¿™æ ·å¯åŠ¨å®ƒï¼š

> | > (stock-alertÂ "Ford") |
> | --- |

ä»¥æŸ¥çœ‹æ˜¾ç¤ºå¦‚ä¸‹å›¾åƒçš„å…¨å±€çª—å£ï¼š

> ![image](img/ac85f75a7fbd8559a96044f6bbea3f30.png)

å¼€å‘æ­¤ç±»ç¨‹åºéœ€è¦è¶…å‡ºå¸¸è§„ç¨‹åºè®¾è®¡çš„æŠ€èƒ½ã€‚é¦–å…ˆï¼Œæ‚¨éœ€è¦è°ƒæŸ¥ç½‘ç«™å¦‚ä½•æ ¼å¼åŒ–å…¶ä¿¡æ¯ã€‚ä»¥è°·æ­Œé‡‘èžæœåŠ¡é¡µé¢ä¸ºä¾‹ï¼Œæ£€æŸ¥ç½‘é¡µæºä»£ç æ˜¾ç¤ºä»¥ä¸‹æ¨¡å¼é è¿‘é¡¶éƒ¨ï¼š

> | Â Â <meta content="17.09" itemprop="price" /> |
> | --- |
> | Â Â <meta content="+0.07" itemprop="priceChange" /> |
> | Â Â <meta content="0.41" itemprop="priceChangePercent" /> |
> | Â Â <meta content="2013-08-12T16:59:06Z" itemprop="quoteTime" /> |
> | Â Â <meta content="NYSE real-time data" itemprop="dataSource" /> |

å¦‚æžœæˆ‘ä»¬æœ‰ä¸€ä¸ªå¯ä»¥æœç´¢ Xexpr.v3 å¹¶æå–å…·æœ‰å±žæ€§å€¼"price"å’Œ"priceChange"çš„ XML å…ƒå…ƒç´ çš„å‡½æ•°ï¼Œé‚£ä¹ˆ stock-alert çš„å…¶ä½™éƒ¨åˆ†å°†éžå¸¸ç›´æŽ¥ã€‚

> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â PREFIXÂ "Https://www.google.com/finance?q=") |
> > > | --- |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â SIZEÂ 22)Â ;Â font size |
> > > | Â  |
> > > | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â dataÂ [priceÂ delta]) |
> > > | |Â Â Â Â Â Â Â Â Â ;Â StockWorld æ˜¯ä¸€ä¸ªç»“æž„ï¼š (åˆ›å»ºæ•°æ®  String  String) |
> > > | |Â Â Â Â Â Â Â Â Â | |
> > > | |Â Â Â Â Â Â Â Â Â ;Â String -> StockWorld |
> > > | |Â Â Â Â Â Â Â Â Â ;Â æ¯ 15 ç§’æ£€ç´¢è‚¡ç¥¨ä»·æ ¼åŠå…¶å˜åŠ¨ |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (stock-alertÂ co) |
> > > | |Â Â Â Â Â Â Â Â Â ([æœ¬åœ°](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) url ([å­—ç¬¦ä¸²è¿žæŽ¥](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-append%29%29) PREFIX co))) |
> > > | |Â Â Â Â Â Â Â Â Â ;Â [StockWorld -> StockWorld] |
> > > | |Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (retrieve-stock-dataÂ __w) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([æœ¬åœ°](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) x ([è¯»å–-xexpr/web](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-xexpr%2Fweb%29%29) url))) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â (åˆ›å»ºæ•°æ®Â (getÂ xÂ "price") |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (getÂ xÂ "priceChange")))) |
> > > | |Â Â Â Â Â Â Â Â Â ;Â StockWorld -> Image |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (æ¸²æŸ“è‚¡ç¥¨æ•°æ® w) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([æœ¬åœ°](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (;Â [StockWorld String -> String] -> Image |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (wordÂ selÂ col) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([æ–‡æœ¬](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29)Â (selÂ w)Â SIZEÂ col))) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â ([overlay](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29)Â ([beside](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%29%29)Â (wordÂ data-priceÂ 'black) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([text](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29)Â "Â Â "Â SIZEÂ 'white) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (wordÂ data-deltaÂ 'red)) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([rectangle](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29)Â 300Â 35Â 'solidÂ 'white))))) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([big-bang](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29)Â (retrieve-stock-dataÂ 'no-use) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [[on-tick](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29)Â retrieve-stock-dataÂ 15] |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â [[to-draw](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29)Â render-stock-data]]) |
> > > 
> å›¾ 133ï¼šç½‘ç»œæ•°æ®ä½œä¸ºäº‹ä»¶

ç”±äºŽè¯¥ç½‘ç»œæœåŠ¡ä¸å†æä¾›è‚¡ç¥¨æŠ¥ä»·ï¼Œå› æ­¤æ— æ³•å®Œæˆæ­¤ç»ƒä¹ ã€‚

å›¾ 133 æ˜¾ç¤ºäº†ç¨‹åºçš„æ ¸å¿ƒã€‚get çš„è®¾è®¡ç•™ç»™ç»ƒä¹ ï¼Œå› ä¸ºå…¶å·¥ä½œå…¨éƒ¨å…³äºŽäº¤ç»‡çš„æ•°æ®ã€‚

å¦‚å›¾æ‰€ç¤ºï¼Œä¸»å‡½æ•°å®šä¹‰äº†ä¸¤ä¸ªå±€éƒ¨å‡½æ•°ï¼šä¸€ä¸ªæ—¶é’Ÿæ»´ç­”å¤„ç†ç¨‹åºå’Œä¸€ä¸ªæ¸²æŸ“å‡½æ•°ã€‚[big-bang](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29)è§„èŒƒè¦æ±‚æ—¶é’Ÿæ¯ 15 ç§’æ»´ç­”ä¸€æ¬¡ã€‚å½“æ—¶é’Ÿæ»´ç­”æ—¶ï¼ŒISL+å°† retrieve-stock-data åº”ç”¨äºŽå½“å‰ä¸–ç•Œï¼Œä½†å®ƒå¿½ç•¥äº†ã€‚ç›¸åï¼Œè¯¥å‡½æ•°é€šè¿‡[read-xexpr/web](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-xexpr%2Fweb%29%29)è®¿é—®ç½‘ç«™ï¼Œå¹¶ä½¿ç”¨ get æå–é€‚å½“çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œæ–°ä¸–ç•Œæ˜¯ç”±ç½‘ç»œä¸Šæ–°å¯ç”¨çš„ä¿¡æ¯åˆ›å»ºçš„ï¼Œè€Œä¸æ˜¯æŸäº›æœ¬åœ°æ•°æ®ã€‚

ç»ƒä¹  384ã€‚å›¾ 133 æåˆ°äº†[read-xexpr/web](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-xexpr%2Fweb%29%29)ã€‚å‚è§å›¾ 132 äº†è§£å…¶ç­¾åå’Œç›®çš„è¯´æ˜Žï¼Œç„¶åŽé˜…è¯»å…¶æ–‡æ¡£ä»¥ç¡®å®šå…¶ä¸Žâ€œæ™®é€šâ€ç›¸å¯¹çš„å·®å¼‚ã€‚

å›¾ 133 è¿˜ç¼ºå°‘å‡ ä¸ªé‡è¦éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯æ‰€æœ‰æœ¬åœ°å®šä¹‰å‡½æ•°çš„æ•°æ®è§£é‡Šå’Œç›®çš„è¯´æ˜Žã€‚åˆ¶å®šç¼ºå¤±çš„éƒ¨åˆ†ï¼Œä»¥ä¾¿ç†è§£ç¨‹åºã€‚

ç»ƒä¹  385ã€‚åœ¨è°·æ­Œé‡‘èžæœåŠ¡é¡µé¢ä¸ŠæŸ¥æ‰¾ä½ æœ€å–œæ¬¢çš„å…¬å¸çš„å½“å‰è‚¡ä»·ã€‚å¦‚æžœä½ æ²¡æœ‰å–œæ¬¢çš„å…¬å¸ï¼Œé€‰æ‹©ç¦ç‰¹ã€‚ç„¶åŽå°†é¡µé¢çš„æºä»£ç ä¿å­˜ä¸ºå·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶ã€‚ä½¿ç”¨ DrRacket ä¸­çš„[read-xexpr](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-xexpr%29%29)æŸ¥çœ‹æºä»£ç ä½œä¸º Xexpr.v3ã€‚

ç»ƒä¹  386ã€‚ä»¥ä¸‹æ˜¯ get å‡½æ•°ï¼š

> | ;Â Xexpr.v3  String -> String |
> | --- |
> | ;Â æ£€ç´¢"content"å±žæ€§çš„å€¼ |
> | ä»Žå…·æœ‰â€œitempropâ€å±žæ€§çš„â€œmeta å…ƒç´ â€ä¸­èŽ·å– |
> | ;Â å¸¦æœ‰å€¼ s |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29) |
> |   (get '(meta ((content "+1") (itemprop "F"))) "F") |
> |   "+1") |
> |   |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (get-xexpr x s) |
> |   ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)(([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) result (get-xexpr x s))) |
> |   ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29) ([string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29) result) |
> |   result |
> |   ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29) "æœªæ‰¾åˆ°")))) |

å®ƒå‡è®¾å­˜åœ¨ get-xexpr å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨ä»»æ„çš„ Xexpr.v3 ä¸­æœç´¢æ‰€éœ€çš„å±žæ€§ï¼Œå¹¶ç”Ÿæˆ[Maybe String]ã€‚

åˆ¶å®šæµ‹è¯•ç”¨ä¾‹ï¼Œå¯»æ‰¾é™¤äº†"F"ä¹‹å¤–çš„å…¶ä»–å€¼ï¼Œå¹¶è¿«ä½¿ get å‘å‡ºé”™è¯¯ä¿¡å·ã€‚

è®¾è®¡ get-xexprã€‚ä»Ž get å‡½æ•°çš„ç¤ºä¾‹ä¸­æŽ¨å¯¼å‡ºè¯¥å‡½æ•°çš„åŠŸèƒ½ç¤ºä¾‹ã€‚å°†è¿™äº›ç¤ºä¾‹æŽ¨å¹¿ï¼Œä»¥ä¾¿ä½ ç¡®ä¿¡ get-xexpr å¯ä»¥éåŽ†ä»»æ„çš„ Xexpr.v3ã€‚æœ€åŽï¼Œåˆ¶å®šä¸€ä¸ªæµ‹è¯•ï¼Œä½¿ç”¨å­˜å‚¨åœ¨ç»ƒä¹  385 ä¸­çš„ç½‘é¡µæ•°æ®ã€‚

### 23 åŒæ—¶å¤„ç†ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ä¸€äº›å‡½æ•°å¿…é¡»æ¶ˆè´¹å±žäºŽå…·æœ‰éžå¹³å‡¡æ•°æ®å®šä¹‰çš„ç±»çš„ä¸¤ä¸ªå‚æ•°ã€‚å¦‚ä½•è®¾è®¡è¿™æ ·çš„å‡½æ•°å–å†³äºŽå‚æ•°ä¹‹é—´çš„å…³ç³»ã€‚é¦–å…ˆï¼Œå¯èƒ½éœ€è¦å°†å…¶ä¸­ä¸€ä¸ªå‚æ•°è§†ä¸ºåŽŸå­ã€‚å…¶æ¬¡ï¼Œå‡½æ•°å¯èƒ½å¿…é¡»åŒæ­¥å¤„ç†ä¸¤ä¸ªå‚æ•°ã€‚æœ€åŽï¼Œå‡½æ•°å¯èƒ½æ ¹æ®æ‰€æœ‰å¯èƒ½çš„æƒ…å†µå¤„ç†ç»™å®šæ•°æ®ã€‚æœ¬ç« é€šè¿‡ç¤ºä¾‹è¯´æ˜Žäº†ä¸‰ç§æƒ…å†µï¼Œå¹¶æä¾›äº†å¢žå¼ºçš„è®¾è®¡é…æ–¹ã€‚æœ€åŽä¸€èŠ‚è®¨è®ºäº†å¤åˆæ•°æ®çš„ç­‰ä»·æ€§ã€‚

#### 23.1 åŒæ—¶å¤„ç†ä¸¤ä¸ªåˆ—è¡¨ï¼šæ¡ˆä¾‹ 1ðŸ”— "é“¾æŽ¥è‡³æ­¤")

è€ƒè™‘ä»¥ä¸‹ç­¾åã€ç›®çš„å£°æ˜Žå’Œå¤´ï¼š

> | ;Â [List-of  Number] [List-of  Number] -> [List-of  Number] |
> | --- |
> | ;Â å°†å‰ç«¯æœ«å°¾çš„ '()' æ›¿æ¢ä¸º end |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (replace-eol-withÂ frontÂ end) |
> | å‰ç«¯ |

ç­¾åè¡¨æ˜Žè¯¥å‡½æ•°æ¶ˆè´¹ä¸¤ä¸ªåˆ—è¡¨ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è®¾è®¡é…æ–¹åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬é¦–å…ˆé€šè¿‡ç¤ºä¾‹æ¥å·¥ä½œã€‚å¦‚æžœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ '()ï¼Œreplace-eol-with å¿…é¡»äº§ç”Ÿç¬¬äºŒä¸ªå‚æ•°ï¼Œæ— è®ºå®ƒæ˜¯ä»€ä¹ˆï¼š

> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (replace-eol-withÂ '()Â '(aÂ b))Â '(aÂ b))

ç›¸åï¼Œå¦‚æžœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ '()ï¼Œç›®çš„å£°æ˜Žè¦æ±‚æˆ‘ä»¬å°†å‰ç«¯æœ«å°¾çš„ '() æ›¿æ¢ä¸º endï¼š

> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (replace-eol-withÂ ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 1Â '())Â '(a)) |
> | --- |
> | Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 1Â '(a))) |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (replace-eol-with |
> | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 2Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 1Â '()))Â '(a)) |
> | ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) 2  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) 1  '(a)))) |

ç›®çš„å£°æ˜Žå’Œç¤ºä¾‹è¡¨æ˜Žï¼Œåªè¦ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå‡½æ•°å°±ä¸éœ€è¦äº†è§£ä»»ä½•å…³äºŽå®ƒçš„ä¿¡æ¯ã€‚ç”±æ­¤æŽ¨æ–­ï¼Œå…¶æ¨¡æ¿åº”è¯¥æ˜¯å…³äºŽç¬¬ä¸€ä¸ªå‚æ•°çš„åˆ—è¡¨å¤„ç†å‡½æ•°ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)  (replace-eol-with  front  end)) |
> | --- |
> |    ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> |    [([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  front)  [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> |   [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> |    ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)  ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)  front)  [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) |
> |    [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)  (replace-eol-with  ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  front)  end)  [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))])) |

æŒ‰ç…§è®¾è®¡é£Ÿè°±çš„ç¬¬äº”æ­¥ï¼Œè®©æˆ‘ä»¬åœ¨æ¨¡æ¿ä¸­å¡«è¡¥ç©ºç™½ã€‚å¦‚æžœå‰ç¼€æ˜¯ '(), åˆ™ replace-eol-with äº§ç”Ÿ endã€‚å¦‚æžœå‰ç¼€ä¸æ˜¯ '(), æˆ‘ä»¬å¿…é¡»å›žå¿†æ¨¡æ¿è¡¨è¾¾å¼è®¡ç®—çš„å†…å®¹ï¼š

+   ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)  front) è¯„ä¼°ä¸ºåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶ä¸”

+   (replace-eol-with  ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  front)  end) å°† ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  front) ä¸­çš„æœ€ç»ˆ '()' æ›¿æ¢ä¸º endã€‚

åœæ­¢ï¼ä½¿ç”¨è¡¨æ ¼æ–¹æ³•æ¥ç†è§£è¿™äº›é¡¹ç›®å¯¹äºŽè¿è¡Œç¤ºä¾‹çš„æ„ä¹‰ã€‚ä»Žè¿™é‡Œåˆ°å®Œæ•´å®šä¹‰åªæœ‰ä¸€å°æ­¥ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (replace-eol-withÂ frontÂ end) |
> | --- |
> | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | ([([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â front)Â end] |
> | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> | Â Â Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â front) |
> | Â Â Â Â Â Â Â Â Â Â Â (replace-eol-withÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â front)Â end))])) |

ç»ƒä¹  387ã€‚è®¾è®¡äº¤å‰ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªç¬¦å·åˆ—è¡¨å’Œä¸€ä¸ªæ•°å­—åˆ—è¡¨ï¼Œå¹¶ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ç¬¦å·å’Œæ•°å­—çš„æœ‰åºå¯¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç»™å®š '(a  b  c) å’Œ '(1  2) æ—¶ï¼Œé¢„æœŸçš„ç»“æžœæ˜¯ '((a  1)  (a  2)  (b  1)  (b  2)  (c  1)  (c  2))ã€‚

#### 23.2 åŒæ—¶å¤„ç†ä¸¤ä¸ªåˆ—è¡¨ï¼šæƒ…å†µ 2ðŸ”— "é“¾æŽ¥è‡³æ­¤")

ç”Ÿæˆåˆ—è¡¨çš„å‡½æ•°ä»‹ç»äº†å‡½æ•° wages*ï¼Œå®ƒæ ¹æ®å·¥äººçš„å·¥ä½œæ—¶é—´è®¡ç®—æŸäº›å·¥äººçš„å‘¨å·¥èµ„ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªæ•°å­—åˆ—è¡¨ï¼Œä»£è¡¨æ¯å‘¨çš„å·¥ä½œå°æ—¶æ•°ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªæ•°å­—åˆ—è¡¨ï¼Œè¿™äº›æ•°å­—æ˜¯ç›¸åº”çš„å‘¨å·¥èµ„ã€‚è™½ç„¶é—®é¢˜å‡è®¾æ‰€æœ‰å‘˜å·¥éƒ½èŽ·å¾—äº†ç›¸åŒçš„å·¥èµ„çŽ‡ï¼Œå³ä½¿æ˜¯å°åž‹å…¬å¸ä¹Ÿä¼šæ”¯ä»˜ç»™å·¥äººä¸åŒçš„å·¥èµ„ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¨å¾®æ›´çŽ°å®žä¸€ç‚¹çš„ç‰ˆæœ¬ã€‚è¯¥å‡½æ•°çŽ°åœ¨æ¶ˆè€—ä¸¤ä¸ªåˆ—è¡¨ï¼šå·¥ä½œæ—¶é—´åˆ—è¡¨å’Œç›¸åº”çš„æ¯å°æ—¶å·¥èµ„åˆ—è¡¨ã€‚æˆ‘ä»¬å°†è¿™ä¸ªä¿®è®¢çš„é—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªä¿®è®¢çš„æ ‡é¢˜ï¼š

> | ;Â [List-of  Number] [List-of  Number] -> [List-of  Number] |
> | --- |
> | ;Â å¯¹åº”é¡¹ç›¸ä¹˜ |
> | ;Â hours å’Œ wages/h |
> | ;Â å‡è®¾ä¸¤ä¸ªåˆ—è¡¨é•¿åº¦ç›¸ç­‰ |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (wages*.v2Â hoursÂ wages/h) |
> | Â Â '()) |

æž„é€ ç¤ºä¾‹å¾ˆç®€å•ï¼š

> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (wages*.v2Â '()Â '())Â '()) |
> | --- |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (wages*.v2Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 5.65)Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 40)) |
> | Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 226.0)) |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (wages*.v2Â '(5.65Â 8.75)Â '(40.0Â 30.0)) |
> | Â Â Â Â Â Â Â Â Â Â Â Â Â Â '(226.0Â 262.5)) |

å¦‚è¦æ±‚ï¼Œæ‰€æœ‰ä¸‰ä¸ªç¤ºä¾‹éƒ½ä½¿ç”¨é•¿åº¦ç›¸ç­‰çš„åˆ—è¡¨ã€‚å…³äºŽè¾“å…¥çš„å‡è®¾ä¹Ÿå¯ä»¥ç”¨äºŽæ¨¡æ¿çš„å¼€å‘ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œæ¡ä»¶è¡¨æ˜Žå½“([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  hours)ä¸ºçœŸæ—¶ï¼Œ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  wages/h)ä¹Ÿä¸ºçœŸï¼Œå¹¶ä¸”å½“([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)  hours)ä¸ºçœŸæ—¶ï¼Œ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)  wages/h)ä¹Ÿä¸ºçœŸã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡æ¿ä¸­çš„ä¸€ä¸ªåˆ—è¡¨ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (wages*.v2 hours wages/h)) |
> | --- |
> | [[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | [[empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) hours) [...] |
> | [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> | ... hours) |
> | ... wages/h) [...] |
> | ... ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) hours) ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) wages/h)))])) |

åœ¨ç¬¬ä¸€ä¸ª[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥ä¸­ï¼Œhours å’Œ wages/h éƒ½æ˜¯ '(). å› æ­¤ä¸éœ€è¦é€‰æ‹©è¡¨è¾¾å¼ã€‚åœ¨ç¬¬äºŒä¸ªå­å¥ä¸­ï¼Œhours å’Œ wages/h éƒ½æ˜¯æž„é€ åˆ—è¡¨ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦å››ä¸ªé€‰æ‹©è¡¨è¾¾å¼ã€‚æœ€åŽï¼Œå› ä¸ºæœ€åŽä¸¤ä¸ªåˆ—è¡¨é•¿åº¦ç›¸ç­‰ï¼Œå®ƒä»¬è‡ªç„¶æˆä¸º wages*.v2 çš„è‡ªç„¶é€’å½’çš„å€™é€‰ã€‚

è¿™ä¸ªæ¨¡æ¿çš„å”¯ä¸€ä¸å¯»å¸¸ä¹‹å¤„åœ¨äºŽï¼Œé€’å½’åº”ç”¨ç”±ä¸¤ä¸ªè¡¨è¾¾å¼ç»„æˆï¼Œè¿™ä¸¤ä¸ªè¡¨è¾¾å¼éƒ½æ˜¯ä¸¤ä¸ªå‚æ•°çš„é€‰æ‹©è¡¨è¾¾å¼ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªæƒ³æ³•ç›´æŽ¥æºäºŽè¿™ä¸ªå‡è®¾ã€‚

ä»Žè¿™é‡Œï¼Œåˆ°å®Œæ•´çš„å‡½æ•°å®šä¹‰åªæœ‰ä¸€å°æ­¥ä¹‹é¥ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (wages*.v2Â hoursÂ wages/h) |
> | --- |
> | ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | Â Â Â Â [([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â hours)Â '()] |
> | Â Â Â Â [[else](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> | Â Â Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) |
> | Â Â Â Â Â Â Â (weekly-wageÂ ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â hours)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â wages/h)) |
> | Â Â Â Â Â Â Â (wages*.v2Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â hours)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â wages/h)))])) |

ç¬¬ä¸€ä¸ªç¤ºä¾‹è¡¨æ˜Žï¼Œç¬¬ä¸€ä¸ª [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) æ¡ä»¶çš„ç­”æ¡ˆæ˜¯ '(). åœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªå¯ç”¨çš„å€¼ï¼š

1.  ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)  hours), è¡¨ç¤ºæ¯å‘¨å°æ—¶æ•°çš„ç¬¬ä¸€ä½ï¼›

1.  ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)  wages/h), è¿™æ˜¯ç¬¬ä¸€ä¸ªå·¥èµ„çŽ‡ï¼›å¹¶ä¸”

1.  (wages*.v2  ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  hours)  ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  wages/h)), æ ¹æ®ç›®çš„å£°æ˜Žï¼Œè®¡ç®—ä¸¤ä¸ªåˆ—è¡¨å‰©ä½™éƒ¨åˆ†çš„æ¯å‘¨å·¥èµ„åˆ—è¡¨ã€‚

çŽ°åœ¨æˆ‘ä»¬åªéœ€è¦å°†è¿™äº›å€¼ç»„åˆèµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆç­”æ¡ˆã€‚æ­£å¦‚ç¤ºä¾‹æ‰€å»ºè®®çš„ï¼Œæˆ‘ä»¬å¿…é¡»è®¡ç®—ç¬¬ä¸€ä¸ªå‘˜å·¥çš„æ¯å‘¨å·¥èµ„ï¼Œå¹¶ä»Žè¯¥å·¥èµ„å’Œå‰©ä½™å·¥èµ„ä¸­æž„é€ ä¸€ä¸ªåˆ—è¡¨ï¼š

> | ï¼ˆ[cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) (weekly-wage ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) å°æ—¶) ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) å·¥èµ„/å°æ—¶))) |
> | --- |
> | ï¼ˆwages*.v2 ï¼ˆ[rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) å°æ—¶ï¼‰([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) å·¥èµ„/å°æ—¶))) |

è¾…åŠ©å‡½æ•° weekly-wage ä½¿ç”¨å·¥ä½œå°æ—¶æ•°å’Œå·¥èµ„çŽ‡æ¥è®¡ç®—ä¸€ä¸ªå·¥äººçš„å‘¨å·¥èµ„ï¼š

> | ; Number Number -> Number |
> | --- |
> | è®¡ç®—ä»Žå·¥èµ„çŽ‡å’Œå°æ—¶æ•°ä¸­å¾—å‡ºçš„å‘¨å·¥èµ„ |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (weekly-wage pay-rate hours) |
> | ï¼ˆ[*](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29) å·¥èµ„çŽ‡ å°æ—¶)) |

åœæ­¢ï¼å¦‚æžœä½ æƒ³è¦è®¡ç®—ä¸€ä¸ªå·¥äººçš„å·¥èµ„ï¼Œä½ éœ€è¦ä½¿ç”¨å“ªä¸ªå‡½æ•°ï¼Ÿå¦‚æžœä½ æƒ³è¦å¤„ç†æ‰€å¾—ç¨Žï¼Œä½ éœ€è¦ä¿®æ”¹å“ªä¸ªå‡½æ•°ï¼Ÿ

ç»ƒä¹  388ã€‚åœ¨çŽ°å®žä¸–ç•Œä¸­ï¼Œwages*.v2 æ¶ˆè€—å‘˜å·¥ç»“æž„å’Œå·¥ä½œè®°å½•åˆ—è¡¨ã€‚å‘˜å·¥ç»“æž„åŒ…å«å‘˜å·¥çš„å§“åã€ç¤¾ä¼šä¿é™©å·å’Œå·¥èµ„çŽ‡ã€‚å·¥ä½œè®°å½•ä¹ŸåŒ…å«å‘˜å·¥çš„å§“åå’Œä¸€å‘¨å†…å·¥ä½œçš„å°æ—¶æ•°ã€‚ç»“æžœæ˜¯åŒ…å«å‘˜å·¥å§“åå’Œå‘¨å·¥èµ„çš„ç»“æž„åˆ—è¡¨ã€‚

ä¿®æ”¹æœ¬èŠ‚ä¸­çš„ç¨‹åºï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†è¿™äº›çŽ°å®žç‰ˆæœ¬çš„æ•°æ®ã€‚æä¾›å¿…è¦çš„ç»“æž„ç±»åž‹å®šä¹‰å’Œæ•°æ®å®šä¹‰ã€‚ä½¿ç”¨è®¾è®¡é£Ÿè°±æ¥æŒ‡å¯¼ä¿®æ”¹è¿‡ç¨‹ã€‚

ç»ƒä¹  389ã€‚è®¾è®¡ zip å‡½æ•°ï¼Œå®ƒæŽ¥å—ä¸€ä¸ªè¡¨ç¤ºä¸ºå­—ç¬¦ä¸²çš„å§“ååˆ—è¡¨å’Œä¸€ä¸ªè¡¨ç¤ºä¸ºå­—ç¬¦ä¸²çš„ç”µè¯å·ç åˆ—è¡¨ã€‚å®ƒå°†è¿™äº›ç­‰é•¿çš„åˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªç”µè¯è®°å½•åˆ—è¡¨ï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29) phone-record [name number]) |
> | --- |
> | ; ä¸€ä¸ª PhoneRecord æ˜¯ä¸€ä¸ªç»“æž„ï¼š |
> | ï¼ˆmake-phone-record String String) |

å‡è®¾ç›¸åº”çš„åˆ—è¡¨é¡¹å±žäºŽåŒä¸€ä¸ªäººã€‚

#### 23.3 åŒæ—¶å¤„ç†ä¸¤ä¸ªåˆ—è¡¨ï¼šæƒ…å†µ 3ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

è¿™é‡Œæ˜¯ç¬¬ä¸‰ç§ç±»åž‹çš„é—®é¢˜ï¼š

> ç¤ºä¾‹é—®é¢˜ç»™å®šä¸€ä¸ªç¬¦å·åˆ—è¡¨ los å’Œä¸€ä¸ªè‡ªç„¶æ•° nï¼Œå‡½æ•° list-pick ä»Ž los ä¸­æå–ç¬¬ n ä¸ªç¬¦å·ï¼›å¦‚æžœæ²¡æœ‰è¿™æ ·çš„ç¬¦å·ï¼Œåˆ™å¼•å‘é”™è¯¯ã€‚

é—®é¢˜æ˜¯è®¾è®¡æ–¹æ¡ˆå¯¹äºŽ list-pick çš„è®¾è®¡æ•ˆæžœå¦‚ä½•ã€‚è™½ç„¶çŽ°åœ¨å¯¹ç¬¦å·åˆ—è¡¨çš„æ•°æ®å®šä¹‰å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œä½†è¯·å›žå¿†ä¸€ä¸‹æ¥è‡ª è‡ªç„¶æ•° çš„è‡ªç„¶æ•°ç±»ã€‚

> | ;Â N æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š |
> | --- |
> | ;Â â€“  0 |
> | ;Â â€“  ([add1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._add1%29%29)  N) |

çŽ°åœ¨æˆ‘ä»¬å¯ä»¥è¿›è¡Œç¬¬äºŒæ­¥ï¼š

> | ;Â [List-of  Symbol] N -> Symbol |
> | --- |
> | ;Â ä»Ž l ä¸­æå–ç¬¬ n ä¸ªç¬¦å·ï¼› |
> | ;Â å¦‚æžœæ²¡æœ‰è¿™æ ·çš„ç¬¦å·ï¼Œåˆ™å¼•å‘é”™è¯¯ |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (list-pickÂ lÂ n) |
> | Â Â 'a) |

ç¬¦å·åˆ—è¡¨å’Œè‡ªç„¶æ•°åˆ—è¡¨éƒ½æ˜¯å…·æœ‰å¤æ‚æ•°æ®å®šä¹‰çš„ç±»ã€‚è¿™ç§ç»„åˆä½¿å¾—é—®é¢˜å˜å¾—éžæ ‡å‡†ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»åœ¨è®¾è®¡æ–¹æ¡ˆçš„æ¯ä¸€æ­¥éƒ½æ³¨æ„æ¯ä¸€ä¸ªç»†èŠ‚ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæŒ‘é€‰ä¸€äº›è¾“å…¥ç¤ºä¾‹ï¼Œå¹¶ç¡®å®šæœŸæœ›çš„è¾“å‡ºæ˜¯ä»€ä¹ˆã€‚æˆ‘ä»¬ä»Žå‡½æ•°å¿…é¡»å®Œç¾Žå·¥ä½œçš„è¾“å…¥å¼€å§‹ï¼š'(a b c) å’Œ 2ã€‚å¯¹äºŽä¸‰ä¸ªç¬¦å·çš„åˆ—è¡¨å’Œç´¢å¼• 2ï¼Œlist-pick å¿…é¡»è¿”å›žä¸€ä¸ªç¬¦å·ã€‚é—®é¢˜æ˜¯å®ƒæ˜¯ 'b è¿˜æ˜¯ 'cã€‚åœ¨å°å­¦ï¼Œä½ ä¼šæ•° 1ã€2ï¼Œç„¶åŽæ¯«ä¸çŠ¹è±«åœ°é€‰æ‹© 'bã€‚ä½†è¿™æ˜¯è®¡ç®—æœºç§‘å­¦ï¼Œè€Œä¸æ˜¯å°å­¦ã€‚åœ¨è¿™é‡Œï¼Œäººä»¬ä»Ž 0 å¼€å§‹è®¡æ•°ï¼Œè¿™æ„å‘³ç€ 'c æ˜¯ä¸€ä¸ªåŒæ ·åˆé€‚çš„é€‰æ‹©ã€‚äº‹å®žä¸Šï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„é€‰æ‹©ï¼š

> ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (list-pickÂ '(aÂ bÂ c)Â 2)Â 'c)

çŽ°åœ¨æˆ‘ä»¬å·²ç»æ¶ˆé™¤äº† list-pick çš„è¿™ä¸ªç»†å¾®ä¹‹å¤„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®žé™…çš„é—®é¢˜ï¼Œå³è¾“å…¥çš„é€‰æ‹©ã€‚ç¤ºä¾‹æ­¥éª¤çš„ç›®æ ‡æ˜¯å°½å¯èƒ½è¦†ç›–è¾“å…¥ç©ºé—´ã€‚æˆ‘ä»¬é€šè¿‡åœ¨å¤æ‚æ•°æ®å½¢å¼çš„æè¿°ä¸­ä¸ºæ¯ä¸ªå­å¥é€‰æ‹©ä¸€ä¸ªè¾“å…¥æ¥å®žçŽ°è¿™ä¸€ç‚¹ã€‚åœ¨è¿™é‡Œï¼Œè¿™ä¸ªç¨‹åºå»ºè®®æˆ‘ä»¬è‡³å°‘ä»Žæ¯ä¸ªç±»åˆ«ä¸­é€‰æ‹©ä¸¤ä¸ªå…ƒç´ ï¼Œå› ä¸ºæ¯ä¸ªæ•°æ®å®šä¹‰éƒ½æœ‰ä¸¤ä¸ªå­å¥ã€‚æˆ‘ä»¬ä¸ºç¬¬ä¸€ä¸ªå‚æ•°é€‰æ‹© '() å’Œ ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  'a  '()))ï¼Œå¹¶ä¸ºåŽè€…é€‰æ‹© 0 å’Œ 3ã€‚æ¯ä¸ªå‚æ•°ä¸¤ä¸ªé€‰æ‹©æ„å‘³ç€æ€»å…±æœ‰å››ä¸ªç¤ºä¾‹ï¼›æ¯•ç«Ÿï¼Œä¸¤ä¸ªå‚æ•°ä¹‹é—´æ²¡æœ‰ç«‹å³æ˜Žæ˜¾çš„å…³ç³»ï¼Œä¹Ÿæ²¡æœ‰åœ¨ç­¾åä¸­çš„é™åˆ¶ã€‚

ç»“æžœè¡¨æ˜Žï¼Œåªæœ‰è¿™äº›é…å¯¹ä¸­çš„ä¸€ç§äº§ç”Ÿäº†æ­£ç¡®çš„ç»“æžœï¼›å…¶ä½™çš„ç”±äºŽåˆ—è¡¨ä¸­ç¬¦å·ä¸è¶³ï¼Œé€‰æ‹©äº†ä¸€ä¸ªä¸å­˜åœ¨çš„ä½ç½®ï¼š

> | ([check-error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-error%29%29)Â (list-pickÂ '()Â 0)Â "list too short") |
> | --- |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (list-pickÂ ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â 'aÂ '())Â 0)Â 'a) |
> | ([check-error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-error%29%29)Â (list-pickÂ '()Â 3)Â "list too short") |

å‡½æ•°é¢„æœŸä¼šå‘å‡ºé”™è¯¯ä¿¡å·ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé€‰æ‹©æˆ‘ä»¬å–œæ¬¢çš„æ¶ˆæ¯ã€‚

åœæ­¢ï¼å°†è¿™äº›ç‰‡æ®µæ”¾å…¥ DrRacket çš„å®šä¹‰åŒºåŸŸå¹¶è¿è¡Œéƒ¨åˆ†ç¨‹åºã€‚

å¯¹ç¤ºä¾‹çš„è®¨è®ºè¡¨æ˜Žï¼Œæˆ‘ä»¬ç¡®å®žéœ€è¦æ£€æŸ¥å››ä¸ªç‹¬ç«‹çš„æƒ…å†µæ¥è®¾è®¡è¿™ä¸ªå‡½æ•°ã€‚å‘çŽ°è¿™äº›æƒ…å†µçš„ä¸€ç§æ–¹æ³•æ˜¯å°†æ¯ä¸ªå­å¥çš„æ¡ä»¶æŽ’åˆ—æˆä¸€ä¸ªäºŒç»´è¡¨ï¼š

> |  |  | ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  l) |  | ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)  l) |
> | --- | --- | --- | --- | --- |
> | ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)  n  0) |  |  |  |  |
> | ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)  n  0) |  |  |  |  |

è¡¨æ ¼çš„æ°´å¹³ç»´åº¦åˆ—å‡ºäº† list-pick å¿…é¡»è¯¢é—®åˆ—è¡¨çš„é—®é¢˜ï¼›åž‚ç›´ç»´åº¦åˆ—å‡ºäº†å…³äºŽè‡ªç„¶æ•°çš„é—®é¢˜ã€‚é€šè¿‡è¿™ç§å®‰æŽ’ï¼Œæˆ‘ä»¬è‡ªç„¶åœ°å¾—åˆ°å››ä¸ªæ–¹æ ¼ï¼Œæ¯ä¸ªæ–¹æ ¼ä»£è¡¨æ°´å¹³å’Œåž‚ç›´è½´ä¸Šçš„æ¡ä»¶éƒ½ä¸ºçœŸçš„æƒ…å†µã€‚æˆ‘ä»¬çš„è¡¨æ ¼è¡¨æ˜Žï¼Œå‡½æ•°æ¨¡æ¿çš„[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)æœ‰å››ä¸ªå­å¥ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†è¡¨æ ¼ä¸­æ¯ä¸ªæ–¹æ ¼çš„æ°´å¹³æ¡ä»¶å’Œåž‚ç›´æ¡ä»¶è¿›è¡Œ[and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)æ“ä½œæ¥æ‰¾å‡ºæ¯ä¸ªå­å¥çš„é€‚å½“æ¡ä»¶ï¼š

> |  |  | ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  l) |  | ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)  l) |
> | --- | --- | --- | --- | --- |
> | ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)  n  0) |  |
> 
> | ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â l) |  |
> 
> | ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)) |  |
> 
> |  |
> | --- |
> 
> | ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â l) |  |
> 
> | ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)) |  |
> 
> |
> 
> | ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)  n  0) |  |
> | --- | --- |
> 
> | ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â l) |  |
> 
> [>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0)) [>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0)) 
> 
> |  |
> | --- |
> 
> [and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) l) [and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) l) 
> 
> [>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0)) [>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0)) 
> 
> |

æ¨¡æ¿ä¸­çš„[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)ç»“æž„ä»…æ˜¯å°†æ­¤è¡¨è½¬æ¢ä¸ºæ¡ä»¶è¯­å¥ï¼š

> | [([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (list-pick l n) |
> | --- |
> | ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | [([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29) n 0) ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) l)) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)]  |
> | [([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0) ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) l)) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)]  |
> | Â Â Â Â [([å¹¶ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([åˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29))] [...] |
> | Â Â Â Â [([å¹¶ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0)Â ([åˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29))] [...] |

å¦‚åŒå¾€å¸¸ï¼Œ[æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) è¡¨è¾¾å¼å…è®¸æˆ‘ä»¬åŒºåˆ†å››ç§å¯èƒ½æ€§ï¼Œå¹¶åœ¨æ·»åŠ é€‰æ‹©è¡¨è¾¾å¼åˆ°æ¯ä¸ª [æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å­å¥æ—¶åˆ†åˆ«å…³æ³¨æ¯ä¸€ä¸ªï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (list-pickÂ lÂ n)) |
> | --- |
> | Â Â ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)) |
> | Â Â Â Â [([å¹¶ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([ç©ºï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29))] |
> | [...] |
> |   ([([å’Œ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0))Â ([åˆ—è¡¨ä¸ºç©º?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29))] |
> |   ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([å‡ 1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)Â n)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> |   ([([å’Œ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0))Â ([åˆ—è¡¨?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29))] |
> |   ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â l)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([åˆ—è¡¨çš„å…¶ä½™éƒ¨åˆ†](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â l)[...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)] |
> |   ([([å’Œ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0))Â ([åˆ—è¡¨?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29))] |
> | |Â Â Â Â ([...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([sub1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)Â n)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â l)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â l)Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))])) |

ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œlï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå¹¶ä¸”æ¨¡æ¿çš„[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥å¯¹äºŽéžç©ºåˆ—è¡¨åŒ…å«ä¸¤ä¸ªé€‰æ‹©è¡¨è¾¾å¼ã€‚ç¬¬äºŒä¸ªå‚æ•°ï¼Œnï¼Œå±žäºŽ Nï¼Œå¹¶ä¸”æ¨¡æ¿çš„[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥å¯¹äºŽéž 0 æ•°å­—åªéœ€è¦ä¸€ä¸ªé€‰æ‹©è¡¨è¾¾å¼ã€‚åœ¨é‚£äº›è¦ä¹ˆ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  l)è¦ä¹ˆ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)  n  0)æˆç«‹çš„æƒ…å½¢ä¸­ï¼Œç›¸åº”çš„å‚æ•°æ˜¯åŽŸå­çš„ï¼Œå¹¶ä¸”ä¸éœ€è¦ç›¸åº”çš„é€‰æ‹©è¡¨è¾¾å¼ã€‚æ¨¡æ¿æž„å»ºçš„æœ€åŽä¸€æ­¥è¦æ±‚æˆ‘ä»¬åœ¨æ¨¡æ¿ä¸Šæ ‡æ³¨é€’å½’ï¼Œå…¶ä¸­é€‰æ‹©è¡¨è¾¾å¼çš„ç»“æžœå±žäºŽä¸Žè¾“å…¥ç›¸åŒçš„ç±»åˆ«ã€‚å¯¹äºŽè¿™ä¸ªç¬¬ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å…³æ³¨æœ€åŽçš„[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªå‚æ•°çš„é€‰æ‹©è¡¨è¾¾å¼ã€‚ç„¶è€Œï¼Œå¦‚ä½•å½¢æˆè‡ªç„¶çš„é€’å½’è¿˜ä¸æ¸…æ¥šã€‚å¦‚æžœæˆ‘ä»¬ä¸è€ƒè™‘å‡½æ•°çš„ç›®çš„ï¼Œæœ‰ä¸‰ç§å¯èƒ½çš„é€’å½’æ–¹å¼ï¼š

1.  (list-pick  ([å‰©ä½™éƒ¨åˆ†](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  l)  ([å‡ 1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)  n))

1.  (list-pick  l  ([å‡ 1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)  n))

1.  (list-pick  ([å‰©ä½™éƒ¨åˆ†](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)  l)  n)

æ¯ä¸€ä¸ªéƒ½ä»£è¡¨å¯ç”¨è¡¨è¾¾å¼çš„å¯è¡Œç»„åˆã€‚ç”±äºŽæˆ‘ä»¬æ— æ³•çŸ¥é“å“ªä¸€ä¸ªé‡è¦ï¼Œæˆ–è€…æ˜¯å¦ä¸‰ä¸ªéƒ½é‡è¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­åˆ°ä¸‹ä¸€ä¸ªå¼€å‘é˜¶æ®µã€‚

> > > | ;Â [ç¬¦å·åˆ—è¡¨  ç¬¦å·] N -> ç¬¦å· |
> > > | --- |
> > > | ;Â ä»Žåˆ—è¡¨ä¸­æå–ç¬¬ n ä¸ªç¬¦å·ï¼› |
> > > | ;Â å¦‚æžœæ²¡æœ‰è¿™æ ·çš„ç¬¦å·ï¼Œåˆ™å‘å‡ºé”™è¯¯ä¿¡å· |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (list-pickÂ lÂ n) |
> > > | Â Â ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â [([å’Œ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([ç©ºåˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â l)) |
> > > | Â Â Â Â Â ([é”™è¯¯](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â 'list-pickÂ "åˆ—è¡¨å¤ªçŸ­")] |
> > > | Â Â Â Â [([å’Œ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0)Â ([ç©ºåˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â l)) |
> > > | Â Â Â Â Â ([é”™è¯¯](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â 'list-pickÂ "åˆ—è¡¨å¤ªçŸ­")] |
> > > | |Â Â Â [([å¹¶ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([åˆ—è¡¨è¿žæŽ¥ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â l))Â ([åˆ—è¡¨ç¬¬ä¸€ä¸ªå…ƒç´ ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â l)] |
> > > | |Â Â Â [([å¹¶ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0)Â ([åˆ—è¡¨è¿žæŽ¥ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â l))Â ([åˆ—è¡¨é€‰æ‹©](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list-pick%29%29)Â ([åˆ—è¡¨å‰©ä½™](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â l)Â ([å‡ 1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)Â n))])) |
> > > 
> å›¾Â 134ï¼šåˆ—è¡¨ç´¢å¼•

æŒ‰ç…§ç¬¬äº”æ­¥çš„è®¾è®¡é£Ÿè°±ï¼Œè®©æˆ‘ä»¬åˆ†æžæ¨¡æ¿ä¸­çš„æ¯ä¸ª[æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥ï¼Œå¹¶å†³å®šåˆé€‚çš„ç­”æ¡ˆï¼š

1.  å¦‚æžœ([å¹¶ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)  ([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)  n  0)  ([åˆ—è¡¨ä¸ºç©ºï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  l))æˆç«‹ï¼Œåˆ—è¡¨é€‰æ‹©å¿…é¡»ä»Žç©ºåˆ—è¡¨ä¸­é€‰æ‹©ç¬¬ä¸€ä¸ªç¬¦å·ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚ç­”æ¡ˆå¿…é¡»æ˜¯é”™è¯¯ä¿¡å·ã€‚

1.  å¦‚æžœ([å¹¶ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)  ([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)  n  0)  ([åˆ—è¡¨ä¸ºç©ºï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  l))æˆç«‹ï¼Œåˆ—è¡¨é€‰æ‹©å†æ¬¡è¢«è¦æ±‚ä»Žä¸€ä¸ªç©ºåˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªç¬¦å·ã€‚

1.  å¦‚æžœ ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29) n  0) ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) l)) æˆç«‹ï¼Œlist-pick åº”è¯¥ä»Ž l ä¸­äº§ç”Ÿç¬¬ä¸€ä¸ªç¬¦å·ã€‚é€‰æ‹©è¡¨è¾¾å¼ ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) l) æ˜¯ç­”æ¡ˆã€‚

1.  å¦‚æžœ ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n  0) ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) l)) æˆç«‹ï¼Œæˆ‘ä»¬å¿…é¡»åˆ†æžå¯ç”¨çš„è¡¨è¾¾å¼è®¡ç®—çš„å†…å®¹ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œå¯¹äºŽè¿™ä¸€æ­¥ï¼Œé€šè¿‡ä¸€ä¸ªçŽ°æœ‰çš„ä¾‹å­è¿›è¡Œæ“ä½œæ˜¯ä¸ªå¥½ä¸»æ„ã€‚æˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€ä¸ªä¾‹å­çš„ç®€çŸ­å˜ä½“ï¼š

    > ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29) (list-pick '(a b) 1) 'b)

    è¿™é‡Œæ˜¯è¿™ä¸‰ä¸ªè‡ªç„¶é€’å½’ä½¿ç”¨è¿™äº›å€¼è®¡ç®—çš„ç»“æžœï¼š

    1.  (list-pick '(b) 0) äº§ç”Ÿ 'bï¼›

    1.  (list-pick '(a b) 0) è®¡ç®—ç»“æžœä¸º 'aï¼Œé”™è¯¯çš„ç­”æ¡ˆï¼›

    1.  ä»¥åŠ (list-pick '(b) 1) è§¦å‘é”™è¯¯ã€‚

    ä»Žè¿™é‡Œï¼Œæˆ‘ä»¬å¾—å‡ºç»“è®ºï¼Œ(list-pick ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) l) ([sub1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29) n)) åœ¨æœ€åŽä¸€ä¸ª [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å­å¥ä¸­è®¡ç®—å‡ºæ‰€éœ€çš„ç­”æ¡ˆã€‚

ç»ƒä¹  390ã€‚è®¾è®¡å‡½æ•° tree-pickã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªç¬¦å·æ ‘å’Œæ–¹å‘åˆ—è¡¨ï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29) branch [[left](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29) [right](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29)]) |
> | --- |
> | Â  |
> | ;Â ä¸€ä¸ª TOS å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š |
> | ;Â â€“  Symbol |
> | ;Â â€“  (make-branch  TOS  TOS) |
> | Â  |
> | ;Â A Direction is one of: |
> | ;Â â€“  ['](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._quote%29%29)[left](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._left%29%29) |
> | ;Â â€“  ['](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._quote%29%29)[right](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._right%29%29) |
> | Â  |
> | ;Â A list of Directions is also called a path. |

æ˜¾ç„¶ï¼Œä¸€ä¸ª Direction å‘Šè¯‰å‡½æ•°åœ¨éžç¬¦å·æ ‘ä¸­é€‰æ‹©å·¦åˆ†æ”¯è¿˜æ˜¯å³åˆ†æ”¯ã€‚æ ‘é€‰æ‹©å‡½æ•°çš„ç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿåˆ«å¿˜äº†åˆ¶å®šä¸€ä¸ªå®Œæ•´çš„ç­¾åã€‚å½“ç»™å‡½æ•°ä¸€ä¸ªç¬¦å·å’Œä¸€ä¸ªéžç©ºè·¯å¾„æ—¶ï¼Œå®ƒä¼šå¼•å‘é”™è¯¯ã€‚

#### 23.4 å‡½æ•°ç®€åŒ–ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

å›¾ 134 ä¸­çš„åˆ—è¡¨é€‰æ‹©å‡½æ•°æ¯”å¿…è¦çš„è¦å¤æ‚å¾—å¤šã€‚å‰ä¸¤ä¸ª[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥ä¼šå¼•å‘é”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœä»¥ä¸‹ä»»ä¸€æ¡ä»¶æˆç«‹ï¼Œ

> ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â alos))

æˆ–è€…

> ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0)Â ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â alos))

å¦‚æžœæˆç«‹ï¼Œç­”æ¡ˆæ˜¯é”™è¯¯ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè§‚å¯Ÿç»“æžœè½¬æ¢ä¸ºä»£ç ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (list-pickÂ alosÂ n) |
> | --- |
> | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | [([æˆ–](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29) [([ä¸Ž](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) [([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29) n 0) [([ç©ºåˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) alos))]] |
> | [([ä¸Ž](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) [([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0) [([ç©ºåˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) alos)]]) |
> | [é”™è¯¯](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29) 'list-pick "list too short"] |
> | [([ä¸Ž](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) [([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29) n 0) [([åˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) alos)) [([ç¬¬ä¸€ä¸ªå…ƒç´ ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29) alos)]]) |
> | [([ä¸Ž](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) [([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0) [([åˆ—è¡¨ï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) alos))]] |
> | [([list-pick](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list-pick%29%29) [([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29) alos) [([å‡ 1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29) n))])) |

ä¸ºäº†è¿›ä¸€æ­¥ç®€åŒ–è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦ç†Ÿæ‚‰æœ‰å…³å¸ƒå°”ä»£æ•°çš„å®šå¾‹ï¼šè¿™äº›ç­‰å¼è¢«ç§°ä¸ºå¾·æ‘©æ ¹å®šå¾‹ã€‚

> |
> 
> &#124; ([æˆ–](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29) ([ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) bexp1 a-bexp) &#124;
> 
> &#124;Â Â Â Â ([ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) bexp2 a-bexp)) &#124;
> 
> |  | == |  |
> | --- | --- | --- |
> 
> &#124; ([ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([æˆ–](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29) bexp1 bexp2) &#124;
> 
> &#124;Â Â Â Â a-bexp) &#124;
> 
> |

å½“[ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)å­è¡¨è¾¾å¼çš„é¡ºåºäº¤æ¢æ—¶ï¼Œä¹Ÿé€‚ç”¨ç±»ä¼¼çš„å®šå¾‹ã€‚å°†è¿™äº›å®šå¾‹åº”ç”¨äºŽ list-pickï¼Œå¾—åˆ°ä»¥ä¸‹ç»“æžœï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (list-pick n alos) |
> | --- |
> | |Â Â Â Â ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> | |Â Â Â Â [([ä¸”](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([æˆ–](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29) ([ç­‰äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29) n 0) ([å¤§äºŽ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29) n 0)) ([ç©ºï¼Ÿ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29) alos)) |
> | |Â Â Â Â ([é”™è¯¯](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29) 'list-pickÂ "åˆ—è¡¨å¤ªçŸ­")] |
> | |Â Â Â ([([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â alos))Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â alos)]) |
> | |Â Â Â ([([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0)Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â alos))) |
> | |Â Â Â (list-pickÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â alos)Â ([sub1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)Â n))) |

çŽ°åœ¨è€ƒè™‘ ([or](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._or%29%29)  ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)  n  0)  ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)  n  0)). å®ƒæ€»æ˜¯ #trueï¼Œå› ä¸º n å±žäºŽ Nã€‚ç”±äºŽ ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)  #true  ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  alos)) ç­‰ä»·äºŽ ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  alos)ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡é‡å†™è¯¥å‡½æ•°ï¼š

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (list-pickÂ alosÂ n)) |
> | --- |
> | |Â Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)) |
> | |Â Â Â Â [([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â alos)Â ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â 'list-pickÂ "list too short")] |
> | |Â Â Â Â [([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â alos))Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â alos)] |
> | |Â Â Â Â [([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0)Â ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)Â alos)) |
> | |Â Â Â Â (list-pickÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â alos)Â ([sub1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)Â n))])) |

è¿™ä¸ªæœ€åŽçš„å®šä¹‰å·²ç»æ¯”å›¾ 134 ä¸­çš„å®šä¹‰ç®€å•å¾—å¤šï¼Œä½†æˆ‘ä»¬è¿˜å¯ä»¥åšå¾—æ›´å¥½ã€‚æ¯”è¾ƒ list-pick æœ€æ–°ç‰ˆæœ¬ä¸­çš„ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸Žç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªæ¡ä»¶ã€‚ç”±äºŽç¬¬ä¸€ä¸ª[cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29)å­å¥è¿‡æ»¤æŽ‰äº†æ‰€æœ‰å½“ alos ä¸ºç©ºçš„æƒ…å†µï¼Œ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29) alos)åœ¨æœ€åŽä¸¤ä¸ªå­å¥ä¸­æ€»æ˜¯è¯„ä¼°ä¸º#trueã€‚å¦‚æžœæˆ‘ä»¬ç”¨#true æ›¿æ¢æ¡ä»¶å¹¶å†æ¬¡ç®€åŒ–[and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¾—åˆ° list-pick çš„ä¸‰è¡Œç‰ˆæœ¬

> > > | ;Â list-pick: [List-of  Symbol] N[>= 0] -> Symbol |
> > > | --- |
> > > | ;Â determines the nth symbol from alos, counting from 0; |
> > > | ;Â signals an error if there is no nth symbol |
> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (list-pickÂ alosÂ n) |
> > > | Â Â ([cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | Â Â Â Â [([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â alos)Â ([error](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._error%29%29)Â 'list-pickÂ "list too short")] |
> > > | Â Â Â Â [([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â nÂ 0)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â alos)] |
> > > | Â Â Â Â [([>](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3e%29%29)Â nÂ 0)Â ([list-pick](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list-pick%29%29)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â alos)Â ([sub1](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._sub1%29%29)Â n))])) |
> > > 
> å›¾Â 135: åˆ—è¡¨ç´¢å¼•ï¼Œç®€åŒ–ç‰ˆ

å›¾Â 135 å±•ç¤ºäº†åˆ—è¡¨é€‰æ‹©ï¼ˆlist-pickï¼‰çš„ç®€åŒ–ç‰ˆæœ¬ã€‚è™½ç„¶å®ƒæ¯”åŽŸå§‹ç‰ˆæœ¬ç®€å•å¾—å¤šï¼Œä½†é‡è¦çš„æ˜¯è¦ç†è§£æˆ‘ä»¬æ˜¯ä»¥ç³»ç»ŸåŒ–çš„æ–¹å¼è®¾è®¡åŽŸå§‹ç‰ˆæœ¬çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡å·²å»ºç«‹çš„ä»£æ•°æ³•åˆ™å°†ç¬¬ä¸€ä¸ªç‰ˆæœ¬è½¬æ¢ä¸ºç¬¬äºŒä¸ªç‰ˆæœ¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¿¡ä»»è¿™ä¸ªç®€å•ç‰ˆæœ¬ã€‚å¦‚æžœæˆ‘ä»¬è¯•å›¾ç›´æŽ¥å¯»æ‰¾å‡½æ•°çš„ç®€å•ç‰ˆæœ¬ï¼Œæˆ‘ä»¬è¿Ÿæ—©ä¼šå¿½ç•¥åˆ†æžä¸­çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼Œå¹¶ä¸”æˆ‘ä»¬è‚¯å®šä¼šäº§ç”Ÿæœ‰ç¼ºé™·çš„ç¨‹åºã€‚

ç»ƒä¹ Â 391. ä½¿ç”¨â€œåŒæ—¶å¤„ç†ä¸¤ä¸ªåˆ—è¡¨ï¼šæ¡ˆä¾‹ 3â€çš„ç­–ç•¥è®¾è®¡ replace-eol-withã€‚ä»Žæµ‹è¯•å¼€å§‹ã€‚ç³»ç»Ÿåœ°ç®€åŒ–ç»“æžœã€‚

ç»ƒä¹ Â 392. ç®€åŒ–å‡½æ•° tree-pickï¼Œæ¥è‡ª ç»ƒä¹ Â 390ã€‚

#### 23.5 è®¾è®¡æ¶ˆè´¹ä¸¤ä¸ªå¤æ‚è¾“å…¥çš„å‡½æ•°ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

è®¾è®¡ä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰å¤æ‚å‚æ•°çš„å‡½æ•°çš„æ­£ç¡®æ–¹æ³•æ˜¯è¦éµå¾ªé€šç”¨é…æ–¹ã€‚ä½ å¿…é¡»è¿›è¡Œæ•°æ®åˆ†æžå¹¶å®šä¹‰ç›¸å…³çš„æ•°æ®ç±»åˆ«ã€‚å¦‚æžœ List-of å’ŒçŸ­è¯­çš„ä¾‹å­å¦‚ '(1  b  &) ä½¿ä½ å›°æƒ‘ï¼Œé‚£ä¹ˆæ‰©å±•å®ƒä»¬ï¼Œä½¿æž„é€ å™¨å˜å¾—æ˜Žç¡®ã€‚æŽ¥ä¸‹æ¥ä½ éœ€è¦ä¸€ä¸ªå‡½æ•°ç­¾åå’Œç›®çš„ã€‚æ­¤æ—¶ï¼Œä½ å¯ä»¥æå‰è€ƒè™‘å¹¶å†³å®šä½ é¢ä¸´ä»¥ä¸‹ä¸‰ç§æƒ…å†µä¸­çš„å“ªä¸€ç§ï¼š

1.  å¦‚æžœå…¶ä¸­ä¸€ä¸ªå‚æ•°èµ·ä¸»å¯¼ä½œç”¨ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°æ–¹é¢ï¼Œå°†å¦ä¸€ä¸ªè§†ä¸ºåŽŸå­æ•°æ®å—ã€‚

1.  åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå‚æ•°çš„èŒƒå›´è·¨è¶Šç›¸åŒçš„å€¼ç±»ï¼Œå¹¶ä¸”å¿…é¡»å…·æœ‰ç›¸åŒçš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œä¸¤ä¸ªåˆ—è¡¨å¿…é¡»å…·æœ‰ç›¸åŒçš„é•¿åº¦ï¼Œæˆ–è€…ä¸¤ä¸ªç½‘é¡µå¿…é¡»å…·æœ‰ç›¸åŒçš„é•¿åº¦ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯åµŒå…¥é¡µé¢çš„ï¼Œå¦ä¸€ä¸ªä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æžœä¸¤ä¸ªå‚æ•°å…·æœ‰è¿™ç§å¹³ç­‰åœ°ä½ï¼Œå¹¶ä¸”ç›®çš„è¡¨æ˜Žå®ƒä»¬éœ€è¦åŒæ­¥å¤„ç†ï¼Œä½ é€‰æ‹©ä¸€ä¸ªå‚æ•°ï¼Œå›´ç»•å®ƒç»„ç»‡å‡½æ•°ï¼Œå¹¶ä»¥å¹¶è¡Œæ–¹å¼éåŽ†å¦ä¸€ä¸ªã€‚

1.  å¦‚æžœä¸¤ä¸ªå‚æ•°ä¹‹é—´æ²¡æœ‰æ˜Žæ˜¾çš„è”ç³»ï¼Œä½ å¿…é¡»åˆ†æžæ‰€æœ‰å¯èƒ½çš„æƒ…å†µå¹¶ä¸¾ä¾‹è¯´æ˜Žã€‚ç„¶åŽä½¿ç”¨è¿™ç§åˆ†æžæ¥å¼€å‘æ¨¡æ¿ï¼Œç‰¹åˆ«æ˜¯é€’å½’éƒ¨åˆ†ã€‚

ä¸€æ—¦ä½ ç¡®å®šä¸€ä¸ªå‡½æ•°å±žäºŽç¬¬ä¸‰ç±»ï¼Œå°±å¼€å‘ä¸€ä¸ªäºŒç»´è¡¨æ ¼ä»¥ç¡®ä¿æ²¡æœ‰æ¡ˆä¾‹é—æ¼ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªéžå¹³å‡¡çš„æ•°æ®å®šä¹‰å¯¹è¿™ä¸€æƒ³æ³•å†æ¬¡è¿›è¡Œè§£é‡Šï¼š

> |
> 
> &#124; ;Â An LOD is one of: &#124;
> 
> &#124; ;Â â€“  '() &#124;
> 
> &#124; ;Â â€“  ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)  Direction  LOD) &#124;
> 
> |  |
> | --- |
> 
> &#124; ;Â A TID is one of: &#124;
> 
> &#124; ;Â â€“  Symbol &#124;
> 
> &#124; ;Â â€“  (make-binary  TID  TID) &#124;
> 
> &#124; ;Â â€“  (make-with  TID  Symbol  TID) &#124;
> 
> |

å·¦ä¾§çš„æ•°æ®å®šä¹‰æ˜¯å¸¸è§„çš„åˆ—è¡¨å®šä¹‰ï¼›å³ä¾§çš„æ˜¯ TOS çš„ä¸‰ä¸ªå­å¥å˜ä½“ã€‚å®ƒä½¿ç”¨äº†ä¸¤ç§ç»“æž„ç±»åž‹å®šä¹‰ï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â withÂ [lftÂ infoÂ rght]) |
> | --- |
> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â binaryÂ [lftÂ rght]) |

å‡è®¾è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ª LOD å’Œä¸€ä¸ª TIDï¼Œä½ åº”è¯¥æž„å»ºçš„è¡¨æ ¼å…·æœ‰å¦‚ä¸‹å½¢çŠ¶ï¼š

> |  |  | ([empty?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)  l) |  | ([cons?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons~3f%29%29)  l) |
> | --- | --- | --- | --- | --- |
> | ([symbol?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3f%29%29)  t) |  |  |  |  |
> | (binary?  t) |  |  |  |  |
> | (with?  t) |  |  |  |  |

åœ¨æ°´å¹³æ–¹å‘ä¸Šï¼Œæˆ‘ä»¬åˆ—ä¸¾äº†è¯†åˆ«ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæ­¤å¤„ä¸º LODï¼‰çš„å­ç±»çš„æ¡ä»¶ï¼Œè€Œåœ¨åž‚ç›´æ–¹å‘ä¸Šï¼Œæˆ‘ä»¬åˆ—ä¸¾äº†ç¬¬äºŒä¸ªå‚æ•°ï¼ˆTIDï¼‰çš„æ¡ä»¶ã€‚

è¯¥è¡¨æŒ‡å¯¼äº†å‡½æ•°ç¤ºä¾‹å’Œå‡½æ•°æ¨¡æ¿çš„å¼€å‘ã€‚æ­£å¦‚è§£é‡Šçš„é‚£æ ·ï¼Œç¤ºä¾‹å¿…é¡»æ¶µç›–æ‰€æœ‰å¯èƒ½çš„æ¡ˆä¾‹ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œè¡¨ä¸­æ¯ä¸ªå•å…ƒæ ¼è‡³å°‘å¿…é¡»æœ‰ä¸€ä¸ªç¤ºä¾‹ã€‚åŒæ ·ï¼Œæ¨¡æ¿å¿…é¡»ä¸ºæ¯ä¸ªå•å…ƒæ ¼æœ‰ä¸€ä¸ª [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å­å¥ï¼›å…¶æ¡ä»¶é€šè¿‡ä¸€ä¸ª [and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) è¡¨è¾¾å¼ç»“åˆæ°´å¹³å’Œåž‚ç›´æ¡ä»¶ã€‚æ¯ä¸ª [cond](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) å­å¥ï¼Œåè¿‡æ¥ï¼Œå¿…é¡»åŒ…å«ä¸¤ä¸ªå‚æ•°çš„æ‰€æœ‰å¯è¡Œçš„é€‰æ‹©è¡¨è¾¾å¼ã€‚å¦‚æžœä¸€ä¸ªå‚æ•°æ˜¯åŽŸå­çš„ï¼Œåˆ™ä¸éœ€è¦é€‰æ‹©è¡¨è¾¾å¼ã€‚æœ€åŽï¼Œä½ éœ€è¦æ³¨æ„å¯è¡Œçš„è‡ªç„¶é€’å½’ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ‰€æœ‰å¯èƒ½çš„é€‰æ‹©è¡¨è¾¾å¼ï¼ˆä»¥åŠå¯é€‰çš„åŽŸå­å‚æ•°ï¼‰çš„ç»„åˆéƒ½æ˜¯è‡ªç„¶é€’å½’çš„å€™é€‰ã€‚å› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“å“ªäº›æ˜¯å¿…è¦çš„ï¼Œå“ªäº›ä¸æ˜¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è®°ä½å®ƒä»¬ä»¥å¤‡ç¼–ç æ­¥éª¤ä¹‹ç”¨ã€‚

æ€»ç»“æ¥è¯´ï¼Œå¤šå‚æ•°å‡½æ•°çš„è®¾è®¡åªæ˜¯æ—§çš„è®¾è®¡é£Ÿè°±ä¸»é¢˜çš„ä¸€ç§å˜ä½“ã€‚å…³é”®æ€æƒ³æ˜¯å°†æ•°æ®å®šä¹‰è½¬æ¢æˆä¸€ä¸ªæ˜¾ç¤ºæ‰€æœ‰å¯è¡Œå’Œæœ‰è¶£ç»„åˆçš„è¡¨ã€‚å‡½æ•°ç¤ºä¾‹å’Œæ¨¡æ¿çš„å¼€å‘å°½å¯èƒ½åˆ©ç”¨è¿™ä¸ªè¡¨ã€‚

#### 23.6 æ‰‹æŒ‡ç»ƒä¹ ï¼šä¸¤ä¸ªè¾“å…¥ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ç»ƒä¹  393. å›¾ 62 å±•ç¤ºäº†æœ‰é™é›†åˆçš„ä¸¤ç§æ•°æ®å®šä¹‰ã€‚è®¾è®¡ä¸€ä¸ªè¡¨ç¤ºä½ é€‰æ‹©çš„æœ‰é™é›†åˆçš„å¹¶é›†å‡½æ•°ã€‚å®ƒæŽ¥å—ä¸¤ä¸ªé›†åˆï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé›†åˆä¸­æ‰€æœ‰å…ƒç´ çš„é›†åˆã€‚

ä¸ºç›¸åŒçš„é›†åˆè¡¨ç¤ºè®¾è®¡äº¤é›†å‡½æ•°ã€‚å®ƒæŽ¥å—ä¸¤ä¸ªé›†åˆï¼Œå¹¶äº§ç”Ÿæ°å¥½å‡ºçŽ°åœ¨ä¸¤ä¸ªé›†åˆä¸­çš„é‚£äº›å…ƒç´ çš„é›†åˆã€‚

ç»ƒä¹  394ã€‚è®¾è®¡åˆå¹¶ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸¤ä¸ªæŒ‰å‡åºæŽ’åºçš„æ•°å­—åˆ—è¡¨ã€‚å®ƒäº§ç”Ÿä¸€ä¸ªåŒ…å«ä¸¤ä¸ªè¾“å…¥åˆ—è¡¨ä¸Šæ‰€æœ‰æ•°å­—çš„å•ä¸ªæŽ’åºåŽçš„æ•°å­—åˆ—è¡¨ã€‚ä¸€ä¸ªæ•°å­—åœ¨è¾“å‡ºä¸­å‡ºçŽ°çš„æ¬¡æ•°ä¸Žå®ƒåœ¨ä¸¤ä¸ªè¾“å…¥åˆ—è¡¨ä¸­ä¸€èµ·å‡ºçŽ°çš„æ¬¡æ•°ç›¸åŒã€‚

ç»ƒä¹  395ã€‚è®¾è®¡å–ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªåˆ—è¡¨ l å’Œä¸€ä¸ªè‡ªç„¶æ•° nã€‚å®ƒäº§ç”Ÿ l çš„å‰ n ä¸ªå…ƒç´ ï¼Œå¦‚æžœ l å¤ªçŸ­ï¼Œåˆ™äº§ç”Ÿ l çš„æ‰€æœ‰å…ƒç´ ã€‚

è®¾è®¡åˆ é™¤ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªåˆ—è¡¨ l å’Œä¸€ä¸ªè‡ªç„¶æ•° nã€‚å®ƒçš„ç»“æžœæ˜¯ç§»é™¤äº†å‰ n ä¸ªå…ƒç´ çš„ lï¼Œå¦‚æžœ l å¤ªçŸ­ï¼Œåˆ™è¿”å›žç©ºåˆ—è¡¨()ã€‚

> > > |   ;Â An HM-Word is a [List-of  Letter or "_"] |
> > > | --- |
> > > |   ;Â interpretation  "_" represents a letter to be guessed |
> > > |   |
> > > |   ;Â HM-Word  N -> String |
> > > |   ;Â runs a simplistic hangman game, produces the current state |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (playÂ the-pickÂ time-limit) |
> > > |   ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â the-wordÂ Â ([explode](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29)Â the-pick)) |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â the-guessÂ ([make-list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._make-list%29%29)Â (lengthÂ the-word)Â "_")) |
> > > |   ;Â HM-Word -> HM-Word |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (do-nothingÂ s)Â s) |
> > > |   ;Â HM-Word  KeyEvent -> HM-Word |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (checked-compareÂ current-statusÂ ke) |
> > > |  Â Â  ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)Â ([member?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29)Â keÂ LETTERS) |
> > > |  Â Â  compare-word the-word current-status ke |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â current-status))) |
> > > | Â Â Â Â ([åŽ‹ç¼©](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._implode%29%29) |
> > > | Â Â Â Â Â ([å¤§çˆ†ç‚¸](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29)the-guessÂ ;Â HM-Word |
> > > | Â Â Â Â Â Â Â [[ç»˜åˆ¶](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29)Â render-word] |
> > > | Â Â Â Â Â Â Â [[åœ¨è®¡æ—¶å™¨ä¸Š](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29)Â do-nothingÂ 1Â time-limit] |
> > > | Â Â Â Â Â Â Â [[åœ¨é”®ä¸Š](http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29)Â Â checked-compare])))) |
> > > | Â  |
> > > | ;Â HM-Word -> Image |
> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (render-wordÂ w) |
> > > | Â Â ([æ–‡æœ¬](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29)Â ([åŽ‹ç¼©](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._implode%29%29)Â w)Â 22Â "é»‘è‰²")) |
> > > 
> å›¾ 136ï¼šä¸€ä¸ªç®€å•çš„çŒœå­—æ¸¸æˆ

ç»ƒä¹  396ï¼šçŒœå­—æ¸¸æˆæ˜¯ä¸€ç§è‘—åçš„çŒœè°œæ¸¸æˆã€‚ä¸€åçŽ©å®¶é€‰æ‹©ä¸€ä¸ªå•è¯ï¼Œå¦ä¸€åçŽ©å®¶è¢«å‘ŠçŸ¥è¯¥å•è¯åŒ…å«å¤šå°‘ä¸ªå­—æ¯ã€‚åŽè€…é€‰æ‹©ä¸€ä¸ªå­—æ¯ï¼Œå¹¶è¯¢é—®ç¬¬ä¸€ä¸ªçŽ©å®¶è¿™ä¸ªå­—æ¯æ˜¯å¦ä»¥åŠåœ¨å“ªé‡Œå‡ºçŽ°åœ¨æ‰€é€‰å•è¯ä¸­ã€‚æ¸¸æˆåœ¨çº¦å®šçš„æ—¶é—´æˆ–å›žåˆæ•°åŽç»“æŸã€‚

å›¾ 136 å±•ç¤ºäº†æ¸¸æˆé™æ—¶ç‰ˆæœ¬çš„æ ¸å¿ƒã€‚å‚è§ å±€éƒ¨å®šä¹‰å¢žåŠ è¡¨è¾¾åŠ› äº†è§£ä¸ºä»€ä¹ˆ checked-compare æ˜¯å±€éƒ¨å®šä¹‰çš„ã€‚

æœ¬ç»ƒä¹ çš„ç›®çš„æ˜¯è®¾è®¡ compare-wordï¼Œè¿™æ˜¯æ ¸å¿ƒå‡½æ•°ã€‚å®ƒæŽ¥å—è¦çŒœæµ‹çš„å•è¯ã€è¡¨ç¤ºçŒœæµ‹çŽ©å®¶å·²å‘çŽ°å¤šå°‘/å¤šå°‘çš„å•è¯ s ä»¥åŠå½“å‰çš„çŒœæµ‹ã€‚è¯¥å‡½æ•°ç”Ÿæˆ sï¼Œå…¶ä¸­æ‰€æœ‰ "_" éƒ½è¡¨ç¤ºçŒœæµ‹æ­ç¤ºäº†å­—æ¯ã€‚

è®¾è®¡å¥½å‡½æ•°åŽï¼ŒæŒ‰å¦‚ä¸‹æ–¹å¼è¿è¡Œç¨‹åºï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â LOCATIONÂ "/usr/share/dict/words")Â ;Â åœ¨ OS X ä¸Š |
> | --- |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â AS-LISTÂ ([è¯»å–è¡Œ](http://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-lines%29%29)Â LOCATION)) |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â SIZEÂ (lengthÂ AS-LIST)) |
> | (playÂ ([list-ref](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list-ref%29%29)Â AS-LISTÂ ([random](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._random%29%29)Â SIZE))Â 10) |

è§ å›¾ 74 ä»¥äº†è§£è§£é‡Šã€‚å°½æƒ…äº«å—å¹¶æŒ‰éœ€æ”¹è¿›ï¼

ç»ƒä¹  397ã€‚åœ¨å·¥åŽ‚ä¸­ï¼Œå‘˜å·¥åœ¨æ—©ä¸Šåˆ°è¾¾æ—¶æ‰“å¡ï¼Œåœ¨æ™šä¸Šç¦»å¼€æ—¶æ‰“å¡ã€‚ç”µå­æ‰“å¡è®°å½•åŒ…å«å‘˜å·¥ç¼–å·å’Œæ¯å‘¨å·¥ä½œçš„å°æ—¶æ•°ã€‚å‘˜å·¥è®°å½•æ€»æ˜¯åŒ…å«å‘˜å·¥å§“åã€å‘˜å·¥ç¼–å·å’Œå·¥èµ„çŽ‡ã€‚

è®¾è®¡å·¥èµ„*.v3ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªå‘˜å·¥è®°å½•åˆ—è¡¨å’Œä¸€ä¸ªæ‰“å¡è®°å½•åˆ—è¡¨ã€‚å®ƒäº§ç”Ÿä¸€ä¸ªå·¥èµ„è®°å½•åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«å‘˜å·¥çš„å§“åå’Œæ¯å‘¨å·¥èµ„ã€‚å¦‚æžœæ‰¾ä¸åˆ°æ‰“å¡è®°å½•å¯¹åº”çš„å‘˜å·¥è®°å½•æˆ–åä¹‹ï¼Œåˆ™å‡½æ•°ä¼šå‘å‡ºé”™è¯¯ä¿¡å·ã€‚

å‡è®¾ã€‚æ¯ä¸ªå‘˜å·¥ç¼–å·æœ€å¤šåªæœ‰ä¸€ä¸ªæ‰“å¡è®°å½•ã€‚

ç»ƒä¹  398ã€‚çº¿æ€§ç»„åˆæ˜¯è®¸å¤šçº¿æ€§é¡¹çš„å’Œï¼Œå³å˜é‡å’Œæ•°å­—çš„ä¹˜ç§¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŽè€…è¢«ç§°ä¸ºç³»æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼š

> | ![image](img/8011f33851416d69861562711b793baa.png) |  | ![image](img/82fcae48076fbe7779c73ed1127d1325.png) |  | ![image](img/fbfa013108ecd462f2c27da453838ca1.png) |
> | --- | --- | --- | --- | --- |

åœ¨æ‰€æœ‰ç¤ºä¾‹ä¸­ï¼Œx çš„ç³»æ•°æ˜¯ 5ï¼Œy çš„ç³»æ•°æ˜¯ 17ï¼Œz çš„ç³»æ•°æ˜¯ 3ã€‚

å¦‚æžœæˆ‘ä»¬ç»™å®šäº†å˜é‡çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šå¤šé¡¹å¼çš„å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœ x = 10ï¼Œ![image](img/eb9294e336c71ad7f96346414bc13f46.png) çš„å€¼æ˜¯ 50ï¼›å¦‚æžœ x = 10 ä¸” y = 1ï¼Œ![image](img/51344006b1331e0c3327482737c9a6ab.png) çš„å€¼æ˜¯ 67ï¼›å¦‚æžœ x = 10ï¼Œy = 1ï¼Œz = 2ï¼Œ![image](img/e89265ae8dbca10242330152e6a111ce.png) çš„å€¼æ˜¯ 73ã€‚

çº¿æ€§ç»„åˆæœ‰è®¸å¤šä¸åŒçš„è¡¨ç¤ºæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•°æ¥è¡¨ç¤ºå®ƒä»¬ã€‚å¦ä¸€ç§è¡¨ç¤ºæ–¹æ³•æ˜¯ç³»æ•°åˆ—è¡¨ã€‚ä¸Šè¿°ç»„åˆå°†è¡¨ç¤ºä¸ºï¼š

> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 5) |
> | --- |
> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 5Â 17) |
> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â 5Â 17Â 3) |

è¿™ç§è¡¨ç¤ºæ³•çš„é€‰æ‹©å‡è®¾äº†å˜é‡æœ‰ä¸€ä¸ªå›ºå®šçš„é¡ºåºã€‚

è®¾è®¡å€¼ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸¤ä¸ªç­‰é•¿çš„åˆ—è¡¨ï¼šä¸€ä¸ªçº¿æ€§ç»„åˆå’Œä¸€ä¸ªå˜é‡å€¼åˆ—è¡¨ã€‚å®ƒä¸ºè¿™äº›å€¼ç”Ÿæˆç»„åˆçš„å€¼ã€‚

ç»ƒä¹  399ã€‚è·¯æ˜“ä¸ã€ç®€ã€åŠ³æ‹‰ã€è¾¾å¨œå’ŒçŽ›ä¸½å†³å®šä¸¾åŠžä¸€ä¸ªæŠ½å¥–æ´»åŠ¨ï¼Œæ¯äººåˆ†é…ä¸€ä¸ªç¤¼ç‰©æŽ¥æ”¶è€…ã€‚ç”±äºŽç®€æ˜¯å¼€å‘è€…ï¼Œä»–ä»¬è¯·å¥¹ç¼–å†™ä¸€ä¸ªç¨‹åºä»¥å…¬æ­£çš„æ–¹å¼æ‰§è¡Œè¿™é¡¹ä»»åŠ¡ã€‚å½“ç„¶ï¼Œç¨‹åºä¸èƒ½å°†ä»»ä½•å§å¦¹åˆ†é…ç»™è‡ªå·±ã€‚

è¿™é‡Œæ˜¯ç®€çš„ç¨‹åºæ ¸å¿ƒï¼š

> | ;Â [List-of String] -> [List-of String] |
> | --- |
> | ;Â é€‰æ‹©ä¸€ä¸ªéšæœºçš„éžæ’ç­‰æŽ’åˆ—çš„åå­— |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (gift-pickÂ names) |
> | Â Â (random-pick |
> | Â Â Â Â (non-sameÂ namesÂ (arrangementsÂ names)))) |
> | Â  |
> | ;Â [List-of String] [List-of [List-of String]] |
> | ;Â è¿”å›žæ‰€æœ‰å¯èƒ½çš„åå­—æŽ’åˆ— |
> | ;Â å‚è§ç»ƒä¹  213 |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (arrangementsÂ names) |
> | Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |

å®ƒæ¶ˆè€—ä¸€ä¸ªåå­—åˆ—è¡¨ï¼Œå¹¶éšæœºé€‰æ‹©ä¸€ä¸ªä¸ŽåŽŸå§‹åˆ—è¡¨åœ¨ä»»ä½•åœ°æ–¹éƒ½ä¸ç›¸åŒçš„æŽ’åˆ—ã€‚ä½ çš„ä»»åŠ¡æ˜¯è®¾è®¡ä¸¤ä¸ªè¾…åŠ©å‡½æ•°ï¼š

> | ;Â [NEList-of X] -> X |
> | --- |
> | ;Â ä»Žåˆ—è¡¨ä¸­è¿”å›žä¸€ä¸ªéšæœºé¡¹ |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (random-pickÂ l) |
> | Â Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â l)) |
> | Â  |
> | ;Â [List-of String] [List-of [List-of String]] |
> | ;Â -> |
> | ;Â [List-of [List-of String]] |
> | ;Â ç”Ÿæˆé‚£äº›åœ¨ ll ä¸­çš„åˆ—è¡¨çš„åˆ—è¡¨ï¼Œå®ƒä»¬ |
> | ;Â åœ¨ä»»ä½•åœ°æ–¹éƒ½ä¸åŒæ„åå­— |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (non-sameÂ namesÂ ll) |
> | Â Â ll) |

å›žæƒ³ä¸€ä¸‹ï¼Œ[éšæœº](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._random%29%29) å‡½æ•°é€‰æ‹©ä¸€ä¸ªéšæœºæ•°ï¼›å‚è§ç»ƒä¹  99ã€‚

ç»ƒä¹  400ã€‚è®¾è®¡ DNAprefix å‡½æ•°ã€‚è¯¥å‡½æ•°æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œéƒ½æ˜¯ 'a, 'c, 'g, å’Œ 't è¿™äº›åœ¨ DNA æè¿°ä¸­å‡ºçŽ°çš„ç¬¦å·çš„åˆ—è¡¨ã€‚ç¬¬ä¸€ä¸ªåˆ—è¡¨ç§°ä¸ºæ¨¡å¼ï¼Œç¬¬äºŒä¸ªåˆ—è¡¨ç§°ä¸ºæœç´¢å­—ç¬¦ä¸²ã€‚å¦‚æžœæ¨¡å¼ä¸Žæœç´¢å­—ç¬¦ä¸²çš„åˆå§‹éƒ¨åˆ†ç›¸åŒï¼Œåˆ™å‡½æ•°è¿”å›ž #trueï¼›å¦åˆ™è¿”å›ž #falseã€‚

è¿˜è¦è®¾è®¡ DNAdeltaã€‚è¿™ä¸ªå‡½æ•°ç±»ä¼¼äºŽ DNAprefixï¼Œä½†è¿”å›žæœç´¢å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªè¶…å‡ºæ¨¡å¼çš„é¡¹ã€‚å¦‚æžœåˆ—è¡¨ç›¸åŒä¸”æ¨¡å¼ä¹‹åŽæ²¡æœ‰ DNA å­—æ¯ï¼Œåˆ™å‡½æ•°ä¼šå‘å‡ºé”™è¯¯ä¿¡å·ã€‚å¦‚æžœæ¨¡å¼ä¸åŒ¹é…æœç´¢å­—ç¬¦ä¸²çš„å¼€å§‹ï¼Œåˆ™è¿”å›ž #falseã€‚å‡½æ•°ä¸å¾—éåŽ†ä»»ä¸€åˆ—è¡¨è¶…è¿‡ä¸€æ¬¡ã€‚

DNAprefix æˆ– DNAdelta å¯ä»¥ç®€åŒ–å—ï¼Ÿ

ç»ƒä¹  401ã€‚è®¾è®¡ sexp=? å‡½æ•°ï¼Œè¯¥å‡½æ•°ç¡®å®šä¸¤ä¸ª S-è¡¨è¾¾å¼æ˜¯å¦ç›¸ç­‰ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œä»¥ä¸‹æ˜¯ç¼©ç•¥å½¢å¼çš„æ•°æ®å®šä¹‰ï¼š

> | ;Â S-è¡¨è¾¾å¼ï¼ˆS-expressionï¼‰æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š |
> | --- |
> | ;Â â€“  åŽŸå­ |
> | ;Â â€“ [åˆ—è¡¨ S-è¡¨è¾¾å¼] |
> | ;Â  |
> | ;Â åŽŸå­æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š |
> | ;Â â€“  æ•°å­— |
> | ;Â â€“  å­—ç¬¦ä¸² |
> | ;Â â€“  ç¬¦å· |

æ¯æ¬¡ä½ ä½¿ç”¨ [check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨åƒ sexp=? è¿™æ ·çš„å‡½æ•°æ¥æ£€æŸ¥ä¸¤ä¸ªä»»æ„å€¼æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æžœä¸ç›¸ç­‰ï¼Œæ£€æŸ¥å¤±è´¥ï¼Œ[check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29) ä¼šæŠ¥å‘Šè¿™ç§æƒ…å†µã€‚

ç»ƒä¹  402ã€‚é‡æ–°é˜…è¯»ç»ƒä¹  354ã€‚è§£é‡Šæˆ‘ä»¬æç¤ºå°†ç»™å®šè¡¨è¾¾å¼é¦–å…ˆè§†ä¸ºåŽŸå­å€¼çš„æŽ¨ç†ã€‚

#### 23.7 é¡¹ç›®ï¼šæ•°æ®åº“ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

è®¸å¤šè½¯ä»¶åº”ç”¨ç¨‹åºä½¿ç”¨æ•°æ®åº“æ¥è·Ÿè¸ªæ•°æ®ã€‚ç²—ç•¥åœ°è¯´ï¼Œæ•°æ®åº“æ˜¯ä¸€ä¸ªå…·æœ‰æ˜Žç¡®ç»„ç»‡è§„åˆ™çš„è¡¨ã€‚å‰è€…æ˜¯å†…å®¹ï¼›åŽè€…ç§°ä¸ºæ¨¡å¼ã€‚å›¾ 137 å±•ç¤ºäº†ä¸¤ä¸ªç¤ºä¾‹ã€‚æ¯ä¸ªè¡¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸Šé¢çš„æ¨¡å¼çº¿å’Œä¸‹é¢çš„å†…å®¹ã€‚

è®©æˆ‘ä»¬å…³æ³¨å·¦è¾¹çš„è¡¨æ ¼ã€‚å®ƒæœ‰ä¸‰åˆ—å’Œå››è¡Œã€‚æ¯ä¸€åˆ—éƒ½éµå¾ªä¸€ä¸ªä¸¤éƒ¨åˆ†çš„è§„åˆ™ï¼š

1.  å·¦ä¾§æœ€ä¸€åˆ—çš„è§„åˆ™è¯´æ˜Žè¯¥åˆ—çš„æ ‡ç­¾æ˜¯â€œNameâ€ï¼Œå¹¶ä¸”è¯¥åˆ—ä¸­çš„æ¯ä¸€ä»½æ•°æ®éƒ½æ˜¯ä¸€ä¸ª Stringï¼›

1.  ä¸­é—´åˆ—çš„æ ‡ç­¾æ˜¯â€œAgeâ€ï¼ŒåŒ…å«æ•´æ•°ï¼›å¹¶ä¸”

1.  æœ€å³ä¾§ä¸€åˆ—çš„æ ‡ç­¾æ˜¯â€œPresentâ€ï¼›å…¶å€¼æ˜¯å¸ƒå°”å€¼ã€‚

åœæ­¢ï¼ä»¥åŒæ ·çš„æ–¹å¼è§£é‡Šå³è¾¹çš„è¡¨æ ¼ã€‚

> > > > |
> > > > 
> > > > &#124; Name &#124;  &#124; Age &#124;  &#124; Present &#124;
> > > > 
> > > > &#124; String &#124;  &#124; Integer &#124;  &#124; Boolean &#124;
> > > > 
> > > > &#124; "Alice" &#124;  &#124; 35 &#124;  &#124; #true &#124;
> > > > 
> > > > &#124; "Bob" &#124;  &#124; 25 &#124;  &#124; #false &#124;
> > > > 
> > > > &#124; "Carol" &#124;  &#124; 30 &#124;  &#124; #true &#124;
> > > > 
> > > > &#124; "Dave" &#124;  &#124; 32 &#124;  &#124; #false &#124;
> > > > 
> > > > |  |  |  |
> > > > | --- | --- | --- |
> > > > 
> > > > &#124; Present &#124;  &#124; Description &#124;
> > > > 
> > > > &#124; Boolean &#124;  &#124; String &#124;
> > > > 
> > > > &#124; #true &#124;  &#124; "presence" &#124;
> > > > 
> > > > &#124; #false &#124;  &#124; "absence" &#124;
> > > > 
> > > > |
> > > > 
> å›¾Â 137ï¼šæ•°æ®åº“ä½œä¸ºè¡¨æ ¼

è®¡ç®—æœºç§‘å­¦å®¶å°†è¿™äº›è¡¨æ ¼è§†ä¸ºå…³ç³»ã€‚æ¨¡å¼å¼•å…¥æœ¯è¯­æ¥æŒ‡ä»£å…³ç³»çš„åˆ—å’Œè¡Œä¸­çš„å•ä¸ªå•å…ƒæ ¼ã€‚æ¯ä¸€è¡Œå…³è”å›ºå®šæ•°é‡çš„å€¼ï¼›æ‰€æœ‰è¡Œçš„é›†åˆæž„æˆäº†æ•´ä¸ªå…³ç³»ã€‚åœ¨è¿™ä¸ªæœ¯è¯­ä¸­ï¼Œå›¾Â 137ï¼ˆ#%28counter._db._%28figure._fig~3adb-tables%29%29ï¼‰ä¸­å·¦ä¾§è¡¨æ ¼çš„ç¬¬ä¸€è¡Œå°†â€œAliceâ€ä¸Ž 35 å’Œ#true å…³è”ã€‚æ­¤å¤–ï¼Œè¡Œä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼ç§°ä¸ºâ€œNameâ€å•å…ƒæ ¼ï¼Œç¬¬äºŒä¸ªå•å…ƒæ ¼ç§°ä¸ºâ€œAgeâ€å•å…ƒæ ¼ï¼Œç¬¬ä¸‰ä¸ªå•å…ƒæ ¼ç§°ä¸ºâ€œPresentâ€å•å…ƒæ ¼ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç»“æž„å’Œåˆ—è¡¨æ¥è¡¨ç¤ºæ•°æ®åº“ï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â dbÂ [schemaÂ content]) |
> | --- |
> | ;Â A DB is a structure: (make-db  Schema  Content) |
> | Â  |
> | ;Â A Schema is a [List-of  Spec] |
> | ;Â A Spec is a [List  Label  Predicate] |
> | ;Â A Label is a String |
> | ;Â A Predicate is a [Any -> Boolean] |
> | Â  |
> | ;Â A (piece of) Content is a [List-of  Row] |
> | ;Â A Row is a [List-of  Cell] |
> | ;Â A Cell is Any |
> | ;Â constraint cells do not contain functions |
> | Â  |
> | ;Â integrity constraint In (make-db sch con), |
> | ;Â for every row in con, |
> | ;Â (I1) its length is the same as sch's, and |
> | ;Â (I2) its ith Cell satisfies the ith Predicate in sch |

Stop! Translate the databases from figureÂ 137 into the chosen data representation. Note that the content of the tables already uses ISL+ data.

> > > > |
> > > > 
> > > > &#124; ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) school-schema &#124;
> > > > 
> > > > &#124;Â Â Â `(("Name"Â Â Â Â ,[string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)) &#124;
> > > > 
> > > > &#124;Â Â Â ("Age"Â Â Â Â Â ,[integer?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._integer~3f%29%29)) &#124;
> > > > 
> > > > &#124;Â Â Â ("Present"Â ,[boolean?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._boolean~3f%29%29)))) &#124;
> > > > 
> > > > |  |  |  |
> > > > | --- | --- | --- |
> > > > 
> > > > &#124; ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) presence-schema &#124;
> > > > 
> > > > &#124;Â Â Â `(("Present"Â Â Â Â Â ,[boolean?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._boolean~3f%29%29)) &#124;
> > > > 
> > > > &#124;Â Â Â ("Description"Â ,[string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)))) &#124;
> > > > 
> > > > |
> > > > 
> > > > |  |  |  |  |  |
> > > > | --- | --- | --- | --- | --- |
> > > > 
> > > > |
> > > > 
> > > > &#124; ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) school-content &#124;
> > > > 
> > > > &#124;Â Â Â `(("Alice"Â 35 #true) &#124;
> > > > 
> > > > &#124;Â Â Â ("Bob"Â Â Â 25 #false) &#124;
> > > > 
> > > > &#124;Â Â Â ("Carol"Â 30 #true) &#124;
> > > > 
> > > > &#124;Â Â Â ("Dave"Â Â 32 #false))) &#124;
> > > > 
> > > > |  |  |  |
> > > > | --- | --- | --- |
> > > > 
> > > > &#124; ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) presence-content &#124;
> > > > 
> > > > &#124;Â Â Â `((#true "presence") &#124;
> > > > 
> > > > &#124;Â Â Â (#false "absence"))) &#124;
> > > > 
> > > > |
> > > > 
> > > > |  |  |  |  |  |
> > > > | --- | --- | --- | --- | --- |
> > > > 
> > > > |
> > > > 
> > > > &#124; ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) school-db &#124;
> > > > 
> > > > &#124;Â Â Â (make-db school-schema &#124;
> > > > 
> > > > &#124;Â Â Â school-content)) &#124;
> > > > 
> > > > |  |  |  |
> > > > | --- | --- | --- |
> > > > 
> > > > &#124; ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) presence-db &#124;
> > > > 
> > > > &#124; (make-db presence-schema &#124;
> > > > 
> > > > &#124;Â Â Â presence-content)) &#124;
> > > > 
> > > > |
> > > > 
> å›¾ 138ï¼šæ•°æ®åº“ä½œä¸º ISL+æ•°æ®

å›¾ 138 å±•ç¤ºäº†å¦‚ä½•å°†å›¾ 137 ä¸­çš„ä¸¤ä¸ªè¡¨æ ¼è¡¨ç¤ºä¸ºæ•°æ®åº“ã€‚å…¶å·¦ä¾§è¡¨ç¤ºæ¨¡å¼ã€å†…å®¹å’Œå›¾ 137 å·¦ä¾§è¡¨æ ¼ä¸­çš„æ•°æ®åº“ï¼›å…¶å³ä¾§éƒ¨åˆ†å¯¹åº”å³ä¾§è¡¨æ ¼ã€‚ä¸ºäº†ç®€æ´ï¼Œç¤ºä¾‹ä½¿ç”¨äº†[å‡†å¼•ç”¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._quasiquote%29%29)å’Œ[éžå¼•ç”¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._unquote%29%29)çš„è¡¨ç¤ºæ³•ã€‚å›žæƒ³ä¸€ä¸‹ï¼Œè¿™å…è®¸åœ¨é€šå¸¸å¼•ç”¨çš„åˆ—è¡¨ä¸­åŒ…å«ä¸€ä¸ªå€¼ï¼Œä¾‹å¦‚[boolean?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._boolean~3f%29%29)ã€‚å¦‚æžœä½ å¯¹è¿™ä¸ªè¡¨ç¤ºæ³•æ„Ÿåˆ°ä¸èˆ’æœï¼Œå¯ä»¥ç”¨[list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)é‡æ–°è¡¨è¿°è¿™äº›ç¤ºä¾‹ã€‚

ç»ƒä¹  403ã€‚ä¸€ä¸ªè§„èŒƒå°†ä¸€ä¸ªæ ‡ç­¾å’Œä¸€ä¸ªè°“è¯ç»„åˆæˆä¸€ä¸ªåˆ—è¡¨ã€‚è™½ç„¶å¯ä»¥æŽ¥å—ï¼Œä½†è¿™ç§é€‰æ‹©è¿åäº†æˆ‘ä»¬çš„æŒ‡å¯¼åŽŸåˆ™ï¼Œå³ä½¿ç”¨ç»“æž„ç±»åž‹æ¥è¡¨ç¤ºå›ºå®šæ•°é‡çš„ä¿¡æ¯ã€‚

è¿™é‡Œæ˜¯å¦ä¸€ç§æ•°æ®è¡¨ç¤ºæ–¹æ³•ï¼š

> | ([define-struct](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define-struct%29%29)Â specÂ [labelÂ predicate]) |
> | --- |
> | ;Â è§„èŒƒæ˜¯ä¸€ä¸ªç»“æž„ï¼š`(make-spec æ ‡ç­¾ è°“è¯)` |

ä½¿ç”¨è¿™ä¸ªæ›¿ä»£å®šä¹‰æ¥è¡¨ç¤ºå›¾ 137 ä¸­çš„æ•°æ®åº“ã€‚æ•°æ®åº“çš„å®Œæ•´æ€§æ£€æŸ¥è‡³å…³é‡è¦ã€‚åœ¨è¿™é‡Œï¼Œâ€œå®Œæ•´æ€§â€æŒ‡çš„æ˜¯æ•°æ®å®šä¹‰ä¸­çš„çº¦æŸï¼ˆI1ï¼‰å’Œï¼ˆI2ï¼‰ã€‚æ£€æŸ¥æ•°æ®åº“çš„å®Œæ•´æ€§æ˜¾ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°çš„ä»»åŠ¡ï¼š

> | ;Â æ•°æ®åº“ -> å¸ƒå°” |
> | --- |
> | ;Â æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡Œæ˜¯å¦æ»¡è¶³ï¼ˆI1ï¼‰å’Œï¼ˆI2ï¼‰ |
> | Â  |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (integrity-checkÂ school-db)Â #true) |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (integrity-checkÂ presence-db)Â #true) |
> | Â  |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (integrity-checkÂ db) |
> | Â Â #false) |

ä¸¤ä¸ªçº¦æŸçš„æŽªè¾žæš—ç¤ºï¼Œå¿…é¡»æœ‰ä¸€ä¸ªå‡½æ•°ä¸ºç»™å®šæ•°æ®åº“å†…å®¹ä¸­çš„æ¯ä¸€è¡Œç”Ÿæˆ#trueã€‚ç”¨ä»£ç è¡¨è¾¾è¿™ä¸ªæƒ³æ³•éœ€è¦ä½¿ç”¨[andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29)åœ¨ db çš„å†…å®¹ä¸Šï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (db)çš„å®Œæ•´æ€§æ£€æŸ¥) |
> | --- |
> | Â Â ([å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (;Â Row -> Boolean |
> | Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row-integrity-check row) |
> | Â Â Â Â Â Â Â Â Â Â Â Â [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))) |
> | Â Â Â Â ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29)Â row-integrity-checkÂ (db-contentÂ db)))) |

æŒ‰ç…§çŽ°æœ‰æŠ½è±¡çš„ä½¿ç”¨è®¾è®¡é£Ÿè°±ï¼Œæ¨¡æ¿é€šè¿‡ä¸€ä¸ª[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)å®šä¹‰å¼•å…¥è¾…åŠ©å‡½æ•°ã€‚è¡Œå®Œæ•´æ€§æ£€æŸ¥çš„è®¾è®¡ä»Žè¿™é‡Œå¼€å§‹ï¼š

> | ;Â Row -> Boolean |
> | --- |
> | ;Â è¡Œæ˜¯å¦æ»¡è¶³(I1)å’Œ(I2) |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row)çš„è¡Œå®Œæ•´æ€§æ£€æŸ¥) |
> | Â Â #false) |

æ€»çš„æ¥è¯´ï¼Œåˆ¶å®šç›®çš„å£°æ˜Žçš„ç›®æ ‡æ˜¯ç†è§£é—®é¢˜ã€‚è¿™é‡ŒæŒ‡å‡ºè¯¥å‡½æ•°æ£€æŸ¥ä¸¤ä¸ªæ¡ä»¶ã€‚å½“æ¶‰åŠä¸¤ä¸ªä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬çš„è®¾è®¡æŒ‡å—è¦æ±‚ä½¿ç”¨å‡½æ•°åŠå…¶ç»“æžœçš„ç»„åˆï¼š

> | ([å’Œ](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â (row-length-checkÂ row) |
> | --- |
> | Â Â Â Â Â (check-every-cellÂ row)) |

å°†è¿™äº›å‡½æ•°æ·»åŠ åˆ°æ‚¨çš„æ„¿æœ›æ¸…å•ä¸­ï¼›å®ƒä»¬çš„åå­—ä¼ è¾¾äº†å®ƒä»¬çš„ç›®çš„ã€‚åœ¨æˆ‘ä»¬è®¾è®¡è¿™äº›å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»æ€è€ƒæ˜¯å¦å¯ä»¥ç»„åˆçŽ°æœ‰çš„åŽŸå§‹æ“ä½œæ¥è®¡ç®—æ‰€éœ€å€¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬çŸ¥é“(length row)è®¡ç®—è¡Œä¸­æœ‰å¤šå°‘ä¸ªå•å…ƒæ ¼ã€‚åœ¨è¿™ä¸ªæ–¹å‘ä¸Šæ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬æ˜¾ç„¶æƒ³è¦

> ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â (length row)Â (length (db-schema db)))

è¿™ä¸ªæ¡ä»¶æ£€æŸ¥è¡Œçš„é•¿åº¦æ˜¯å¦ç­‰äºŽæ•°æ®åº“æ¨¡å¼çš„é•¿åº¦ã€‚åŒæ ·ï¼Œcheck-every-cell è°ƒç”¨éœ€è¦æ£€æŸ¥æŸä¸ªå‡½æ•°å¯¹è¡Œä¸­çš„æ¯ä¸ªå•å…ƒæ ¼éƒ½äº§ç”Ÿ #trueã€‚å†æ¬¡çœ‹æ¥ï¼Œ[andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29) å¯èƒ½ä¼šè¢«è°ƒç”¨ï¼š

> ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29)Â cell-integrity-checkÂ row)

cell-integrity-check çš„ç›®çš„æ˜¯æ˜¾ç„¶çš„ï¼Œå³æ£€æŸ¥çº¦æŸ (I2)ï¼Œä¹Ÿå°±æ˜¯ï¼Œ

> â€œç¬¬ i ä¸ª å•å…ƒæ ¼ æ»¡è¶³æ•°æ®åº“æ¨¡å¼ä¸­çš„ç¬¬ i ä¸ª è°“è¯ã€‚â€

çŽ°åœ¨æˆ‘ä»¬é™·å…¥äº†å›°å¢ƒï¼Œå› ä¸ºè¿™ä¸ªç›®çš„é™ˆè¿°å¼•ç”¨äº†ç»™å®šå•å…ƒæ ¼åœ¨è¡Œä¸­çš„ç›¸å¯¹ä½ç½®ã€‚ç„¶è€Œï¼Œ[andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29) çš„ç›®çš„æ˜¯ï¼Œå°† cell-integrity-check ç»Ÿä¸€åº”ç”¨äºŽæ¯ä¸ªå•å…ƒæ ¼ã€‚å½“ä½ é™·å…¥å›°å¢ƒæ—¶ï¼Œä½ å¿…é¡»é€šè¿‡ä¾‹å­æ¥è§£å†³é—®é¢˜ã€‚å¯¹äºŽè¾…åŠ©æˆ– [å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) å‡½æ•°ï¼Œæœ€å¥½ä»Žä¸»å‡½æ•°çš„ä¾‹å­ä¸­æŽ¨å¯¼å‡ºè¿™äº›ä¾‹å­ã€‚integrity-check çš„ç¬¬ä¸€ä¸ªä¾‹å­æ–­è¨€ school-content æ»¡è¶³å®Œæ•´æ€§çº¦æŸã€‚æ˜¾ç„¶ï¼Œschool-content ä¸­çš„æ‰€æœ‰è¡Œé•¿åº¦éƒ½ä¸Ž school-schema ç›¸åŒã€‚é—®é¢˜æ˜¯ä¸ºä»€ä¹ˆè¿™æ ·çš„è¡Œ

> ([åˆ—è¡¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Alice"Â 35Â #true)

æ»¡è¶³ç›¸åº”æ¨¡å¼ä¸­çš„è°“è¯ï¼š

> | ([åˆ—è¡¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â ([åˆ—è¡¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Name"Â Â Â Â [string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29))) |
> | --- |
> | Â Â Â Â Â Â ([åˆ—è¡¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Age"Â Â Â Â Â [integer?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._integer~3f%29%29))) |
> | Â Â Â Â Â Â ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Present"Â [boolean?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._boolean~3f%29%29))) |

ç­”æ¡ˆæ˜¯ï¼Œå°†ä¸‰ä¸ªè°“è¯åˆ†åˆ«åº”ç”¨äºŽå„è‡ªçš„å•å…ƒæ ¼ï¼Œéƒ½ä¼šè¿”å›ž trueï¼š

> | > ([string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29)Â "Alice") |
> | --- |
> | #true |
> | > ([integer?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._integer~3f%29%29)Â 35) |
> | #true |
> | > ([boolean?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._boolean~3f%29%29)Â #true) |
> | #true |

ä»Žè¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹å‡ºï¼Œè¯¥å‡½æ•°å¿…é¡»å¹¶è¡Œå¤„ç†è¿™ä¸¤ä¸ªåˆ—è¡¨â€”â€”<wbr>æ•°æ®åº“çš„æ¨¡å¼å’Œç»™å®šçš„è¡Œâ€”â€”<wbr>ã€‚

ç»ƒä¹  404ã€‚è®¾è®¡å‡½æ•° andmap2ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªä»Žä¸¤ä¸ªå€¼åˆ° Boolean çš„å‡½æ•°å’Œä¸¤ä¸ªç­‰é•¿çš„åˆ—è¡¨ã€‚å®ƒçš„ç»“æžœä¹Ÿæ˜¯ä¸€ä¸ª Booleanã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå°† f åº”ç”¨äºŽä¸¤ä¸ªåˆ—è¡¨ä¸­å¯¹åº”å€¼çš„é…å¯¹ï¼Œå¦‚æžœ f æ€»æ˜¯äº§ç”Ÿ#trueï¼Œandmap2 ä¹Ÿäº§ç”Ÿ#trueã€‚å¦åˆ™ï¼Œandmap2 äº§ç”Ÿ#falseã€‚ç®€è€Œè¨€ä¹‹ï¼Œandmap2 å°±åƒ[andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29)ä¸€æ ·ï¼Œä½†é€‚ç”¨äºŽä¸¤ä¸ªåˆ—è¡¨ã€‚

åœæ­¢ï¼åœ¨ç»§ç»­é˜…è¯»ä¹‹å‰è§£å†³ç»ƒä¹  404ã€‚

å¦‚æžœæˆ‘ä»¬åœ¨ ISL+ä¸­æœ‰ andmap2ï¼Œæ£€æŸ¥è¡Œä¸Šçš„ç¬¬äºŒä¸ªæ¡ä»¶å°†éžå¸¸ç®€å•ï¼š

> | (andmap2Â ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)Â (sÂ c)Â [([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29)Â s)Â c]) |
> | --- |
> | Â Â Â Â Â Â Â Â Â (db-schemaÂ db) |
> | Â Â Â Â Â Â Â Â Â row) |

ç»™å®šçš„å‡½æ•°ä»Žæ•°æ®åº“æ¨¡å¼ä¸­æ¶ˆè€—ä¸€ä¸ª Spec sï¼Œæå–ç¬¬äºŒä¸ªä½ç½®çš„è°“è¯ï¼Œå¹¶å°†å…¶åº”ç”¨äºŽç»™å®šçš„ Cell cã€‚æ— è®ºè°“è¯è¿”å›žä»€ä¹ˆï¼Œéƒ½æ˜¯[lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)å‡½æ•°çš„ç»“æžœã€‚

å†æ¬¡åœæ­¢ï¼è§£é‡Š([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29) s) c]ã€‚

ç»“æžœè¡¨æ˜Žï¼ŒISL+ä¸­çš„[andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29)å·²ç»ç±»ä¼¼äºŽ andmap2ï¼š

> | |Â Â  ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (integrity-check db) |
> | --- | --- |
> | |Â Â  ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) (; Row -> Boolean |
> | |Â Â  ;Â è¡Œæ˜¯å¦æ»¡è¶³(I1)å’Œ(I2) |
> | |Â Â  ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (row-integrity-check row) |
> | |Â Â  ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29) (length row) |
> | |Â Â  (length (db-schema db))) |
> | |Â Â  ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29) ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29) (s c) [([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29) s) c]) |
> | |Â Â  ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29) (db-schema db) |
> | |Â Â  row)))) |
> | |Â Â  ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29) row-integrity-check (db-content db)))) |

åœæ­¢ä¸€ä¸‹ï¼ä¸ºå®Œæ•´æ€§æ£€æŸ¥å¿…é¡»å¤±è´¥çš„æƒ…å†µå¼€å‘ä¸€ä¸ªæµ‹è¯•ã€‚

è¡¨è¾¾å¼æå‡æ³¨æ„äº‹é¡¹æˆ‘ä»¬çš„å®Œæ•´æ€§æ£€æŸ¥å®šä¹‰å­˜åœ¨å‡ ä¸ªé—®é¢˜ï¼Œæœ‰äº›æ˜¯æ˜Žæ˜¾çš„ï¼Œæœ‰äº›åˆ™ä¸æ˜Žæ˜¾ã€‚æ˜¾ç„¶ï¼Œè¯¥å‡½æ•°ä¸¤æ¬¡æå–äº†æ•°æ®åº“çš„æž¶æž„ã€‚ä½¿ç”¨çŽ°æœ‰çš„[æœ¬åœ°](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)å®šä¹‰ï¼Œå¯ä»¥å¼•å…¥ä¸€ä¸ªå®šä¹‰å¹¶é¿å…è¿™ç§é‡å¤ï¼š

> | |Â Â  ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (integrity-check.v2 db) |
> | --- | --- |
> |   ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) schema (db-schema db))) |
> |   ; è¡Œ -> å¸ƒå°” |
> |   ; åˆ¤æ–­è¡Œæ˜¯å¦æ»¡è¶³ (I1) å’Œ (I2) |
> |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (row-integrity-check row) |
> |   ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29) ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29) (length row) (length schema))) |
> |   ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29) ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29) (s c) ([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29) s) c]) |
> |   schema |
> |   row)))) |
> |   ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29) row-integrity-check (db-content db)))) |

æˆ‘ä»¬ä»Ž å±€éƒ¨å®šä¹‰ ä¸­çŸ¥é“ï¼Œæå‡è¿™æ ·çš„è¡¨è¾¾å¼å¯ä»¥ç¼©çŸ­è¿è¡Œå®Œæ•´æ€§æ£€æŸ¥æ‰€éœ€çš„æ—¶é—´ã€‚å°±åƒ å›¾ 100 ä¸­ inf çš„å®šä¹‰ä¸€æ ·ï¼Œå®Œæ•´æ€§æ£€æŸ¥çš„åŽŸç‰ˆä»Ž db ä¸­ä¸ºæ¯ä¸€è¡Œæå–æ¨¡å¼ï¼Œå³ä½¿å®ƒæ˜¾ç„¶ä¿æŒä¸å˜ã€‚

> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) (integrity-check.v3 db) |
> > > | --- |
> > > | ï¼ˆ[å±€éƒ¨å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) schema (db-schema db)) |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (db-content db)) |
> > > | |Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â widthÂ Â Â (lengthÂ schema)) |
> > > | |Â Â Â Â Â Â Â Â Â ;Â è¡Œ -> å¸ƒå°”å€¼ |
> > > | |Â Â Â Â Â Â Â Â Â ;Â æ£€æŸ¥è¡Œæ˜¯å¦æ»¡è¶³(I1)å’Œ(I2) |
> > > | |Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row-integrity-checkÂ row)) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([and](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._and%29%29)Â ([=](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._~3d%29%29)Â (lengthÂ row)Â width)) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29)Â ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29)Â (sÂ c)Â [([second](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._second%29%29)Â s)Â c]) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â æ¨¡å¼ |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â è¡Œ)))) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([andmap](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29)Â row-integrity-checkÂ content))) |
> > > 
> å›¾ 139ï¼šç³»ç»ŸåŒ–è¡¨è¾¾å¼æå‡çš„ç»“æžœ

æœ¯è¯­è®¡ç®—æœºç§‘å­¦å®¶è°ˆè®ºâ€œæå‡è¡¨è¾¾å¼â€ã€‚åœ¨ç±»ä¼¼çš„æ–¹å¼ä¸­ï¼Œè¡Œå®Œæ•´æ€§æ£€æŸ¥å‡½æ•°æ¯æ¬¡è¢«è°ƒç”¨æ—¶éƒ½ä¼šç¡®å®šæ•°æ®åº“æ¨¡å¼çš„é•¿åº¦ã€‚ç»“æžœå§‹ç»ˆç›¸åŒã€‚å› æ­¤ï¼Œå¦‚æžœæˆ‘ä»¬å¯¹æé«˜è¯¥å‡½æ•°çš„æ€§èƒ½æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)å®šä¹‰æ¥ä¸€æ¬¡æ€§å‘½åæ•°æ®åº“å†…å®¹çš„å®½åº¦ã€‚å›¾ 139 æ˜¾ç¤ºäº†å°†(length schema)ä»Žè¡Œå®Œæ•´æ€§æ£€æŸ¥ä¸­æå‡å‡ºæ¥çš„ç»“æžœã€‚ä¸ºäº†å¯è¯»æ€§ï¼Œè¿™ä¸ªæœ€ç»ˆçš„å®šä¹‰è¿˜å‘½åäº† db çš„å†…å®¹å­—æ®µã€‚ç»“æŸ

æŠ•å½±å’Œé€‰æ‹©ç¨‹åºéœ€è¦ä»Žæ•°æ®åº“ä¸­æå–æ•°æ®ã€‚ä¸€ç§æå–æ–¹å¼æ˜¯é€‰æ‹©å†…å®¹ï¼Œè¿™åœ¨çŽ°å®žä¸–ç•Œæ•°æ®ï¼šiTunes ä¸­æœ‰æ‰€è§£é‡Šã€‚å¦ä¸€ç§æå–æ–¹å¼äº§ç”Ÿä¸€ä¸ªç¼©å‡çš„æ•°æ®åº“ï¼›å®ƒè¢«ç§°ä¸ºæŠ•å½±ã€‚æ›´å…·ä½“åœ°è¯´ï¼ŒæŠ•å½±é€šè¿‡ä»…ä¿ç•™ç»™å®šæ•°æ®åº“ä¸­çš„æŸäº›åˆ—æ¥æž„å»ºæ•°æ®åº“ã€‚

æŠ•å½±çš„æè¿°æš—ç¤ºäº†ä»¥ä¸‹å†…å®¹ï¼š

> | ;Â DB [List-of  Label] -> DB |
> | --- |
> | ;Â ä¿ç•™æ•°æ®åº“ä¸­æ ‡ç­¾åœ¨ labels ä¸­çš„åˆ— |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (projectÂ dbÂ labels)Â (make-dbÂ '()Â '())) |

Given the complexity of a projection, it is best to work through an example first. Say we wish to eliminate the age column from the database on the left in figureÂ 137. Here is what this transformation looks like in terms of tables:

> | the original database |  | ... eliminating the â€œAgeâ€ column |
> | --- | --- | --- |
> 
> |
> 
> &#124; Name &#124;  &#124; Age &#124;  &#124; Present &#124;
> 
> &#124; String &#124;  &#124; Integer &#124;  &#124; Boolean &#124;
> 
> &#124; "Alice" &#124;  &#124; 35 &#124;  &#124; #true &#124;
> 
> &#124; "Bob" &#124;  &#124; 25 &#124;  &#124; #false &#124;
> 
> &#124; "Carol" &#124;  &#124; 30 &#124;  &#124; #true &#124;
> 
> &#124; "Dave" &#124;  &#124; 32 &#124;  &#124; #false &#124;
> 
> |  |
> | --- |
> 
> &#124; Name &#124;  &#124; Present &#124;
> 
> &#124; String &#124;  &#124; Boolean &#124;
> 
> &#124; "Alice" &#124;  &#124; #true &#124;
> 
> &#124; "Bob" &#124;  &#124; #false &#124;
> 
> &#124; "Carol" &#124;  &#124; #true &#124;
> 
> &#124; "Dave" &#124;  &#124; #false &#124;
> 
> |

A natural way to articulate the example as a test reuses figureÂ 138:

> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â projected-content |
> | --- |
> | Â Â `(("Alice"Â #true) |
> | Â Â Â Â ("Bob"Â Â Â #false) |
> | Â Â Â Â ("Carol"Â #true) |
> | Â Â Â Â ("Dave"Â Â #false))) |
> | Â  |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â projected-schema |
> | Â Â `(("Name"Â ,[string?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3f%29%29))Â ("Present"Â ,[boolean?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._boolean~3f%29%29)))) |
> | Â  |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â projected-db |
> | Â Â (make-dbÂ projected-schemaÂ projected-content)) |
> | ;Â Stop! ä»”ç»†é˜…è¯»æ­¤æµ‹è¯•ã€‚æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ |
> | ([check-expect](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)Â (projectÂ school-dbÂ '("Name"Â "Present")) |
> | ï¼ˆæŠ•å½±æ•°æ®åº“ï¼‰ |
> > > > | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) ï¼ˆæŠ•å½± æ•°æ®åº“ æ ‡ç­¾ï¼‰ |
> > > > | ï¼ˆ[å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) schema (æ•°æ®åº“æ¨¡å¼ æ•°æ®åº“)ï¼‰ |
> > > > | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (æ•°æ®åº“å†…å®¹ æ•°æ®åº“)ï¼‰ |
> > > > | ï¼ˆ; è§„èŒƒ -> å¸ƒå°”ï¼‰ |
> > > > | ï¼ˆ; è¿™ä¸ªè§„èŒƒæ˜¯å¦å±žäºŽæ–°çš„æ¨¡å¼ï¼‰ |
> > > > | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) ï¼ˆä¿ç•™ï¼Ÿ c) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)ï¼‰ |
> > > > | ï¼ˆ; è¡Œ -> è¡Œï¼‰ |
> > > > | ï¼ˆ; ä¿ç•™é‚£äº›åç§°åœ¨æ ‡ç­¾ä¸­çš„åˆ—ï¼‰ |
> > > > | ï¼ˆ[å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) ï¼ˆè¡ŒæŠ•å½± è¡Œï¼‰[...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)ï¼‰ï¼‰ |
> > > > | ï¼ˆ; ä½¿ç”¨ make-db è¿‡æ»¤ schemaï¼‰ |
> > > > | ï¼ˆ[æ˜ å°„](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) è¡ŒæŠ•å½± å†…å®¹ï¼‰ï¼‰ |
> > > > 
> å›¾ 140ï¼šæŠ•å½±æ¨¡æ¿

å¦‚æžœä½ å¡«å†™ä¸Šè¿°æ¨¡æ¿å¹¶åœ¨ DrRacket ä¸­è¿è¡Œä»£ç ï¼Œä½ ä¼šå¾—åˆ°é”™è¯¯ä¿¡æ¯

> ç­‰å¼ç¬¬ä¸€ä¸ªå‚æ•°ä¸èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°

åœ¨ DrRacket ç”šè‡³èƒ½å¤Ÿåˆ¤æ–­æµ‹è¯•æ˜¯å¦æˆåŠŸä¹‹å‰ã€‚å›žé¡¾å‡½æ•°æ˜¯å€¼éƒ¨åˆ†ï¼Œå‡½æ•°æ˜¯æ— é™å¤§çš„å¯¹è±¡ï¼Œå½“åº”ç”¨äºŽç›¸åŒçš„å‚æ•°æ—¶ï¼Œæ— æ³•ä¿è¯ä¸¤ä¸ªå‡½æ•°æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„ç»“æžœã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ”¾å®½äº†æµ‹è¯•ç”¨ä¾‹ï¼š

> | ï¼ˆ[æ£€æŸ¥æœŸæœ›](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._check-expect%29%29)ï¼‰ |
> | --- |
> | ï¼ˆæ•°æ®åº“å†…å®¹ (æŠ•å½± å­¦æ ¡æ•°æ®åº“ ("Name" "Present"))) |
> | ï¼ˆæŠ•å½±å†…å®¹ï¼‰ |

å¯¹äºŽæ¨¡æ¿ï¼Œæˆ‘ä»¬å†æ¬¡é‡ç”¨çŽ°æœ‰çš„æŠ½è±¡ï¼›å‚è§å›¾ 140ã€‚[æœ¬åœ°](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)è¡¨è¾¾å¼å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°ï¼šä¸€ä¸ªç”¨äºŽä¸Ž[filter](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._filter%29%29)ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ç¼©å°ç»™å®šæ•°æ®åº“çš„æ¨¡å¼ï¼Œå¦ä¸€ä¸ªç”¨äºŽä¸Ž[map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ç²¾ç®€å†…å®¹ã€‚æ­¤å¤–ï¼Œè¯¥å‡½æ•°å†æ¬¡ä»Žç»™å®šæ•°æ®åº“ä¸­æå–å¹¶å‘½åæ¨¡å¼å’Œå†…å®¹ã€‚

åœ¨æˆ‘ä»¬è½¬å‘æ„¿æœ›æ¸…å•ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹å†³å®šä½¿ç”¨ä¸¤æ¬¡çŽ°æœ‰æŠ½è±¡çš„å†³å®šã€‚ç­¾åå‘Šè¯‰æˆ‘ä»¬è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªç»“æž„å¹¶äº§ç”Ÿ DB çš„ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥

> | ([æœ¬åœ°](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29) ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) schema (db-schema db))) |
> | --- |
> | [å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) content (db-content db)) |
> | [åˆ›å»ºæ•°æ®åº“](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [schema](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [content](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29)) |
> | [...] ([å†…å®¹](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29) [...](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._......%29%29))) |

æ˜¾ç„¶æ˜¯å¿…è¦çš„ã€‚ä¹Ÿå¯ä»¥ç›´æŽ¥çœ‹å‡ºï¼Œæ–°æž¶æž„æ˜¯ç”±æ—§æž¶æž„å’Œæ—§å†…å®¹ä¸­çš„æ–°å†…å®¹åˆ›å»ºçš„ã€‚æ­¤å¤–ï¼Œé¡¹ç›®è¯´æ˜Žçš„ç›®çš„æ˜¯ä¿ç•™ä»…åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸­æåˆ°çš„æ ‡ç­¾ã€‚å› æ­¤ï¼Œ[è¿‡æ»¤å™¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._filter%29%29)å‡½æ•°æ­£ç¡®åœ°ç¼©å°äº†ç»™å®šçš„æž¶æž„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¡Œæœ¬èº«ä¿æŒä¸å˜ï¼Œä½†æ¯ä¸ªè¡Œéƒ½ä¸¢å¤±äº†ä¸€äº›å•å…ƒæ ¼ã€‚å› æ­¤ï¼Œ[æ˜ å°„](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)æ˜¯å¤„ç†å†…å®¹çš„æ­£ç¡®æ–¹å¼ã€‚çŽ°åœ¨æˆ‘ä»¬å¯ä»¥è½¬å‘ä¸¤ä¸ªè¾…åŠ©å‡½æ•°çš„è®¾è®¡ã€‚keep?çš„è®¾è®¡å¾ˆç®€å•ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„å®šä¹‰ï¼š

> | ;Â è§„èŒƒ -> å¸ƒå°”å€¼ |
> | --- |
> | ;Â è¿™ä¸ªè§„èŒƒæ˜¯å¦å±žäºŽæ–°æž¶æž„ |
> | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (keep?Â c) |
> | Â Â ([member?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â c)Â labels)) |

å‡½æ•°åº”ç”¨äºŽä¸€ä¸ªè§„èŒƒï¼Œå®ƒå°†ä¸€ä¸ªæ ‡ç­¾å’Œä¸€ä¸ªè°“è¯ç»„åˆæˆä¸€ä¸ªåˆ—è¡¨ã€‚å¦‚æžœå‰è€…å±žäºŽæ ‡ç­¾ï¼Œåˆ™ä¿ç•™ç»™å®šçš„è§„èŒƒã€‚å¯¹äºŽè¡ŒæŠ•å½±çš„è®¾è®¡ï¼Œç›®æ ‡æ˜¯ä¿ç•™é‚£äº›åç§°æ˜¯ç»™å®šæ ‡ç­¾æˆå‘˜çš„æ¯ä¸ªå•å…ƒæ ¼ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„ä¾‹å­æ¥åˆ†æžã€‚è¿™å››è¡Œæ˜¯ï¼š

> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Alice"Â 35Â #true) |
> | --- |
> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Bob"Â Â Â 25Â #false) |
> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Carol"Â 30Â #true) |
> | ([list](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "Dave"Â Â 32Â #false) |

æ¯è¡Œä¸Ž school-schema ä¸€æ ·é•¿ï¼š

> ([åˆ—è¡¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list%29%29)Â "åç§°"Â "å¹´é¾„"Â "å½“å‰")

æ¨¡å¼ä¸­çš„åç§°å†³å®šäº†ç»™å®šè¡Œä¸­å•å…ƒæ ¼çš„åç§°ã€‚å› æ­¤ï¼Œrow-project å¿…é¡»ä¿ç•™æ¯ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªå•å…ƒæ ¼ï¼Œå› ä¸ºå®ƒä»¬çš„åç§°åœ¨ç»™å®šçš„æ ‡ç­¾ä¸­ã€‚ç”±äºŽ Row æ˜¯é€’å½’å®šä¹‰çš„ï¼Œè¿™ä¸ª Cell å†…å®¹ä¸Žå®ƒä»¬çš„åç§°ä¹‹é—´çš„åŒ¹é…è¿‡ç¨‹éœ€è¦ä¸€ä¸ªé€’å½’è¾…åŠ©å‡½æ•°ï¼Œrow-project å¯ä»¥å°†å…¶åº”ç”¨äºŽå•å…ƒæ ¼çš„å†…å®¹å’Œæ ‡ç­¾ã€‚è®©æˆ‘ä»¬å°†å…¶æŒ‡å®šä¸ºä¸€ä¸ªæ„¿æœ›ï¼š

> | ;Â Row [åˆ—è¡¨  æ ‡ç­¾] -> Row |
> | --- |
> | ;Â ä¿ç•™å¯¹åº”å…ƒç´  |
> | ;Â åœ¨åç§°ä¸­ä¹Ÿåœ¨æ ‡ç­¾ä¸­ |
> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row-filterÂ rowÂ names)Â '()) |

ä½¿ç”¨è¿™ä¸ªæ„¿æœ›ï¼Œrow-project æ˜¯ä¸€è¡Œä»£ç ï¼š

> | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row-projectÂ row) |
> | --- |
> | Â Â (row-filterÂ rowÂ ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)Â [first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â schema))) |

The [map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) è¡¨è¾¾å¼æå–å•å…ƒæ ¼çš„åç§°ï¼Œå¹¶å°†è¿™äº›åç§°ä¼ é€’ç»™ row-filter ä»¥æå–åŒ¹é…çš„å•å…ƒæ ¼ã€‚

ç»ƒä¹  405ã€‚è®¾è®¡ row-filter å‡½æ•°ã€‚ä»Ž project çš„ç¤ºä¾‹ä¸­æž„å»º row-filter çš„ç¤ºä¾‹ã€‚

å‡è®¾ç»™å®šçš„æ•°æ®åº“é€šè¿‡äº†ä¸€ä¸ªå®Œæ•´æ€§æ£€æŸ¥ï¼Œè¿™æ„å‘³ç€æ¯ä¸€è¡Œä¸Žæ¨¡å¼ä¸€æ ·é•¿ï¼Œå› æ­¤å®ƒçš„åç§°åˆ—è¡¨ã€‚

å›¾ 141 å°†æ‰€æœ‰è¿™äº›éƒ¨åˆ†ç»„åˆåœ¨ä¸€èµ·ã€‚å‡½æ•° project æœ‰.v1 åŽç¼€ï¼Œå› ä¸ºå®ƒéœ€è¦ä¸€äº›æ”¹è¿›ã€‚ä»¥ä¸‹ç»ƒä¹ è¦æ±‚ä½ å®žçŽ°å…¶ä¸­çš„ä¸€äº›ã€‚

> > > | ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (project.v1Â dbÂ labels) |
> > > | --- |
> > > | Â Â ([å±€éƒ¨](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â schemaÂ Â (db-schemaÂ db)) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â contentÂ (db-contentÂ db)) |
> > > | |Â Â Â Â Â Â Â Â  |
> > > | |Â Â Â Â Â Â Â Â Â ;Â è§„èŒƒ -> å¸ƒå°” |
> > > | |Â Â Â Â Â Â Â Â Â ;Â è¿™ä¸€åˆ—æ˜¯å¦å±žäºŽæ–°æž¶æž„ |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (keep?Â c) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([æˆå‘˜?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29)Â ([ç¬¬ä¸€ä¸ª](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â c)Â labels)) |
> > > | |Â Â Â Â Â Â Â Â  |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ;Â è¡Œ -> è¡Œ |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ;Â ä¿ç•™é‚£äº›åç§°åœ¨æ ‡ç­¾ä¸­çš„åˆ— |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row-projectÂ row) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â (row-filterÂ rowÂ ([æ˜ å°„](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)Â [first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â schema))) |
> > > | |Â Â Â Â Â Â Â Â  |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ;Â è¡Œ [åˆ—è¡¨-of  æ ‡ç­¾] -> è¡Œ |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ;Â ä¿ç•™é‚£äº›åç§°åœ¨æ ‡ç­¾ä¸­çš„å•å…ƒæ ¼ |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([å®šä¹‰](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row-filterÂ rowÂ names) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â ([æ¡ä»¶](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [([ç©º?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29)Â names)Â '()] |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â [[å¦åˆ™](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29)Â ([member?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â names)Â labels) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â row) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (row-filterÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â row)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â names))) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (row-filterÂ ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â row)Â ([rest](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._rest%29%29)Â names)))]))) |
> > > | |Â Â Â (make-dbÂ ([filter](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._filter%29%29)Â keep?Â schema) |
> > > | |Â Â Â Â Â Â Â Â Â Â Â Â Â Â ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)Â row-projectÂ content)))) |
> > > 
> å›¾ 141ï¼šæ•°æ®åº“æŠ•å½±

ç»ƒä¹  406ã€‚row-project å‡½æ•°ä¸ºæ•°æ®åº“å†…å®¹çš„æ¯ä¸€è¡Œé‡æ–°è®¡ç®—æ ‡ç­¾ã€‚ç»“æžœæ˜¯å¦åœ¨å‡½æ•°è°ƒç”¨ä¹‹é—´æœ‰æ‰€ä¸åŒï¼Ÿå¦‚æžœæ²¡æœ‰ï¼Œåˆ™æå‡è¡¨è¾¾å¼ã€‚

ç»ƒä¹  407ã€‚ä½¿ç”¨ [foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29) é‡æ–°è®¾è®¡ row-filterã€‚ä¸€æ—¦å®Œæˆï¼Œä½ å¯ä»¥å°† row-project å’Œ row-filter åˆå¹¶æˆä¸€ä¸ªå‡½æ•°ã€‚æç¤ºï¼šISL+ ä¸­çš„ [foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29) å‡½æ•°å¯èƒ½æ¶ˆè€—ä¸¤ä¸ªåˆ—è¡¨å¹¶å¹¶è¡Œå¤„ç†å®ƒä»¬ã€‚

æœ€åŽçš„è§‚å¯Ÿæ˜¯ï¼Œè¡ŒæŠ•å½±å¯¹æ¯ä¸ªå•å…ƒæ ¼ä¸­çš„æ ‡ç­¾åœ¨æ ‡ç­¾ä¸­çš„æˆå‘˜èµ„æ ¼è¿›è¡Œæ£€æŸ¥ã€‚å¯¹äºŽä¸åŒè¡Œä¸­åŒä¸€åˆ—çš„å•å…ƒæ ¼ï¼Œç»“æžœå°†æ˜¯ç›¸åŒçš„ã€‚å› æ­¤ï¼Œå°†è¿™ç§è®¡ç®—æå‡å‡ºå‡½æ•°ä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„ã€‚

è¿™ç§æå‡å½¢å¼æ¯”æ™®é€šè¡¨è¾¾å¼æå‡è¦å›°éš¾ä¸€äº›ã€‚æˆ‘ä»¬åŸºæœ¬ä¸Šå¸Œæœ›é¢„å…ˆè®¡ç®—ä»¥ä¸‹ç»“æžœï¼š

> ([member?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29)Â labelÂ labels)

å¯¹äºŽæ‰€æœ‰è¡Œï¼Œæˆ‘ä»¬å°†ç»“æžœä¼ é€’ç»™å‡½æ•°è€Œä¸æ˜¯æ ‡ç­¾åˆ—è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç”¨è¡¨ç¤ºç›¸åº”ä½ç½®å•å…ƒæ ¼æ˜¯å¦è¦ä¿ç•™çš„å¸ƒå°”å€¼åˆ—è¡¨æ›¿æ¢äº†æ ‡ç­¾åˆ—è¡¨ã€‚å¸ƒå°”å€¼ã€‚å¹¸è¿çš„æ˜¯ï¼Œè®¡ç®—è¿™äº›å¸ƒå°”å€¼åªæ˜¯å¯¹æ¨¡å¼åº”ç”¨`keep?`çš„å¦ä¸€ç§åº”ç”¨ï¼š

> ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29)Â keep?Â schema)

ä¸Žä»Žç»™å®šçš„æ¨¡å¼ä¸­ä¿ç•™ä¸€äº› Spec å¹¶ä¸¢å¼ƒå…¶ä»– Spec ä¸åŒï¼Œè¿™ä¸ªè¡¨è¾¾å¼åªæ˜¯æ”¶é›†å†³ç­–ã€‚

> > > | ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (projectÂ dbÂ labels) |
> > > | --- |
> > > | Â Â ([local](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)Â (([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â schemaÂ Â (db-schemaÂ db)) |
> > > | Â Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â contentÂ (db-contentÂ db)) |
> > > | Â  |
> > > | Â Â Â Â Â Â Â Â Â Â ;Â Spec -> Boolean |
> > > | Â Â Â Â Â Â Â Â Â Â ;Â è¿™ä¸€åˆ—å±žäºŽæ–°æ¨¡å¼å— |
> > > | Â Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (keep?Â c) |
> > > | Â Â Â Â Â Â Â Â Â Â Â Â ([member?](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29)Â ([first](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29)Â c)Â labels)) |
> > > | Â  |
> > > | Â Â Â Â Â Â Â Â Â Â ;Â Row -> Row |
> > > | Â Â Â Â Â Â Â Â Â Â ;Â ä¿ç•™åç§°åœ¨æ ‡ç­¾ä¸­çš„åˆ— |
> > > | Â Â Â Â Â Â Â Â Â Â ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29)Â (row-projectÂ row) |
> > > |   ([foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29) ([lambda](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29) (cell m c) ([if](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29) m ([cons](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cons%29%29) cell c) c))) |
> > > |   '() |
> > > |   row |
> > > |   mask)) |
> > > |   ([define](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29) mask ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) keep? schema))) |
> > > |   (make-db ([filter](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._filter%29%29) keep? schema))) |
> > > |   ([map](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29) row-project content))) |
> > > 
> å›¾ 142ï¼šæ•°æ®åº“æŠ•å½±

å›¾ 142 å±•ç¤ºäº†é¡¹ç›®çš„æœ€ç»ˆç‰ˆæœ¬ï¼Œå¹¶æ•´åˆäº†å‰é¢ç»ƒä¹ çš„è§£å†³æ–¹æ¡ˆã€‚å®ƒè¿˜ä½¿ç”¨äº†[å±€éƒ¨å˜é‡](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29)æ¥æå–å’Œå‘½åæ¨¡å¼ä»¥åŠå†…å®¹ï¼Œä»¥åŠ keep?æ¥æ£€æŸ¥æŸäº›è§„èŒƒä¸­çš„æ ‡ç­¾æ˜¯å¦å€¼å¾—ä¿ç•™ã€‚å‰©ä¸‹çš„ä¸¤ä¸ªå®šä¹‰å¼•å…¥äº† maskï¼Œå®ƒä»£è¡¨ä¸Šé¢è®¨è®ºçš„å¸ƒå°”åˆ—è¡¨ï¼Œä»¥åŠ row-project çš„ä¿®è®¢ç‰ˆã€‚åŽè€…ä½¿ç”¨[foldr](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldr%29%29)å¹¶è¡Œå¤„ç†ç»™å®šçš„è¡Œå’Œ maskã€‚

å°†è¿™ä¸ªä¿®è®¢åŽçš„ project å®šä¹‰ä¸Žå›¾ 141 ä¸­çš„ project.v1 è¿›è¡Œæ¯”è¾ƒã€‚å›¾ 141 ä¸­çš„æœ€ç»ˆå®šä¹‰æ¯”åŽŸå§‹ç‰ˆæœ¬æ›´ç®€å•ã€æ›´å¿«ã€‚ç³»ç»Ÿçš„è®¾è®¡åŠ ä¸Šç»†è‡´çš„ä¿®è®¢æ˜¯å€¼å¾—çš„ï¼›æµ‹è¯•å¥—ä»¶ç¡®ä¿ä¿®è®¢ä¸ä¼šç ´åç¨‹åºçš„åŠŸèƒ½ã€‚

ç»ƒä¹  408ã€‚è®¾è®¡ select å‡½æ•°ã€‚å®ƒæ¶ˆè€—ä¸€ä¸ªæ•°æ®åº“ã€ä¸€ä¸ªæ ‡ç­¾åˆ—è¡¨å’Œä¸€ä¸ªè¡Œè°“è¯ã€‚ç»“æžœæ˜¯æ»¡è¶³ç»™å®šè°“è¯çš„è¡Œçš„åˆ—è¡¨ï¼ŒæŠ•å½±åˆ°ç»™å®šçš„æ ‡ç­¾é›†åˆã€‚

ç»ƒä¹  409ã€‚è®¾è®¡é‡æŽ’å‡½æ•°ã€‚è¯¥å‡½æ•°æ¶ˆè€—ä¸€ä¸ªæ•°æ®åº“ db å’Œæ ‡ç­¾åˆ—è¡¨ lolã€‚å®ƒäº§ç”Ÿä¸€ä¸ªç±»ä¼¼äºŽ db çš„æ•°æ®åº“ï¼Œä½†å…¶åˆ—çš„é¡ºåºæ ¹æ® lol è¿›è¡ŒæŽ’åºã€‚æç¤ºï¼šæŸ¥é˜…[list-ref](http://docs.racket-lang.org/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._list-ref%29%29)ã€‚

æœ€åˆå‡è®¾ lol æ°å¥½åŒ…å« db åˆ—çš„æ ‡ç­¾ã€‚ä¸€æ—¦ä½ å®Œæˆäº†è®¾è®¡ï¼Œç ”ç©¶å¦‚æžœ lol åŒ…å«çš„æ ‡ç­¾å°‘äºŽåˆ—æ•°ï¼Œä»¥åŠ db ä¸­ä¸æ˜¯åˆ—æ ‡ç­¾çš„å­—ç¬¦ä¸²éœ€è¦åšå‡ºå“ªäº›æ”¹å˜ã€‚

ç»ƒä¹  410ã€‚è®¾è®¡ db-union å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¶ˆè€—å…·æœ‰ç›¸åŒæ¨¡å¼çš„ä¸¤ä¸ªæ•°æ®åº“ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªå…·æœ‰æ­¤æ¨¡å¼ä¸”åŒ…å«ä¸¤ä¸ªæ•°æ®åº“è”åˆå†…å®¹çš„æ–°çš„æ•°æ®åº“ã€‚è¯¥å‡½æ•°å¿…é¡»æ¶ˆé™¤å…·æœ‰å®Œå…¨ç›¸åŒå†…å®¹çš„è¡Œã€‚

å‡è®¾æ¨¡å¼åœ¨æ¯åˆ—çš„è°“è¯ä¸Šæ˜¯ä¸€è‡´çš„ã€‚

ç»ƒä¹  411ã€‚è®¾è®¡ join å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¶ˆè€—ä¸¤ä¸ªæ•°æ®åº“ï¼šdb-1 å’Œ db-2ã€‚db-2 çš„æ¨¡å¼ä»Žä¸Ž db-1 çš„æ¨¡å¼ç»“æŸçš„ç›¸åŒçš„ Spec å¼€å§‹ã€‚è¯¥å‡½æ•°é€šè¿‡ç”¨ db-2 ä¸­çš„å•å…ƒæ ¼çš„ç¿»è¯‘æ›¿æ¢ db-1 ä¸­æ¯è¡Œçš„æœ€åŽä¸€ä¸ªå•å…ƒæ ¼æ¥åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ã€‚

è¿™é‡Œæ˜¯ä¸€ä¸ªç¤ºä¾‹ã€‚å–è‡ªå›¾ 137 ä¸­çš„æ•°æ®åº“ã€‚è¿™ä¸¤ä¸ªæ•°æ®åº“æ»¡è¶³è¿™äº›ç»ƒä¹ çš„å‡è®¾ï¼Œå³ç¬¬ä¸€ä¸ªæ¨¡å¼ä¸­çš„æœ€åŽä¸€ä¸ª Spec ç­‰äºŽç¬¬äºŒä¸ªæ¨¡å¼ä¸­çš„ç¬¬ä¸€ä¸ª Specã€‚å› æ­¤ï¼Œå¯ä»¥å°†å®ƒä»¬è¿žæŽ¥èµ·æ¥ï¼š

> | Name |  | Age |  | Description |
> | --- | --- | --- | --- | --- |
> | String |  | Integer |  | String |
> | "Alice" |  | 35 |  | "presence" |
> | "Bob" |  | 25 |  | "absence" |
> | "Carol" |  | 30 |  | "presence" |
> | "Dave" |  | 32 |  | "absence" |

å…¶ç¿»è¯‘å°†#true æ˜ å°„åˆ°â€œå­˜åœ¨â€ï¼Œå°†#false æ˜ å°„åˆ°â€œä¸å­˜åœ¨â€ã€‚

æç¤ºï¼ˆ1ï¼‰é€šå¸¸æƒ…å†µä¸‹ï¼Œç¬¬äºŒä¸ªæ•°æ®åº“å¯èƒ½å°†ä¸€ä¸ªå•å…ƒæ ¼â€œç¿»è¯‘â€ä¸ºå¤šä¸ªå€¼çš„è¡Œï¼Œè€Œä¸ä»…ä»…æ˜¯å•ä¸ªå€¼ã€‚é€šè¿‡åœ¨è¡Œä¸­æ·»åŠ â€œå­˜åœ¨â€å’Œâ€œä¸å­˜åœ¨â€ç­‰é¢å¤–æœ¯è¯­æ¥ä¿®æ”¹ç¤ºä¾‹ã€‚

ï¼ˆ2ï¼‰å®ƒä¹Ÿå¯èƒ½å°†ä¸€ä¸ªå•å…ƒæ ¼â€œç¿»è¯‘â€ä¸ºå¤šè¡Œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥è¿‡ç¨‹å°†å‘æ–°æ•°æ®åº“æ·»åŠ å¤šè¡Œã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¬¬äºŒä¸ªç¤ºä¾‹ï¼Œæ¥è‡ªå›¾ 137 ä¸­çš„ä¸åŒçš„ä¸€å¯¹æ•°æ®åº“ï¼š

> |
> 
> &#124; Name &#124;  &#124; Age &#124;  &#124; Present &#124;
> 
> &#124; String &#124;  &#124; Integer &#124;  &#124; Boolean &#124;
> 
> &#124; "Alice" &#124;  &#124; 35 &#124;  &#124; #true &#124;
> 
> &#124; "Bob" &#124;  &#124; 25 &#124;  &#124; #false &#124;
> 
> &#124; "Carol" &#124;  &#124; 30 &#124;  &#124; #true &#124;
> 
> &#124; "Dave" &#124;  &#124; 32 &#124;  &#124; #false &#124;
> 
> |  |  |  |
> | --- | --- | --- |
> 
> &#124; Present &#124;  &#124; Description &#124;
> 
> | å¸ƒå°” |  | å­—ç¬¦ä¸² |  |
> 
> | #true |  | "å­˜åœ¨" |  |
> 
> | #true |  | "è¿™é‡Œ" |  |
> 
> | #false |  | "ä¸å­˜åœ¨" |  |
> 
> | #false |  | "é‚£é‡Œ" |  |
> 
> |

å°†å·¦ä¾§æ•°æ®åº“ä¸Žå³ä¾§æ•°æ®åº“åˆå¹¶ï¼Œå¾—åˆ°ä¸€ä¸ªåŒ…å«å…«è¡Œçš„æ•°æ®åº“ï¼š

> | åç§° |  | å¹´é¾„ |  | æè¿° |
> | --- | --- | --- | --- | --- |
> | å­—ç¬¦ä¸² |  | æ•´æ•° |  | å­—ç¬¦ä¸² |
> | "Alice" |  | 35 |  | "å­˜åœ¨" |
> | "Alice" |  | 35 |  | "è¿™é‡Œ" |
> | "Bob" |  | 25 |  | "ä¸å­˜åœ¨" |
> | "Bob" |  | 25 |  | "é‚£é‡Œ" |
> | "Carol" |  | 30 |  | "å­˜åœ¨" |
> | "Carol" |  | 30 |  | "è¿™é‡Œ" |
> | "Dave" |  | 32 |  | "ä¸å­˜åœ¨" |
> | "Dave" |  | 32 |  | "é‚£é‡Œ" |

(3) ä½¿ç”¨è¿­ä»£ç»†åŒ–æ¥è§£å†³è¯¥é—®é¢˜ã€‚å¯¹äºŽç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œå‡è®¾â€œç¿»è¯‘â€åœ¨æ¯ä¸ªå•å…ƒæ ¼ä¸­åªæ‰¾åˆ°ä¸€è¡Œã€‚å¯¹äºŽç¬¬äºŒæ¬¡è¿­ä»£ï¼Œæ”¾å¼ƒè¿™ä¸ªå‡è®¾ã€‚

å…³äºŽå‡è®¾çš„è¯´æ˜Žï¼šæœ¬ç»ƒä¹ å’Œæ•´ä¸ªéƒ¨åˆ†ä¸»è¦ä¾èµ–äºŽå¯¹ç»™å®šæ•°æ®åº“çš„éžæ­£å¼é™ˆè¿°å‡è®¾ã€‚åœ¨è¿™é‡Œï¼Œè¿žæŽ¥çš„è®¾è®¡å‡è®¾â€œdb-2 çš„æ¨¡å¼ä»Žä¸Ž db-1 çš„æ¨¡å¼ç»“æŸçš„ç²¾ç¡®ç›¸åŒçš„è§„èŒƒå¼€å§‹ã€‚â€åœ¨çŽ°å®žä¸­ï¼Œæ•°æ®åº“å‡½æ•°å¿…é¡»æ˜¯æ£€æŸ¥å‡½æ•°ï¼Œç²¾ç¥žä¸Šç±»ä¼¼äºŽè¾“å…¥é”™è¯¯ã€‚ç„¶è€Œï¼Œè®¾è®¡æ£€æŸ¥è¿žæŽ¥å¯¹æ‚¨æ¥è¯´æ˜¯ä¸å¯èƒ½çš„ã€‚db-1 æ¨¡å¼ä¸­çš„æœ€åŽä¸€ä¸ªè§„èŒƒä¸Ž db-2 ä¸­çš„ç¬¬ä¸€ä¸ªè§„èŒƒçš„æ¯”è¾ƒéœ€è¦æ¯”è¾ƒå‡½æ•°ã€‚å¯¹äºŽå®žé™…è§£å†³æ–¹æ¡ˆï¼Œè¯·å‚é˜…æ•°æ®åº“æ–¹é¢çš„ä¹¦ç±ã€‚

### 24 æ€»ç»“ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

æœ¬ä¹¦ç¬¬å››éƒ¨åˆ†æ˜¯å…³äºŽè®¾è®¡å¤„ç†æ•°æ®çš„åŠŸèƒ½ï¼Œè¿™äº›æ•°æ®çš„æè¿°éœ€è¦è®¸å¤šç›¸äº’äº¤ç»‡çš„å®šä¹‰ã€‚è¿™äº›å½¢å¼çš„æ•°æ®åœ¨çŽ°å®žä¸–ç•Œä¸­æ— å¤„ä¸åœ¨ï¼Œä»Žæ‚¨è®¡ç®—æœºçš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿåˆ°ä¸‡ç»´ç½‘ï¼Œä»¥åŠåŠ¨ç”»ç”µå½±ä¸­ä½¿ç”¨çš„å‡ ä½•å½¢çŠ¶ã€‚ä»”ç»†ç ”è¯»æœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†åŽï¼Œæ‚¨ä¼šçŸ¥é“è®¾è®¡é…æ–¹ä¹Ÿé€‚ç”¨äºŽè¿™äº›å½¢å¼çš„æ•°æ®ï¼š

1.  å½“ç¨‹åºæ•°æ®çš„æè¿°éœ€è¦å‡ ä¸ªç›¸äº’å¼•ç”¨çš„æ•°æ®å®šä¹‰æ—¶ï¼Œè®¾è®¡é…æ–¹è¦æ±‚åŒæ—¶å¼€å‘æ¨¡æ¿ï¼Œæ¯ä¸ªæ•°æ®å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ã€‚å¦‚æžœæ•°æ®å®šä¹‰ A å¼•ç”¨æ•°æ®å®šä¹‰ Bï¼Œé‚£ä¹ˆæ¨¡æ¿å‡½æ•°-for-A åœ¨å®Œå…¨ç›¸åŒçš„ä½ç½®å’Œæ–¹å¼ä¸Šå¼•ç”¨å‡½æ•°-for-Bã€‚å¦åˆ™ï¼Œè®¾è®¡é…æ–¹åƒä»¥å‰ä¸€æ ·ï¼Œå‡½æ•°å¯¹å‡½æ•°ã€‚

1.  å½“ä¸€ä¸ªå‡½æ•°å¿…é¡»å¤„ç†ä¸¤ç§ç±»åž‹çš„å¤æ•°æ•°æ®æ—¶ï¼Œä½ éœ€è¦åŒºåˆ†ä¸‰ç§æƒ…å†µã€‚é¦–å…ˆï¼Œå‡½æ•°å¯èƒ½å°†å…¶ä¸­ä¸€ä¸ªå‚æ•°è§†ä¸ºåŽŸå­ã€‚å…¶æ¬¡ï¼Œä¸¤ä¸ªå‚æ•°é¢„æœŸå…·æœ‰å®Œå…¨ç›¸åŒçš„ç»“æž„ï¼Œå‡½æ•°ä»¥å®Œå…¨å¹¶è¡Œçš„æ–¹å¼éåŽ†å®ƒä»¬ã€‚ç¬¬ä¸‰ï¼Œå‡½æ•°å¯èƒ½å¿…é¡»åˆ†åˆ«å¤„ç†æ‰€æœ‰å¯èƒ½çš„ç»„åˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ åˆ¶ä½œä¸€ä¸ªäºŒç»´è¡¨æ ¼ï¼Œå…¶ä¸­ä¸€ä¸ªç»´åº¦åˆ—ä¸¾äº†æ¥è‡ªä¸€ä¸ªæ•°æ®å®šä¹‰çš„æ‰€æœ‰ç§ç±»çš„æ•°æ®ï¼Œå¦ä¸€ä¸ªç»´åº¦å¤„ç†ç¬¬äºŒç§æ•°æ®ã€‚æœ€åŽï¼Œä½ ä½¿ç”¨è¡¨æ ¼çš„å•å…ƒæ ¼æ¥ä¸ºå„ç§æƒ…å†µåˆ¶å®šæ¡ä»¶å’Œç­”æ¡ˆã€‚

    è¿™æœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†è®¨è®ºäº†ä¸¤ä¸ªå¤æ•°å‚æ•°ä¸Šçš„å‡½æ•°ã€‚å¦‚æžœä½ æ›¾ç»é‡åˆ°è¿‡é‚£ç§ç½•è§çš„æƒ…å†µï¼Œå³ä¸€ä¸ªå‡½æ•°æŽ¥æ”¶ä¸‰ä¸ªå¤æ•°æ•°æ®ï¼Œä½ å°±çŸ¥é“ä½ éœ€è¦ï¼ˆæƒ³è±¡ï¼‰ä¸€ä¸ªä¸‰ç»´è¡¨æ ¼ã€‚

ä½ çŽ°åœ¨å·²ç»çœ‹åˆ°äº†ä½ å¯èƒ½åœ¨èŒä¸šç”Ÿæ¶¯ä¸­é‡åˆ°çš„æ‰€æœ‰ç»“æž„åŒ–æ•°æ®å½¢å¼ï¼Œå°½ç®¡ç»†èŠ‚ä¼šæœ‰æ‰€ä¸åŒã€‚å¦‚æžœä½ é‡åˆ°å›°éš¾ï¼Œè¯·è®°ä½è®¾è®¡é…æ–¹ï¼›å®ƒå°†å¸®åŠ©ä½ å¼€å§‹ã€‚
